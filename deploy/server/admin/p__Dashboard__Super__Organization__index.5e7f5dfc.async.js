"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[8283],{84881:function(e,t,r){var a=r(17082),n=r(73457),o=r(82308),s=r(44194),i=r(63653),l=r(35175),u=r(31549),d=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],c=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],g=function(e,t){var r=e.fieldProps,c=e.children,g=e.params,f=e.proFieldProps,p=e.mode,m=e.valueEnum,y=e.request,h=e.showSearch,v=e.options,x=(0,n.Z)(e,d),M=(0,s.useContext)(i.Z);return(0,u.jsx)(l.Z,(0,a.Z)((0,a.Z)({valueEnum:(0,o.h)(m),request:y,params:g,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,a.Z)({options:v,mode:p,showSearch:h,getPopupContainer:M.getPopupContainer},r),ref:t,proFieldProps:f},x),{},{children:c}))},f=s.forwardRef((function(e,t){var r=e.fieldProps,d=e.children,g=e.params,f=e.proFieldProps,p=e.mode,m=e.valueEnum,y=e.request,h=e.options,v=(0,n.Z)(e,c),x=(0,a.Z)({options:h,mode:p||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},r),M=(0,s.useContext)(i.Z);return(0,u.jsx)(l.Z,(0,a.Z)((0,a.Z)({valueEnum:(0,o.h)(m),request:y,params:g,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,a.Z)({getPopupContainer:M.getPopupContainer},x),ref:t,proFieldProps:f},v),{},{children:d}))})),p=s.forwardRef(g);p.SearchSelect=f,p.displayName="ProFormComponent",t.Z=p},32350:function(e,t,r){var a=r(17082),n=r(73457),o=r(44194),s=r(35175),i=r(31549),l=["fieldProps","proFieldProps"],u=function(e,t){var r=e.fieldProps,o=e.proFieldProps,u=(0,n.Z)(e,l);return(0,i.jsx)(s.Z,(0,a.Z)({ref:t,valueType:"textarea",fieldProps:r,proFieldProps:o},u))};t.Z=o.forwardRef(u)},17208:function(e,t,r){r.d(t,{A8:function(){return c},Kq:function(){return f},RL:function(){return m}});var a=r(90819),n=r.n(a),o=r(73193),s=r.n(o),i=r(89933),l=r.n(i),u=r(55735),d=r(41159);function c(e){return g.apply(this,arguments)}function g(){return(g=l()(n()().mark((function e(t){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/org/query",{method:"GET",params:s()(s()({},t),{},{client:u.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return p.apply(this,arguments)}function p(){return(p=l()(n()().mark((function e(t){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/org/create",{method:"POST",data:s()(s()({},t),{},{client:u.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return y.apply(this,arguments)}function y(){return(y=l()(n()().mark((function e(t){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/v1/org/update",{method:"POST",data:s()(s()({},t),{},{client:u.bVn})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},96865:function(e,t,r){var a=r(23864);t.Z=function(){var e=(0,a.Z)().isDarkMode;return{leftSiderStyle:{borderRight:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"},leftSiderWidth:250,headerStyle:{background:e?"#141414":"#fff"},rightSiderStyle:{borderLeft:e?"1px solid #333":"1px solid #ccc",background:e?"#141414":"#f5f5f5"},contentStyle:{minHeight:120,background:e?"#141414":"#f5f5f5",height:"100vh",overflow:"auto"}}}},42331:function(e,t,r){r.r(t),r.d(t,{default:function(){return H}});var a=r(96865),n=r(75574),o=r(44194),s=r(45516),i=r(73193),l=r.n(i),u=r(84176),d=r.n(u),c=r(90819),g=r.n(c),f=r(89933),p=r.n(f),m=r(45332),y=r.n(m),h=r(86803),v=r(81924),x=r(48524),M=r(40612),b=r(69169),w=r(4499),S=r(32350),j=r(84881),R=r(16309),Z=r(73442),C=r(3849),P=r(75365),F=r(38775),k=r(41159),I=r(31549),T=function(e){var t=e.isEdit,r=e.org,a=e.open,n=e.onClose,s=e.onSubmit,i=R.Z.useForm(),u=y()(i,1)[0],d=(0,k.useIntl)(),c=(0,M.u)((function(e){return e.currentOrg}));(0,o.useEffect)((function(){t?u.setFieldsValue({name:null==r?void 0:r.name,logo:null==r?void 0:r.logo,code:null==r?void 0:r.code,description:null==r?void 0:r.description,verifiedType:null==r?void 0:r.verifiedType,identityType:null==r?void 0:r.identityType,identityImage:null==r?void 0:r.identityImage,identityNumber:null==r?void 0:r.identityNumber,verifyDate:null==r?void 0:r.verifyDate,verifyStatus:null==r?void 0:r.verifyStatus,rejectReason:null==r?void 0:r.rejectReason}):(u.resetFields(),u.setFieldsValue({verifyStatus:"未认证"}))}),[a]);return(0,I.jsx)(Z.Z,{title:t?(0,I.jsx)(k.FormattedMessage,{id:"pages.org.edit",defaultMessage:"编辑组织"}):(0,I.jsx)(k.FormattedMessage,{id:"pages.org.create",defaultMessage:"创建组织"}),onClose:n,open:a,width:600,extra:(0,I.jsxs)(C.Z,{children:[(0,I.jsx)(P.ZP,{onClick:n,children:(0,I.jsx)(k.FormattedMessage,{id:"pages.common.cancel"})}),(0,I.jsx)(P.ZP,{onClick:function(){u.validateFields().then((function(e){s(l()(l()(l()({},r),e),{},{orgUid:null==c?void 0:c.uid}))})).catch((function(e){console.log("Form errors:",e),h.yw.error(d.formatMessage({id:"pages.form.error"}))}))},type:"primary",children:(0,I.jsx)(k.FormattedMessage,{id:"pages.common.save"})})]}),children:(0,I.jsxs)(b.A,{form:u,submitter:!1,children:[(0,I.jsx)(w.Z,{name:"name",label:(0,I.jsx)(k.FormattedMessage,{id:"pages.org.name",defaultMessage:"组织名称"}),rules:[{required:!0,message:d.formatMessage({id:"pages.org.name.required",defaultMessage:"请输入组织名称"})}]}),(0,I.jsx)(w.Z,{name:"logo",label:(0,I.jsx)(k.FormattedMessage,{id:"pages.org.logo",defaultMessage:"Logo"}),placeholder:d.formatMessage({id:"pages.org.logo.placeholder",defaultMessage:"请输入Logo URL"})}),(0,I.jsx)(w.Z,{name:"code",label:(0,I.jsx)(k.FormattedMessage,{id:"pages.org.code",defaultMessage:"组织代码"}),rules:[{required:!0,message:d.formatMessage({id:"pages.org.code.required",defaultMessage:"请输入组织代码"})}]}),(0,I.jsx)(S.Z,{name:"description",label:(0,I.jsx)(k.FormattedMessage,{id:"pages.org.description",defaultMessage:"描述"}),placeholder:d.formatMessage({id:"pages.org.description.placeholder",defaultMessage:"请输入组织描述"})}),(0,I.jsx)(F.Z,{children:"认证信息"}),(0,I.jsx)(j.Z,{name:"verifiedType",label:(0,I.jsx)(k.FormattedMessage,{id:"pages.org.verifiedType",defaultMessage:"认证类型"}),options:[{label:"企业认证",value:"企业认证"},{label:"个人认证",value:"个人认证"},{label:"政府事业单位认证",value:"政府事业单位认证"}],placeholder:d.formatMessage({id:"pages.org.verifiedType.placeholder",defaultMessage:"请选择认证类型"})}),(0,I.jsx)(j.Z,{name:"identityType",label:(0,I.jsx)(k.FormattedMessage,{id:"pages.org.identityType",defaultMessage:"证件类型"}),options:[{label:"营业执照",value:"营业执照"},{label:"身份证",value:"身份证"},{label:"护照",value:"护照"},{label:"其他",value:"其他"}],placeholder:d.formatMessage({id:"pages.org.identityType.placeholder",defaultMessage:"请选择证件类型"})}),(0,I.jsx)(w.Z,{name:"identityImage",label:(0,I.jsx)(k.FormattedMessage,{id:"pages.org.identityImage",defaultMessage:"证件图片"}),placeholder:d.formatMessage({id:"pages.org.identityImage.placeholder",defaultMessage:"请输入证件图片URL"})}),(0,I.jsx)(w.Z,{name:"identityNumber",label:(0,I.jsx)(k.FormattedMessage,{id:"pages.org.identityNumber",defaultMessage:"证件号码"}),placeholder:d.formatMessage({id:"pages.org.identityNumber.placeholder",defaultMessage:"请输入证件号码"})}),(0,I.jsx)(j.Z,{name:"verifyStatus",label:(0,I.jsx)(k.FormattedMessage,{id:"pages.org.verifyStatus",defaultMessage:"认证状态"}),options:[{label:"未认证",value:"未认证"},{label:"已认证",value:"已认证"},{label:"审核中",value:"审核中"},{label:"审核失败",value:"审核失败"}],placeholder:d.formatMessage({id:"pages.org.verifyStatus.placeholder",defaultMessage:"请选择认证状态"})}),(0,I.jsx)(S.Z,{name:"rejectReason",label:(0,I.jsx)(k.FormattedMessage,{id:"pages.org.rejectReason",defaultMessage:"拒绝原因"}),placeholder:d.formatMessage({id:"pages.org.rejectReason.placeholder",defaultMessage:"如果审核失败，请填写拒绝原因"})})]})})},q=r(90838),A=r(78488),E=r(76750),z=r(28977),B=r.n(z),L=r(55735),O=(r(36310),r(17208)),D=r(88721),N=["current","pageSize"],Y=function(){var e=(0,k.useIntl)(),t=(0,o.useRef)(),r=(0,E.Z)().translateString,a=(0,o.useState)(!0),n=y()(a,2),s=n[0],i=(n[1],(0,o.useState)()),u=y()(i,2),c=u[0],f=(u[1],(0,o.useState)(!1)),m=y()(f,2),b=m[0],w=m[1],S=(0,o.useState)(1),j=y()(S,2),R=(j[0],j[1]),Z=(0,o.useState)(10),C=y()(Z,2),P=C[0],F=C[1],z=(0,M.u)((function(e){return e.currentOrg})),Y=(0,A.Z)((function(e){return{roleResult:e.roleResult,roleResultPlatform:e.roleResultPlatform,setRoleResult:e.setRoleResult,setRoleResultPlatform:e.setRoleResultPlatform}})),V=(Y.roleResult,Y.roleResultPlatform,Y.setRoleResult),H=Y.setRoleResultPlatform,U=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:e.formatMessage({id:"pages.org.name"}),dataIndex:"name",copyable:!0},{title:e.formatMessage({id:"pages.org.logo"}),dataIndex:"logo",copyable:!0,hideInSearch:!0,render:function(e,t){return t.logo?(0,I.jsx)("img",{src:t.logo,alt:"logo",style:{width:40,height:40}}):null}},{title:e.formatMessage({id:"pages.org.code"}),dataIndex:"code",copyable:!0},{title:e.formatMessage({id:"pages.org.description"}),dataIndex:"description",hideInSearch:!0,ellipsis:!0},{title:e.formatMessage({id:"pages.org.verifiedType"}),dataIndex:"verifiedType",hideInSearch:!0,render:function(e,t){return(0,D._i)(t.verifiedType)}},{title:e.formatMessage({id:"pages.org.verifyStatus"}),dataIndex:"verifyStatus",hideInSearch:!0,render:function(e,t){return(0,D.Cy)(t.verifyStatus)}},{title:e.formatMessage({id:"pages.org.createdAt"}),key:"createdAt",dataIndex:"createdAt",sorter:!0,hideInSearch:!0,width:180,render:function(e,t){return t.createdAt?B()(t.createdAt).format("YYYY-MM-DD HH:mm:ss"):""}},{title:e.formatMessage({id:"pages.org.updatedAt"}),key:"updatedAt",dataIndex:"updatedAt",sorter:!0,hideInSearch:!0,width:180,render:function(e,t){return t.updatedAt?B()(t.updatedAt).format("YYYY-MM-DD HH:mm:ss"):""}}],K=[].concat(U),W=(0,q.v)((function(e){return e.currentCategory})),J=function(){var r=p()(g()().mark((function r(a){var n,o;return g()().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(console.log("handleSubmitDrawer",a),s?h.yw.loading(e.formatMessage({id:"updating"})):h.yw.loading(e.formatMessage({id:"creating"})),!s){r.next=8;break}return r.next=5,(0,O.RL)(a);case 5:r.t0=r.sent,r.next=11;break;case 8:return r.next=10,(0,O.Kq)(a);case 10:r.t0=r.sent;case 11:n=r.t0,console.log("createOrg response:",a,n),200===n.code?(h.yw.destroy(),h.yw.loading(e.formatMessage({id:"create.success"})),w(!1),null===(o=t.current)||void 0===o||o.reloadAndRest()):(h.yw.destroy(),h.yw.error(n.message));case 14:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),G=function(){var t=p()(g()().mark((function t(){var r,a;return g()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return h.yw.loading(e.formatMessage({id:"loading",defaultMessage:"Loading..."})),r={pageNumber:0,pageSize:100,orgUid:null==z?void 0:z.uid},t.next=4,(0,v.E9)(r);case 4:a=t.sent,console.log("queryRolesByOrg response ",a),200===a.code?(h.yw.destroy(),V(a)):(h.yw.destroy(),h.yw.error(a.message));case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Q=function(){var t=p()(g()().mark((function t(){var r,a;return g()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return h.yw.loading(e.formatMessage({id:"loading",defaultMessage:"Loading..."})),r={pageNumber:0,pageSize:100,level:L.Hxq},t.next=4,(0,v.E9)(r);case 4:a=t.sent,console.log("queryRolesBySuper response ",a),200===a.code?(h.yw.destroy(),H(a)):(h.yw.destroy(),h.yw.error(a.message));case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();(0,o.useEffect)((function(){G(),Q()}),[]),(0,o.useEffect)((function(){var e;console.log("currentCategory:",W),null===(e=t.current)||void 0===e||e.reloadAndRest()}),[W]);return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(x.Z,{columns:K,actionRef:t,cardBordered:!0,scroll:{x:"max-content"},request:function(){var t=p()(g()().mark((function t(a,n,o){var s,i,u,c,f;return g()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("request:",a,n,o),h.yw.loading(e.formatMessage({id:"loading",defaultMessage:"Loading"})),s=a.current,i=a.pageSize,u=d()(a,N),R(s),F(i),c=l()({pageNumber:s-1,pageSize:i},u),t.next=8,(0,O.A8)(c);case 8:return f=t.sent,console.log("getAllOrgs response:",c,f),h.yw.destroy(),200===f.code||h.yw.error(r(f.message)),t.abrupt("return",{data:f.data.content,success:!0,total:f.data.totalElements});case 13:case"end":return t.stop()}}),t)})));return function(e,r,a){return t.apply(this,arguments)}}(),rowKey:"uid",search:{labelWidth:"auto"},pagination:{pageSize:P,showQuickJumper:!0,showSizeChanger:!0,onChange:function(e,t){console.log("pagination onChange:",e,t),R(e),F(t)}},dateFormatter:"string",headerTitle:e.formatMessage({id:"pages.org.list",defaultMessage:"组织列表"}),toolBarRender:function(){return[]}}),b&&(0,I.jsx)(T,{isEdit:s,open:b,org:c,onClose:function(){w(!1)},onSubmit:J})]})},V=n.Z.Content,H=function(){(0,s.s0)();var e=(0,a.Z)().contentStyle;return(0,I.jsx)(n.Z,{children:(0,I.jsx)(n.Z,{children:(0,I.jsx)(V,{style:e,children:(0,I.jsx)(Y,{})})})})}},90838:function(e,t,r){r.d(t,{v:function(){return c}});var a=r(76711),n=r.n(a),o=r(73193),s=r.n(o),i=r(55735),l=r(44435),u=r(83642),d=r(83890);var c=(0,l.Ue)()((0,u.mW)((0,u.tJ)((0,d.n)((function(e,t){return{categoryResult:{data:{content:[]}},categoryTreeOptions:[],categorySelectOptions:[],currentCategory:{uid:i.zBg,name:i.zBg},setCategoryResult:function(t){var r=function(e){var t=[];return e.data.content.forEach((function(e){var r={label:e.name,value:e.uid};t.push(r)})),t}(t),a={uid:i.zBg,name:i.zBg},o=s()(s()({},t),{},{data:s()(s()({},t.data),{},{content:[a].concat(n()(t.data.content))})}),l=function(e){var t=[];return e.data.content.forEach((function(e){var r={title:e.name,key:e.uid,children:[]};e.children&&Array.isArray(e.children)&&(r.children=e.children.map((function(e){return{title:e.name,key:e.uid,children:[]}}))),t.push(r)})),t}(o);e({categoryResult:o,categoryTreeOptions:l,categorySelectOptions:r}),0===t.data.content.length&&e({currentCategory:{uid:i.zBg,name:i.zBg}})},insertCategory:function(t){e((function(e){e.categoryResult.data.content.unshift(t)}))},upgradeCategory:function(t){e((function(e){var r=e.categoryResult.data.content,a=r.findIndex((function(e){return e.uid===t.uid}));-1!==a?r[a]=t:console.warn("Category with uid ".concat(t.uid," not found."))}))},setCurrentCategory:function(t){e({currentCategory:t})},resetDefaultCategory:function(){console.log("resetDefaultCategory"),e({currentCategory:{uid:i.zBg,name:i.zBg}})},setCurrentCategoryUid:function(r){var a=t().categoryResult.data.content.find((function(e){return e.uid===r}));e({currentCategory:a})},deleteCategoryCache:function(){return e({},!0)}}})),{name:i.OMm})))}}]);