"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[4822],{11575:function(e,r,n){var t=n(77260),a=n(44194),o=n(85333),s=n(5901),i=function(e,r){return a.createElement(s.Z,(0,t.Z)({},e,{ref:r,icon:o.Z}))},l=a.forwardRef(i);r.Z=l},22014:function(e,r,n){n.d(r,{Z:function(){return l}});var t=n(77260),a=n(44194),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},s=n(5901),i=function(e,r){return a.createElement(s.Z,(0,t.Z)({},e,{ref:r,icon:o}))};var l=a.forwardRef(i)},22766:function(e,r,n){var t=n(76285),a=n(39328),o=n(17323),s=n(92032),i=n(34651),l=n(72583),u=n(21762),c=n(44194),d=n(63383),p=n(31549),f=["fieldProps","proFieldProps"],g=["fieldProps","proFieldProps"],h="text",m=function(e){var r=(0,s.Z)(e.open||!1,{value:e.open,onChange:e.onOpenChange}),n=(0,t.Z)(r,2),o=n[0],u=n[1];return(0,p.jsx)(i.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(r){var n,t=r.getFieldValue(e.name||[]);return(0,p.jsx)(l.Z,(0,a.Z)((0,a.Z)({getPopupContainer:function(e){return e&&e.parentNode?e.parentNode:e},onOpenChange:function(e){return u(e)},content:(0,p.jsxs)("div",{style:{padding:"4px 0"},children:[null===(n=e.statusRender)||void 0===n?void 0:n.call(e,t),e.strengthText?(0,p.jsx)("div",{style:{marginTop:10},children:(0,p.jsx)("span",{children:e.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},e.popoverProps),{},{open:o,children:e.children}))}})},v=function(e){var r=e.fieldProps,n=e.proFieldProps,t=(0,o.Z)(e,f);return(0,p.jsx)(d.Z,(0,a.Z)({valueType:h,fieldProps:r,filedConfig:{valueType:h},proFieldProps:n},t))};v.Password=function(e){var r=e.fieldProps,n=e.proFieldProps,s=(0,o.Z)(e,g),i=(0,c.useState)(!1),l=(0,t.Z)(i,2),f=l[0],v=l[1];return null!=r&&r.statusRender&&s.name?(0,p.jsx)(m,{name:s.name,statusRender:null==r?void 0:r.statusRender,popoverProps:null==r?void 0:r.popoverProps,strengthText:null==r?void 0:r.strengthText,open:f,onOpenChange:v,children:(0,p.jsx)("div",{children:(0,p.jsx)(d.Z,(0,a.Z)({valueType:"password",fieldProps:(0,a.Z)((0,a.Z)({},(0,u.Z)(r,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(e){var n;null==r||null===(n=r.onBlur)||void 0===n||n.call(r,e),v(!1)},onClick:function(e){var n;null==r||null===(n=r.onClick)||void 0===n||n.call(r,e),v(!0)}}),proFieldProps:n,filedConfig:{valueType:h}},s))})}):(0,p.jsx)(d.Z,(0,a.Z)({valueType:"password",fieldProps:r,proFieldProps:n,filedConfig:{valueType:h}},s))},v.displayName="ProFormComponent",r.Z=v},12581:function(e,r,n){var t=n(39328),a=n(17323),o=n(44194),s=n(63383),i=n(31549),l=["fieldProps","proFieldProps"],u=function(e,r){var n=e.fieldProps,o=e.proFieldProps,u=(0,a.Z)(e,l);return(0,i.jsx)(s.Z,(0,t.Z)({ref:r,valueType:"textarea",fieldProps:n,proFieldProps:o},u))};r.Z=o.forwardRef(u)},56734:function(e,r,n){n.d(r,{A8:function(){return d},FR:function(){return w},Kq:function(){return f},RL:function(){return v},c5:function(){return h},jM:function(){return y}});var t=n(90819),a=n.n(t),o=n(73193),s=n.n(o),i=n(89933),l=n.n(i),u=n(25191),c=n(75699);function d(e){return p.apply(this,arguments)}function p(){return(p=l()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/org/query",{method:"GET",params:s()(s()({},r),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return g.apply(this,arguments)}function g(){return(g=l()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/org/create",{method:"POST",data:s()(s()({},r),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return m.apply(this,arguments)}function m(){return(m=l()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/org/create/by/super",{method:"POST",data:s()(s()({},r),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return x.apply(this,arguments)}function x(){return(x=l()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/org/update",{method:"POST",data:s()(s()({},r),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return Z.apply(this,arguments)}function Z(){return(Z=l()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/org/update/by/super",{method:"POST",data:s()(s()({},r),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return b.apply(this,arguments)}function b(){return(b=l()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/org/delete",{method:"POST",data:s()(s()({},r),{},{channel:u.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},74625:function(e,r,n){n.d(r,{G:function(){return p}});var t=n(73193),a=n.n(t),o=(n(44194),n(21853)),s=n(25191),i=n(28977),l=n.n(i),u=n(31756),c=n(32597),d=n(31549),p=function(e){var r=e.children,n=e.onSuccess,t=e.onError,i={file:null,fileName:"test.png",fileType:"image/png",isAvatar:"true",kbType:s.IrL,categoryUid:"",kbUid:"",channel:s.XtJ},p={name:"file",accept:"image/*",action:(0,c.M$)(),headers:{Authorization:"Bearer "+localStorage.getItem(s.LA8)},data:i,showUploadList:!1,beforeUpload:function(e){console.log("beforeUpload",e);var r=l()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name;return i.file=e,i.fileName=r,i.fileType=e.type,console.log("beforeUpload",i),!0},onChange:function(e){if("uploading"!==e.file.status&&console.log("not uploading:",e.file),"done"===e.file.status)if(console.log("response: ",e.file.response),200===e.file.response.code){var r=e.file.response.data.fileUrl;n(r),u.yw.success("".concat(e.file.name," 上传成功"))}else t(e.file),u.yw.error("".concat(e.file.name," 上传失败"));else"error"===e.file.status&&(u.yw.error("".concat(e.file.name," 上传失败")),t(e.file))}};return(0,d.jsx)(o.Z,a()(a()({},p),{},{children:r}))}},40499:function(e,r,n){n.r(r),n.d(r,{default:function(){return B}});var t=n(90819),a=n.n(t),o=n(73193),s=n.n(o),i=n(89933),l=n.n(i),u=n(45332),c=n.n(u),d=n(31756),p=n(56734),f=n(31881),g=n(74625),h=n(77260),m=n(44194),v={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M894 462c30.9 0 43.8-39.7 18.7-58L530.8 126.2a31.81 31.81 0 00-37.6 0L111.3 404c-25.1 18.2-12.2 58 18.8 58H192v374h-72c-4.4 0-8 3.6-8 8v52c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-52c0-4.4-3.6-8-8-8h-72V462h62zM512 196.7l271.1 197.2H240.9L512 196.7zM264 462h117v374H264V462zm189 0h117v374H453V462zm307 374H642V462h118v374z"}}]},name:"bank",theme:"outlined"},x=n(5901),y=function(e,r){return m.createElement(x.Z,(0,h.Z)({},e,{ref:r,icon:v}))};var Z=m.forwardRef(y),w=n(22014),b=n(11575),j=n(6373),P=n(22766),M=n(12581),T=n(75699),k=n(55738),C=n(34651),z=n(63065),R=n(5858),O=n(9248),F=n(43413),S=n(89176),q=n(77407),H=n(31549),L=k.Z.Title,V=k.Z.Text,B=function(){var e=C.Z.useForm(),r=c()(e,1)[0],n=(0,T.useIntl)(),t=(0,f.u)((function(e){return{currentOrg:e.currentOrg,setCurrentOrg:e.setCurrentOrg}})),o=t.currentOrg,i=t.setCurrentOrg,u=(0,m.useState)(""),h=c()(u,2),v=h[0],x=h[1],y=function(){var e=l()(a()().mark((function e(r){var t,l,u,c,f,g=arguments;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g.length>1&&void 0!==g[1]?g[1]:"save",l=g.length>2?g[2]:void 0,d.yw.loading({content:n.formatMessage({id:"saving"}),key:t,duration:0}),e.prev=3,u=s()(s()({},o),r),console.log("saveOrganization orgObject:",u),e.next=8,(0,p.RL)(u);case 8:if(c=e.sent,console.log("saveOrganization response:",c),200!==c.code){e.next=19;break}return d.yw.destroy(),f=l||n.formatMessage({id:"update.success"}),d.yw.success(f),i(c.data),r.logo&&x(c.data.logo||r.logo),e.abrupt("return",!0);case 19:return d.yw.destroy(),d.yw.error(c.message),e.abrupt("return",!1);case 22:e.next=30;break;case 24:return e.prev=24,e.t0=e.catch(3),d.yw.destroy(),d.yw.error(n.formatMessage({id:"update.failed",defaultMessage:"保存失败"})),console.error("saveOrganization error:",e.t0),e.abrupt("return",!1);case 30:case"end":return e.stop()}}),e,null,[[3,24]])})));return function(r){return e.apply(this,arguments)}}(),k=function(){var e=l()(a()().mark((function e(t){var o,i;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("handleUploadSuccess:",t),x(t),o=r.getFieldsValue(),i=s()(s()({},o),{},{logo:t}),e.next=6,y(i,"save-logo",n.formatMessage({id:"avatar.upload.success",defaultMessage:"Logo上传并保存成功"}));case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),B=function(){var e=l()(a()().mark((function e(r){var n;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s()(s()({},r),{},{logo:v}),e.next=3,y(n);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();return(0,m.useEffect)((function(){o&&(x(o.logo),r.setFieldsValue({name:o.name,code:o.code,description:o.description}))}),[o,r]),o?(0,H.jsx)("div",{style:{padding:"24px",backgroundColor:"#f0f2f5",minHeight:"100vh"},children:(0,H.jsxs)(z.Z,{variant:"borderless",style:{maxWidth:800,margin:"0 auto",borderRadius:"12px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},children:[(0,H.jsxs)(L,{level:2,style:{marginBottom:"24px",textAlign:"center"},children:[(0,H.jsx)(Z,{style:{marginRight:"8px",color:"#1890ff"}}),n.formatMessage({id:"organization.title",defaultMessage:"组织管理"})]}),(0,H.jsx)(z.Z,{size:"small",style:{marginBottom:"24px",backgroundColor:"#fafafa",borderRadius:"8px"},children:(0,H.jsx)(R.Z,{justify:"center",align:"middle",style:{padding:"20px 0"},children:(0,H.jsx)(O.Z,{children:(0,H.jsxs)(F.Z,{direction:"vertical",align:"center",size:"large",children:[(0,H.jsx)(S.Z,{src:v,size:100,style:{border:"4px solid #fff",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)"}}),(0,H.jsx)(g.G,{onSuccess:k,onError:function(e){console.log("handleUploadError:",e)},children:(0,H.jsx)(q.ZP,{type:"primary",icon:(0,H.jsx)(w.Z,{}),style:{borderRadius:"20px"},children:n.formatMessage({id:"pages.robot.upload",defaultMessage:"上传Logo"})})},"avatar")]})})})}),(0,H.jsx)(j.A,{form:r,onFinish:B,submitter:{render:function(e,r){return(0,H.jsx)(R.Z,{justify:"center",style:{marginTop:"32px"},children:(0,H.jsx)(O.Z,{children:(0,H.jsx)(F.Z,{size:"middle",children:r})})})},submitButtonProps:{size:"large",style:{borderRadius:"8px",minWidth:"120px"}},resetButtonProps:{size:"large",style:{borderRadius:"8px",minWidth:"120px"}}},children:(0,H.jsxs)(z.Z,{title:(0,H.jsxs)(V,{strong:!0,style:{fontSize:"16px"},children:[(0,H.jsx)(b.Z,{style:{marginRight:"8px",color:"#1890ff"}}),"组织信息"]}),size:"small",style:{marginBottom:"24px"},children:[(0,H.jsx)(P.Z,{rules:[{required:!0,message:n.formatMessage({id:"name",defaultMessage:"Name"})}],label:n.formatMessage({id:"name",defaultMessage:"组织名称"}),name:"name",width:"md",fieldProps:{prefix:(0,H.jsx)(b.Z,{style:{color:"#1890ff"}})}}),(0,H.jsx)(P.Z,{rules:[{required:!0,message:n.formatMessage({id:"code",defaultMessage:"Code"})}],label:n.formatMessage({id:"code",defaultMessage:"组织代码"}),name:"code",width:"md",fieldProps:{placeholder:"请输入组织代码..."}}),(0,H.jsx)(M.Z,{rules:[{required:!0,message:n.formatMessage({id:"description",defaultMessage:"Description"})}],label:n.formatMessage({id:"description",defaultMessage:"组织描述"}),name:"description",width:"md",fieldProps:{rows:4,placeholder:"请输入组织描述..."}})]})})]})}):(0,H.jsx)("div",{style:{padding:"24px",backgroundColor:"#f0f2f5",minHeight:"100vh"},children:(0,H.jsx)(z.Z,{variant:"borderless",style:{maxWidth:800,margin:"0 auto",borderRadius:"12px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",textAlign:"center",padding:"100px 0"},children:(0,H.jsx)("div",{children:n.formatMessage({id:"loading",defaultMessage:"加载中..."})})})})}}}]);