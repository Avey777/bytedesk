"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[1466],{11090:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(77260),o=n(44194),a={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"}}]},name:"export",theme:"outlined"},i=n(54183),s=function(e,t){return o.createElement(i.Z,(0,r.Z)({},e,{ref:t,icon:a}))};var l=o.forwardRef(s)},2484:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(77260),o=n(44194),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},i=n(54183),s=function(e,t){return o.createElement(i.Z,(0,r.Z)({},e,{ref:t,icon:a}))};var l=o.forwardRef(s)},82669:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(77260),o=n(44194),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"},i=n(54183),s=function(e,t){return o.createElement(i.Z,(0,r.Z)({},e,{ref:t,icon:a}))};var l=o.forwardRef(s)},59908:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(77260),o=n(44194),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},i=n(54183),s=function(e,t){return o.createElement(i.Z,(0,r.Z)({},e,{ref:t,icon:a}))};var l=o.forwardRef(s)},38197:function(e,t,n){var r=n(39328),o=n(17323),a=n(44194),i=n(64665),s=n(31549),l=["fieldProps","request","params","proFieldProps"],d=function(e,t){var n=e.fieldProps,a=e.request,d=e.params,c=e.proFieldProps,u=(0,o.Z)(e,l);return(0,s.jsx)(i.Z,(0,r.Z)({valueType:"treeSelect",fieldProps:n,ref:t,request:a,params:d,filedConfig:{customLightMode:!0},proFieldProps:c},u))},c=a.forwardRef(d);t.Z=c},33232:function(e,t,n){n.d(t,{$l:function(){return h},JT:function(){return b},Xd:function(){return S},gf:function(){return I},lg:function(){return f},lz:function(){return M},p0:function(){return u},s9:function(){return g}});var r=n(90819),o=n.n(r),a=n(73193),i=n.n(a),s=n(89933),l=n.n(s),d=n(5488),c=n(14870);function u(e){return p.apply(this,arguments)}function p(){return(p=l()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/robot/query/org",{method:"GET",params:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return m.apply(this,arguments)}function m(){return(m=l()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/robot/create",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return v.apply(this,arguments)}function v(){return(v=l()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/robot/create/prompt",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return x.apply(this,arguments)}function x(){return(x=l()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/robot/update",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){return y.apply(this,arguments)}function y(){return(y=l()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/robot/update/avatar",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return w.apply(this,arguments)}function w(){return(w=l()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/robot/update/prompt",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return j.apply(this,arguments)}function j(){return(j=l()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/robot/update/kbUid",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e){return Z.apply(this,arguments)}function Z(){return(Z=l()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,c.request)("/api/v1/robot/delete",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},92023:function(e,t,n){n.d(t,{G:function(){return f}});var r=n(73193),o=n.n(r),a=(n(44194),n(15435)),i=n(5488),s=n(28977),l=n.n(s),d=n(95660),c=n(5025),u=n(18580),p=n(31549),f=function(e){var t=e.children,n=e.onSuccess,r=e.onError,s={file:null,fileName:"test.png",fileType:"image/png",isAvatar:"true",kbType:i.IrL,categoryUid:"",kbUid:"",channel:i.XtJ},f={name:"file",accept:"image/*",action:(0,u.M$)(),headers:{Authorization:"Bearer "+localStorage.getItem(i.LA8)},data:s,showUploadList:!1,beforeUpload:function(e){d.Z.log("beforeUpload",e);var t=l()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name;return s.file=e,s.fileName=t,s.fileType=e.type,d.Z.log("beforeUpload",s),!0},onChange:function(e){if("uploading"!==e.file.status&&d.Z.log("not uploading:",e.file),"done"===e.file.status)if(d.Z.log("response: ",e.file.response),200===e.file.response.code){var t=e.file.response.data.fileUrl;n(t),c.yw.success("".concat(e.file.name," 上传成功"))}else r(e.file),c.yw.error("".concat(e.file.name," 上传失败"));else"error"===e.file.status&&(c.yw.error("".concat(e.file.name," 上传失败")),r(e.file))}};return(0,p.jsx)(a.Z,o()(o()({},f),{},{children:t}))}},4845:function(e,t,n){n.r(t),n.d(t,{default:function(){return se}});var r=n(66985),o=n(74424),a=n(5488),i=n(84176),s=n.n(i),l=n(73193),d=n.n(l),c=n(90819),u=n.n(c),p=n(89933),f=n.n(p),m=n(45332),g=n.n(m),v=n(44194),h=n(26411),x=n(5780),M=n(27473),y=n(67652),b=n(78359),w=n(5025),S=n(33232),j=n(14870),I=n(8065),Z=n(10154),k=n.n(Z),E=n(34599),C=n(32394),P=n(47783),$=n(48821),z=n(16331),T=n(85817),O=n(68724),B=n(49616),U=n(45681),H=n(79401),A=n(92023),N=n(59908),D=n(18751),L=n(21463),q=n(91221),R=n(31549),F=T.Z.Text,V=function(e){var t,n,r=e.isEdit,o=e.robot,i=e.open,s=e.level,l=e.onClose,c=e.onSubmit,p=C.A.useForm(),m=g()(p,1)[0],h=(0,j.useIntl)(),M=(0,E.u)((function(e){return e.currentOrg})),y=(0,v.useState)("https://cdn.weiyuai.cn/assets/images/llm/provider/zhipu.png"),b=g()(y,2),S=b[0],Z=(b[1],(0,v.useState)()),T=g()(Z,2),V=T[0],X=T[1],J=(0,I.v)((function(e){return e.categoryResult})),Y=(0,D.Z)(),W=Y.translateString,K=(Y.translateStringTranct,(0,v.useState)(!1)),Q=g()(K,2),G=Q[0],_=Q[1],ee=(0,v.useState)([]),te=g()(ee,2),ne=te[0],re=te[1],oe=(0,v.useState)({}),ae=g()(oe,2),ie=ae[0],se=ae[1],le=(0,v.useState)(!1),de=g()(le,2),ce=de[0],ue=de[1],pe=(0,v.useState)(""),fe=g()(pe,2),me=fe[0],ge=fe[1],ve=(0,v.useState)(""),he=g()(ve,2),xe=he[0],Me=he[1],ye=(0,v.useState)(""),be=g()(ye,2),we=be[0],Se=be[1];(0,v.useEffect)((function(){if(r&&o&&m){var e,t,n,a,i,s;m.setFieldsValue({uid:null==o?void 0:o.uid,nickname:null==o?void 0:o.nickname,name:null==o?void 0:o.name,prompt:null==o||null===(e=o.llm)||void 0===e?void 0:e.prompt,description:null==o?void 0:o.description,categoryUid:null==o?void 0:o.categoryUid,provider:null==o||null===(t=o.llm)||void 0===t?void 0:t.textProvider,model:null==o||null===(n=o.llm)||void 0===n?void 0:n.textModel});var l=null==J||null===(a=J.data)||void 0===a||null===(a=a.content)||void 0===a?void 0:a.find((function(e){return e.uid===(null==o?void 0:o.categoryUid)}));X(l),ge((null==o||null===(i=o.llm)||void 0===i?void 0:i.textProvider)||""),Me((null==o||null===(s=o.llm)||void 0===s?void 0:s.textModel)||""),_((null==o?void 0:o.system)||!1)}else console.log("form resetFields"),m.resetFields(),ge(""),Me(""),Se(""),_(!1);je()}),[o]);var je=function(){var e=f()(u()().mark((function e(){var t,n,r;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={pageNumber:0,pageSize:100,sortBy:"createdAt",sortDirection:"ascend",orgUid:null==M?void 0:M.uid,level:a.whQ},e.next=4,(0,q.mK)(t);case 4:200===(n=e.sent).code?(r=n.data.content||[],re(r)):w.yw.error(n.message),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Failed to fetch providers:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),Ie=(0,v.useCallback)((function(){ue(!0)}),[]),Ze=(0,v.useCallback)((function(){ue(!1)}),[]),ke=(0,v.useCallback)((function(e,t,n){ge(e),Me(t),Se(n),m.setFieldValue("provider",e),m.setFieldValue("model",t),ue(!1)}),[m]),Ee=(0,v.useCallback)((function(e,t){se((function(n){return d()(d()({},n),{},k()({},e,t))}))}),[]);(0,v.useEffect)((function(){}),[o]);return(0,R.jsx)("div",{children:(0,R.jsxs)(O.Z,{title:r?"编辑提示语":"新建提示语",width:650,onClose:l,open:i,extra:(0,R.jsxs)(B.Z,{children:[(0,R.jsx)(x.ZP,{onClick:l,children:"取消"}),(0,R.jsx)(x.ZP,{onClick:function(){console.log("handleSubmit"),m.validateFields().then((function(e){var t;console.log("Form values:",e);var n={uid:r?null==o?void 0:o.uid:"",nickname:e.nickname,name:e.name,avatar:S,categoryUid:null==V?void 0:V.uid,llm:{prompt:e.prompt,textProvider:e.provider,textProviderUid:null===(t=ne.find((function(t){return t.type===e.provider})))||void 0===t?void 0:t.uid,textModel:e.model},description:e.description,type:a.Qeb,level:s,orgUid:null==M?void 0:M.uid};console.log("robotObject:",n),c(n)})).catch((function(e){console.log("Form errors:",e)}))},type:"primary",children:"保存"})]}),children:[(0,R.jsxs)(C.A,{form:m,name:"model",submitter:!1,children:[(0,R.jsx)(P.Z,{label:"类别",name:"categoryUid",required:!0,options:null==J||null===(t=J.data)||void 0===t||null===(t=t.content)||void 0===t||null===(t=t.filter((function(e){return e.uid!==a.zBg})))||void 0===t?void 0:t.map((function(e){return{label:W(null==e?void 0:e.name),value:null==e?void 0:e.uid}})),fieldProps:{allowClear:!0,onChange:function(e){var t;console.log("handleChange:",e),X(null==J||null===(t=J.data)||void 0===t||null===(t=t.content)||void 0===t?void 0:t.find((function(t){return t.uid===e})))}}}),(0,R.jsx)($.Z,{label:"昵称",name:"nickname",required:!0,tooltip:"显示给用户的名称"}),(0,R.jsx)($.Z,{label:"名称",name:"name",tooltip:"内部识别使用的名称",disabled:G,fieldProps:{placeholder:G?"系统代理不可修改名称":"请输入名称"}}),G&&(0,R.jsx)("div",{style:{color:"#ff4d4f",fontSize:"12px",marginTop:"-20px",marginBottom:"10px"},children:"系统内置代理，无法修改名称"}),(0,R.jsx)(C.A.Item,{name:"avatar",valuePropName:"fileList",getValueFromEvent:function(e){return Array.isArray(e)?e:null==e?void 0:e.fileList},label:h.formatMessage({id:"pages.robot.tab.avatar",defaultMessage:"Avatar"}),children:(0,R.jsxs)(A.G,{onSuccess:function(e){console.log("handleUploadSuccess:",e)},onError:function(e){console.log("handleUploadError:",e),w.yw.error(e)},children:[(0,R.jsx)(U.Z,{src:S}),(0,R.jsx)(x.ZP,{icon:(0,R.jsx)(N.Z,{}),children:h.formatMessage({id:"pages.robot.upload",defaultMessage:"Upload"})})]},"avatar")}),(0,R.jsxs)("div",{children:[(0,R.jsx)(F,{style:{marginBottom:"8px",display:"block"},children:"文字对话模型提供商"}),(0,R.jsx)(H.Z,{size:"small",style:{width:"100%",cursor:"pointer",border:"1px solid #d9d9d9",marginBottom:"16px"},onClick:Ie,children:me&&xe?(0,R.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,R.jsxs)("div",{children:[(0,R.jsx)(F,{type:"secondary",children:"供应商："}),(0,R.jsx)(F,{strong:!0,children:W((null===(n=ne.find((function(e){return e.type===me})))||void 0===n?void 0:n.nickname)||me)}),(0,R.jsx)("br",{}),(0,R.jsx)(F,{type:"secondary",children:"模型："}),(0,R.jsx)(F,{strong:!0,children:we||xe})]}),(0,R.jsx)(x.ZP,{type:"primary",children:"更换模型"})]}):(0,R.jsx)("div",{style:{textAlign:"center"},children:(0,R.jsx)(x.ZP,{type:"primary",children:"选择AI模型"})})}),(0,R.jsxs)("div",{style:{display:"none"},children:[(0,R.jsx)(P.Z,{name:"provider",width:"lg"}),(0,R.jsx)(P.Z,{name:"model",width:"lg"})]})]}),(0,R.jsx)(z.Z,{label:"提示语Prompt",name:"prompt",required:!0}),(0,R.jsx)(z.Z,{label:"简介描述",name:"description"})]}),(0,R.jsx)(L.Z,{visible:ce,onCancel:Ze,onOk:ke,initialProvider:me,initialModel:xe,initialModelLabel:we,providers:ne,currentOrgUid:null==M?void 0:M.uid,existingProviderModels:ie,onModelsLoaded:Ee,allowedModelTypes:[a.l55,"CHAT"]})]})})},X=n(7358),J=n(59304),Y=n(15722),W=n(54881),K=n(10162),Q=n(11090),G=n(2484),_=n(81084),ee=n(28977),te=n.n(ee),ne=n(18580),re=n(33363),oe=["current","pageSize","prompt"],ae=function(e){var t=e.level,n=(e.type,(0,v.useRef)()),r=(0,j.useIntl)(),o=(0,v.useState)(!0),i=g()(o,2),l=i[0],c=i[1],p=(0,D.Z)().translateString,m=(0,v.useState)(1),Z=g()(m,2),k=Z[0],C=Z[1],P=(0,v.useState)(10),$=g()(P,2),z=$[0],T=$[1],O=(0,v.useState)(!1),B=g()(O,2),U=B[0],H=B[1],A=(0,v.useState)([]),N=g()(A,2),L=(N[0],N[1]),q=(0,v.useState)({}),F=g()(q,2),ee=F[0],ae=F[1],ie=(0,I.v)((function(e){return e.currentCategory})),se=(0,E.u)((function(e){return e.currentOrg})),le=(0,v.useState)(0),de=g()(le,2),ce=de[0],ue=de[1],pe=(0,v.useState)({}),fe=g()(pe,2),me=fe[0],ge=fe[1],ve=function(){var e=f()(u()().mark((function e(t){var o,a;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w.yw.loading(r.formatMessage({id:"deleting",defaultMessage:"Deleting"})),e.next=3,(0,S.gf)(t);case 3:200===(o=e.sent).code?(w.yw.destroy(),w.yw.success(r.formatMessage({id:"delete.success",defaultMessage:"Delete success"})),null===(a=n.current)||void 0===a||a.reload()):(w.yw.destroy(),w.yw.error(o.message));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),he=function(){var e=f()(u()().mark((function e(t){var o,a,i,s;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l){e.next=8;break}return w.yw.loading(r.formatMessage({id:"updating",defaultMessage:"Updating"})),e.next=4,(0,S.JT)(t);case 4:200===(o=e.sent).code?(w.yw.success(r.formatMessage({id:"update.success",defaultMessage:"update success"})),null===(a=n.current)||void 0===a||a.reload(),H(!1)):w.yw.error(o.message),e.next=13;break;case 8:return w.yw.loading(r.formatMessage({id:"creating",defaultMessage:"Creating"})),e.next=11,(0,S.s9)(t);case 11:200===(i=e.sent).code?(w.yw.success(r.formatMessage({id:"create.success",defaultMessage:"create success"})),null===(s=n.current)||void 0===s||s.reload(),H(!1)):w.yw.error(i.message);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,v.useEffect)((function(){var e;null===(e=n.current)||void 0===e||e.reload()}),[ie]);var xe=function(){var e=f()(u()().mark((function e(n,r,o){var i,s,l;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleExportExcel",n,r,o),i=localStorage.getItem(a.LA8),s=d()({categoryUid:(null==ie?void 0:ie.uid)===a.zBg?"":null==ie?void 0:ie.uid,orgUid:t===a.Hxq?"":null==se?void 0:se.uid,level:t,type:a.Qeb,accessToken:i||"",exportType:n},me),"current"===n?(s.pageNumber=String(k-1),s.pageSize=String(z)):"all"===n?(s.pageNumber="0",s.pageSize="1000"):"range"===n&&void 0!==r&&void 0!==o&&(s.pageNumber=String(r),s.pageSize=String(o)),l=Object.fromEntries(Object.entries(s).filter((function(e){var t=g()(e,2),n=(t[0],t[1]);return null!=n})).map((function(e){var t=g()(e,2),n=t[0],r=t[1];return[n,String(r)]}))),window.open((0,ne.kG)()+"/api/v1/robot/export?"+new URLSearchParams(l).toString());case 6:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Me=function(e){for(var t=[],n=1e3,r=Math.ceil(e/n),o=function(){var r=a,o=a*n+1,i=Math.min((a+1)*n,e);t.push({key:"export-".concat(a),label:"".concat(o,"-").concat(i," (").concat(i-o+1,"条)"),onClick:function(){return xe("range",r,n)}})},a=0;a<r;a++)o();return t},ye=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:r.formatMessage({id:"pages.prompt.uid",defaultMessage:"UID"}),dataIndex:"uid",hideInSearch:!0,fixed:"left"},{title:r.formatMessage({id:"pages.prompt.nickname",defaultMessage:"昵称"}),dataIndex:"nickname",hideInSearch:!1,fixed:"left",width:150,copyable:!0,ellipsis:!0,tooltip:r.formatMessage({id:"pages.prompt.nickname.tooltip",defaultMessage:"代理的昵称，用于展示"})},{title:r.formatMessage({id:"pages.prompt.name",defaultMessage:"名称"}),dataIndex:"name",width:200,copyable:!0,ellipsis:!0,tooltip:r.formatMessage({id:"pages.prompt.name.tooltip",defaultMessage:"代理的名称，用于内部识别"})},{title:r.formatMessage({id:"pages.prompt.description",defaultMessage:"描述"}),dataIndex:"description",width:200,copyable:!0,ellipsis:!0,tooltip:r.formatMessage({id:"pages.prompt.description.tooltip",defaultMessage:"代理的功能描述"})},{title:r.formatMessage({id:"pages.prompt.prompt",defaultMessage:"提示词"}),dataIndex:"prompt",ellipsis:!0,hideInSearch:!1,copyable:!0,width:250,tooltip:r.formatMessage({id:"pages.prompt.prompt.tooltip",defaultMessage:"传递给模型的指令和上下文"}),render:function(e,t){var n,o=(null===(n=t.llm)||void 0===n?void 0:n.prompt)||"-",a=function(){var e=f()(u()().mark((function e(t){return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,re.TE)(t);case 2:e.sent.success?w.yw.success(r.formatMessage({id:"copy.success",defaultMessage:"复制成功"})):w.yw.error(r.formatMessage({id:"copy.failed",defaultMessage:"复制失败"}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,R.jsx)(h.Z,{content:(0,R.jsxs)("div",{children:[(0,R.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[(0,R.jsx)("span",{children:r.formatMessage({id:"pages.prompt.prompt.content",defaultMessage:"提示词内容"})}),(0,R.jsx)(x.ZP,{type:"text",icon:(0,R.jsx)(X.Z,{}),onClick:function(e){e.stopPropagation(),a(o)},title:r.formatMessage({id:"copy.to.clipboard",defaultMessage:"复制到剪贴板"})})]}),(0,R.jsx)("div",{style:{maxWidth:"600px",maxHeight:"400px",overflow:"auto",whiteSpace:"pre-wrap"},children:o})]}),title:r.formatMessage({id:"pages.prompt.prompt",defaultMessage:"提示词"}),trigger:"hover",overlayStyle:{maxWidth:"800px"},children:(0,R.jsx)("span",{style:{cursor:"pointer"},children:o})})}},{title:r.formatMessage({id:"pages.prompt.textProvider",defaultMessage:"文本模型提供商"}),dataIndex:["llm","textProvider"],hideInSearch:!0,width:150,tooltip:r.formatMessage({id:"pages.prompt.textProvider.tooltip",defaultMessage:"文本模型提供商"})},{title:r.formatMessage({id:"pages.prompt.textProviderUid",defaultMessage:"文本模型提供商UID"}),dataIndex:["llm","textProviderUid"],hideInSearch:!0,width:160,tooltip:r.formatMessage({id:"pages.prompt.textProvider.tooltip",defaultMessage:"文本模型提供商Uid"})},{title:r.formatMessage({id:"pages.prompt.model",defaultMessage:"模型"}),dataIndex:["llm","textModel"],hideInSearch:!0,width:150,tooltip:r.formatMessage({id:"pages.prompt.model.tooltip",defaultMessage:"使用的大语言模型"})},{title:r.formatMessage({id:"pages.prompt.visionEnabled",defaultMessage:"视觉模型启用"}),dataIndex:["llm","visionEnabled"],hideInSearch:!0,width:120,tooltip:r.formatMessage({id:"pages.prompt.visionEnabled.tooltip",defaultMessage:"是否启用视觉模型功能"}),render:function(e,t){var n;return null!==(n=t.llm)&&void 0!==n&&n.visionEnabled?"是":"否"}},{title:r.formatMessage({id:"pages.prompt.visionProvider",defaultMessage:"视觉提供商"}),dataIndex:["llm","visionProvider"],hideInSearch:!0,width:120,tooltip:r.formatMessage({id:"pages.prompt.visionProvider.tooltip",defaultMessage:"视觉模型的服务提供商"}),render:function(e,t){var n;return(null===(n=t.llm)||void 0===n?void 0:n.visionProvider)||"-"}},{title:r.formatMessage({id:"pages.prompt.visionModel",defaultMessage:"视觉模型"}),dataIndex:["llm","visionModel"],hideInSearch:!0,width:150,tooltip:r.formatMessage({id:"pages.prompt.visionModel.tooltip",defaultMessage:"使用的视觉模型名称"}),render:function(e,t){var n;return(null===(n=t.llm)||void 0===n?void 0:n.visionModel)||"-"}},{title:r.formatMessage({id:"pages.prompt.audioEnabled",defaultMessage:"语音模型启用"}),dataIndex:["llm","audioEnabled"],hideInSearch:!0,width:120,tooltip:r.formatMessage({id:"pages.prompt.audioEnabled.tooltip",defaultMessage:"是否启用语音模型功能"}),render:function(e,t){var n;return null!==(n=t.llm)&&void 0!==n&&n.audioEnabled?"是":"否"}},{title:r.formatMessage({id:"pages.prompt.audioProvider",defaultMessage:"语音提供商"}),dataIndex:["llm","audioProvider"],hideInSearch:!0,width:120,tooltip:r.formatMessage({id:"pages.prompt.audioProvider.tooltip",defaultMessage:"语音模型的服务提供商"}),render:function(e,t){var n;return(null===(n=t.llm)||void 0===n?void 0:n.audioProvider)||"-"}},{title:r.formatMessage({id:"pages.prompt.audioModel",defaultMessage:"语音模型"}),dataIndex:["llm","audioModel"],hideInSearch:!0,width:150,tooltip:r.formatMessage({id:"pages.prompt.audioModel.tooltip",defaultMessage:"使用的语音模型名称"}),render:function(e,t){var n;return(null===(n=t.llm)||void 0===n?void 0:n.audioModel)||"-"}},{title:r.formatMessage({id:"pages.prompt.temperature",defaultMessage:"温度"}),dataIndex:["llm","temperature"],hideInSearch:!0,width:80,tooltip:r.formatMessage({id:"pages.prompt.temperature.tooltip",defaultMessage:"控制输出的随机性，值越高输出越随机创新"}),render:function(e,t){var n,r;return 0===(null===(n=t.llm)||void 0===n?void 0:n.temperature)?"0":(null===(r=t.llm)||void 0===r?void 0:r.temperature)||"-"}},{title:r.formatMessage({id:"pages.prompt.topK",defaultMessage:"Top K"}),dataIndex:["llm","topK"],hideInSearch:!0,width:80,tooltip:r.formatMessage({id:"pages.prompt.topK.tooltip",defaultMessage:"检索时返回的相关文档数量"}),render:function(e,t){var n;return(null===(n=t.llm)||void 0===n?void 0:n.topK)||"-"}},{title:r.formatMessage({id:"pages.prompt.system",defaultMessage:"系统"}),dataIndex:"system",hideInSearch:!0,width:80,tooltip:r.formatMessage({id:"pages.prompt.system.tooltip",defaultMessage:"是否为系统内置代理"}),render:function(e,t){return t.system?"是":"否"}},{title:r.formatMessage({id:"pages.prompt.kbEnabled",defaultMessage:"知识库启用"}),dataIndex:"kbEnabled",hideInSearch:!0,width:120,tooltip:r.formatMessage({id:"pages.prompt.kbEnabled.tooltip",defaultMessage:"是否启用知识库增强功能"}),render:function(e,t){return t.kbEnabled?"是":"否"}},{title:r.formatMessage({id:"pages.prompt.flowEnabled",defaultMessage:"流程启用"}),dataIndex:"flowEnabled",hideInSearch:!0,width:120,tooltip:r.formatMessage({id:"pages.prompt.flowEnabled.tooltip",defaultMessage:"是否启用流程控制功能"}),render:function(e,t){return t.flowEnabled?"是":"否"}},{title:r.formatMessage({id:"pages.prompt.createdAt",defaultMessage:"创建时间"}),dataIndex:"createdAt",valueType:"dateTime",sorter:!0,width:160,hideInSearch:!0,tooltip:r.formatMessage({id:"pages.prompt.createdAt.tooltip",defaultMessage:"代理创建的时间"}),render:function(e,t){return t.createdAt?te()(t.createdAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:r.formatMessage({id:"pages.prompt.updatedAt",defaultMessage:"更新时间"}),dataIndex:"updatedAt",valueType:"dateTime",sorter:!0,hideInSearch:!0,width:160,tooltip:r.formatMessage({id:"pages.prompt.updatedAt.tooltip",defaultMessage:"代理最后更新的时间"}),render:function(e,t){return t.updatedAt?te()(t.updatedAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:r.formatMessage({id:"actions",defaultMessage:"操作"}),dataIndex:"option",valueType:"option",width:120,fixed:"right",tooltip:r.formatMessage({id:"pages.prompt.actions.tooltip",defaultMessage:"可进行的操作"}),render:function(e,t){var n;return[(0,R.jsx)(M.Z,{title:r.formatMessage({id:"edit",defaultMessage:"编辑"}),children:(0,R.jsx)(x.ZP,{type:"text",size:"small",icon:(0,R.jsx)(J.Z,{}),onClick:function(){return function(e){c(!0),ae(e),H(!0)}(t)}})},"edit"),!(null!=t&&null!==(n=t.uid)&&void 0!==n&&n.includes("void_agent"))&&(0,R.jsx)(y.Z,{title:r.formatMessage({id:"deleteTip",defaultMessage:"删除确认"}),description:"".concat(r.formatMessage({id:"deleteAffirm",defaultMessage:"确认删除"}),"【").concat(p(t.nickname),"】？"),onConfirm:function(){return ve(t)},okText:r.formatMessage({id:"ok",defaultMessage:"确定"}),cancelText:r.formatMessage({id:"cancel",defaultMessage:"取消"}),icon:(0,R.jsx)(Y.Z,{style:{color:"red"}}),children:(0,R.jsx)(M.Z,{title:r.formatMessage({id:"delete",defaultMessage:"删除"}),children:(0,R.jsx)(x.ZP,{type:"text",size:"small",danger:!0,icon:(0,R.jsx)(W.Z,{})})})},"delete")]}}],be=function(){var e=f()(u()().mark((function e(n,o,i){var l,c,p,f,m,g,v,h,x;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w.yw.loading(r.formatMessage({id:"loading",defaultMessage:"Loading"})),l=n.current,c=n.pageSize,p=n.prompt,f=s()(n,oe),C(l),T(c),ge(d()(d()({},f),{},{prompt:p})),m=void 0,g=void 0,o&&Object.keys(o).length>0&&(v=Object.keys(o)[0],m=v,g="ascend"===o[v]?"ascend":"descend"),h=d()(d()({pageNumber:l-1,pageSize:c,nickname:"",orgUid:t===a.Hxq?"":null==se?void 0:se.uid,categoryUid:(null==ie?void 0:ie.uid)===a.zBg?"":null==ie?void 0:ie.uid,type:a.Qeb,level:t},f),{},{prompt:p,sortBy:m,sortDirection:g}),e.next=11,(0,S.p0)(h);case 11:if(x=e.sent,console.log("queryRobotsByOrg response:",x,h),200!==x.code){e.next=20;break}return w.yw.destroy(),L(x.data.content),ue(x.data.totalElements),e.abrupt("return",{data:x.data.content,success:!0,total:x.data.totalElements});case 20:return w.yw.destroy(),w.yw.error(x.message),e.abrupt("return",{data:[],success:!1,total:0});case 23:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(_.Z,{columns:ye,actionRef:n,cardBordered:!0,rowKey:"uid",scroll:{x:2400},search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,pageSize:10,onChange:function(e,t){C(e),T(t)}},dateFormatter:"string",headerTitle:r.formatMessage({id:"pages.prompt.list",defaultMessage:"提示语列表"}),toolBarRender:function(){var e=[(0,R.jsx)(x.ZP,{type:"primary",onClick:function(){c(!1),ae({}),H(!0)},icon:(0,R.jsx)(K.Z,{}),children:r.formatMessage({id:"pages.prompt.create",defaultMessage:"添加提示语"})},"create")],t=[{key:"export-current",icon:(0,R.jsx)(Q.Z,{}),label:r.formatMessage({id:"export.current",defaultMessage:"导出当前页"}),onClick:function(){return xe("current")}}];return ce>0&&(ce<=1e3?t.push({key:"export-all",icon:(0,R.jsx)(Q.Z,{}),label:r.formatMessage({id:"export.all",defaultMessage:"导出全部"})+" (".concat(ce,"条)"),onClick:function(){return xe("all")}}):t.push({key:"export-range",icon:(0,R.jsx)(Q.Z,{}),label:r.formatMessage({id:"export.range",defaultMessage:"分段导出"})+" (".concat(ce,"条)"),children:Me(ce)})),e.push((0,R.jsx)(b.Z,{menu:{items:t},placement:"bottom",children:(0,R.jsxs)(x.ZP,{type:"primary",icon:(0,R.jsx)(Q.Z,{}),children:[r.formatMessage({id:"export",defaultMessage:"导出"}),(0,R.jsx)(G.Z,{})]})},"export")),e},request:be}),U&&(0,R.jsx)(V,{isEdit:l,robot:ee,level:t,open:U,onClose:function(){return H(!1)},onSubmit:he})]})},ie=n(42699),se=function(){var e=(0,o.Z)(),t=e.leftSiderStyle,n=e.contentStyle;return(0,R.jsxs)(r.Z,{style:{height:"100%"},children:[(0,R.jsx)(r.Z.Panel,{defaultSize:"20%",min:"10%",max:"40%",style:t,children:(0,R.jsx)(ie.Z,{type:a.Kvk,level:a.whQ,showKbase:!1})}),(0,R.jsx)(r.Z.Panel,{style:n,children:(0,R.jsx)(ae,{level:a.whQ})})]})}},93892:function(e,t,n){n.d(t,{Z:function(){return H}});var r=n(44194),o=n(58644),a=n(92520),i=n(14377),s=n(64985),l=n(18701),d=n(51865),c=n.n(d),u=n(42976),p=n(63941),f=n(65489),m=n(15288),g=n(35779),v=n(59199),h=n(49336),x=n(79255);const M=(e,t,n,r,o)=>({background:e,border:`${(0,v.bf)(r.lineWidth)} ${r.lineType} ${t}`,[`${o}-icon`]:{color:n}}),y=e=>{const{componentCls:t,motionDurationSlow:n,marginXS:r,marginSM:o,fontSize:a,fontSizeLG:i,lineHeight:s,borderRadiusLG:l,motionEaseInOutCirc:d,withDescriptionIconSize:c,colorText:u,colorTextHeading:p,withDescriptionPadding:f,defaultPadding:m}=e;return{[t]:Object.assign(Object.assign({},(0,h.Wf)(e)),{position:"relative",display:"flex",alignItems:"center",padding:m,wordWrap:"break-word",borderRadius:l,[`&${t}-rtl`]:{direction:"rtl"},[`${t}-content`]:{flex:1,minWidth:0},[`${t}-icon`]:{marginInlineEnd:r,lineHeight:0},"&-description":{display:"none",fontSize:a,lineHeight:s},"&-message":{color:p},[`&${t}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${n} ${d}, opacity ${n} ${d},\n        padding-top ${n} ${d}, padding-bottom ${n} ${d},\n        margin-bottom ${n} ${d}`},[`&${t}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}}),[`${t}-with-description`]:{alignItems:"flex-start",padding:f,[`${t}-icon`]:{marginInlineEnd:o,fontSize:c,lineHeight:0},[`${t}-message`]:{display:"block",marginBottom:r,color:p,fontSize:i},[`${t}-description`]:{display:"block",color:u}},[`${t}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}},b=e=>{const{componentCls:t,colorSuccess:n,colorSuccessBorder:r,colorSuccessBg:o,colorWarning:a,colorWarningBorder:i,colorWarningBg:s,colorError:l,colorErrorBorder:d,colorErrorBg:c,colorInfo:u,colorInfoBorder:p,colorInfoBg:f}=e;return{[t]:{"&-success":M(o,r,n,e,t),"&-info":M(f,p,u,e,t),"&-warning":M(s,i,a,e,t),"&-error":Object.assign(Object.assign({},M(c,d,l,e,t)),{[`${t}-description > pre`]:{margin:0,padding:0}})}}},w=e=>{const{componentCls:t,iconCls:n,motionDurationMid:r,marginXS:o,fontSizeIcon:a,colorIcon:i,colorIconHover:s}=e;return{[t]:{"&-action":{marginInlineStart:o},[`${t}-close-icon`]:{marginInlineStart:o,padding:0,overflow:"hidden",fontSize:a,lineHeight:(0,v.bf)(a),backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${n}-close`]:{color:i,transition:`color ${r}`,"&:hover":{color:s}}},"&-close-text":{color:i,transition:`color ${r}`,"&:hover":{color:s}}}}};var S=(0,x.I$)("Alert",(e=>[y(e),b(e),w(e)]),(e=>({withDescriptionIconSize:e.fontSizeHeading3,defaultPadding:`${e.paddingContentVerticalSM}px 12px`,withDescriptionPadding:`${e.paddingMD}px ${e.paddingContentHorizontalLG}px`}))),j=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};const I={success:o.Z,info:l.Z,error:a.Z,warning:s.Z},Z=e=>{const{icon:t,prefixCls:n,type:o}=e,a=I[o]||null;return t?(0,m.wm)(t,r.createElement("span",{className:`${n}-icon`},t),(()=>({className:c()(`${n}-icon`,t.props.className)}))):r.createElement(a,{className:`${n}-icon`})},k=e=>{const{isClosable:t,prefixCls:n,closeIcon:o,handleClose:a,ariaProps:s}=e,l=!0===o||void 0===o?r.createElement(i.Z,null):o;return t?r.createElement("button",Object.assign({type:"button",onClick:a,className:`${n}-close-icon`,tabIndex:0},s),l):null},E=r.forwardRef(((e,t)=>{const{description:n,prefixCls:o,message:a,banner:i,className:s,rootClassName:l,style:d,onMouseEnter:m,onMouseLeave:v,onClick:h,afterClose:x,showIcon:M,closable:y,closeText:b,closeIcon:w,action:I,id:E}=e,C=j(e,["description","prefixCls","message","banner","className","rootClassName","style","onMouseEnter","onMouseLeave","onClick","afterClose","showIcon","closable","closeText","closeIcon","action","id"]),[P,$]=r.useState(!1);const z=r.useRef(null);r.useImperativeHandle(t,(()=>({nativeElement:z.current})));const{getPrefixCls:T,direction:O,closable:B,closeIcon:U,className:H,style:A}=(0,g.dj)("alert"),N=T("alert",o),[D,L,q]=S(N),R=t=>{var n;$(!0),null===(n=e.onClose)||void 0===n||n.call(e,t)},F=r.useMemo((()=>void 0!==e.type?e.type:i?"warning":"info"),[e.type,i]),V=r.useMemo((()=>!("object"!=typeof y||!y.closeIcon)||(!!b||("boolean"==typeof y?y:!1!==w&&null!=w||!!B))),[b,w,y,B]),X=!(!i||void 0!==M)||M,J=c()(N,`${N}-${F}`,{[`${N}-with-description`]:!!n,[`${N}-no-icon`]:!X,[`${N}-banner`]:!!i,[`${N}-rtl`]:"rtl"===O},H,s,l,q,L),Y=(0,p.Z)(C,{aria:!0,data:!0}),W=r.useMemo((()=>"object"==typeof y&&y.closeIcon?y.closeIcon:b||(void 0!==w?w:"object"==typeof B&&B.closeIcon?B.closeIcon:U)),[w,y,b,U]),K=r.useMemo((()=>{const e=null!=y?y:B;if("object"==typeof e){const{closeIcon:t}=e;return j(e,["closeIcon"])}return{}}),[y,B]);return D(r.createElement(u.ZP,{visible:!P,motionName:`${N}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:e=>({maxHeight:e.offsetHeight}),onLeaveEnd:x},(({className:t,style:o},i)=>r.createElement("div",Object.assign({id:E,ref:(0,f.sQ)(z,i),"data-show":!P,className:c()(J,t),style:Object.assign(Object.assign(Object.assign({},A),d),o),onMouseEnter:m,onMouseLeave:v,onClick:h,role:"alert"},Y),X?r.createElement(Z,{description:n,icon:e.icon,prefixCls:N,type:F}):null,r.createElement("div",{className:`${N}-content`},a?r.createElement("div",{className:`${N}-message`},a):null,n?r.createElement("div",{className:`${N}-description`},n):null),I?r.createElement("div",{className:`${N}-action`},I):null,r.createElement(k,{isClosable:V,prefixCls:N,closeIcon:W,handleClose:R,ariaProps:K})))))}));var C=E,P=n(40730),$=n(22633),z=n(81880),T=n(18232);let O=function(e){function t(){var e;return(0,P.Z)(this,t),(e=(0,z.Z)(this,t,arguments)).state={error:void 0,info:{componentStack:""}},e}return(0,T.Z)(t,e),(0,$.Z)(t,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,info:t})}},{key:"render",value:function(){const{message:e,description:t,id:n,children:o}=this.props,{error:a,info:i}=this.state,s=(null==i?void 0:i.componentStack)||null,l=void 0===e?(a||"").toString():e,d=void 0===t?s:t;return a?r.createElement(C,{id:n,type:"error",message:l,description:r.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},d)}):o}}])}(r.Component);var B=O;const U=C;U.ErrorBoundary=B;var H=U},81880:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(88126),o=n(49717),a=n(98277);function i(e,t,n){return t=(0,r.Z)(t),(0,a.Z)(e,(0,o.Z)()?Reflect.construct(t,n||[],(0,r.Z)(e).constructor):t.apply(e,n))}}}]);