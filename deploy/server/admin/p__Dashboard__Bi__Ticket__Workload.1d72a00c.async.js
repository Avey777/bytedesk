"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[6826],{93689:function(e,t,a){a.d(t,{Z:function(){return o}});var n=a(77260),i=a(44194),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"},s=a(54183),l=function(e,t){return i.createElement(s.Z,(0,n.Z)({},e,{ref:t,icon:r}))};var o=i.forwardRef(l)},90151:function(e,t,a){a.d(t,{Z:function(){return o}});var n=a(77260),i=a(44194),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM504 618H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 490v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8z"}}]},name:"file-text",theme:"outlined"},s=a(54183),l=function(e,t){return i.createElement(s.Z,(0,n.Z)({},e,{ref:t,icon:r}))};var o=i.forwardRef(l)},23837:function(e,t,a){a.r(t);var n=a(90819),i=a.n(n),r=a(89933),s=a.n(r),l=a(45332),o=a.n(l),c=a(44194),d=a(62558),u=a(27904),f=a(49616),m=a(45681),v=a(63628),g=a(79401),h=a(32973),x=a(5780),p=a(78875),y=a(20228),k=a(65532),j=a(61155),b=a(80556),w=a(10022),M=a(90151),Z=a(48004),R=a(14870),Y=a(67165),T=a(5025),S=a(34599),D=a(16698),z=a(94956),C=a(18751),H=a(5488),O=a(28977),F=a.n(O),B=a(99109),E=a(68020),I=a(93689),L=a(31549),U=d.default.RangePicker,P=u.Z.Option;t.default=function(){var e,t,a,n,r=(0,R.useIntl)(),l=(0,C.Z)().translateStringTranct,d=(0,c.useState)(F()().startOf("day")),O=o()(d,2),W=O[0],A=O[1],N=(0,c.useState)(F()().endOf("day")),V=o()(N,2),Q=V[0],q=V[1],G=(0,c.useState)("today"),_=o()(G,2),J=_[0],K=_[1],X=(0,c.useState)(H.whQ),$=o()(X,2),ee=$[0],te=$[1],ae=(0,c.useState)(),ne=o()(ae,2),ie=ne[0],re=ne[1],se=(0,c.useState)(),le=o()(se,2),oe=le[0],ce=le[1],de=(0,S.u)((function(e){return e.currentOrg})),ue=(0,D.E)((function(e){return e})),fe=ue.agentResult,me=ue.setAgentResult,ve=(0,E.H)((function(e){return e})),ge=ve.departmentResult,he=ve.setDepartmentResult,xe=(0,c.useState)(),pe=o()(xe,2),ye=pe[0],ke=pe[1],je=(0,c.useState)(!1),be=o()(je,2),we=be[0],Me=be[1],Ze=[{label:(0,L.jsx)(R.FormattedMessage,{id:"bi.ticket.timeRange.today"}),value:"today"},{label:(0,L.jsx)(R.FormattedMessage,{id:"bi.ticket.timeRange.yesterday"}),value:"yesterday"},{label:(0,L.jsx)(R.FormattedMessage,{id:"bi.ticket.timeRange.week"}),value:"week"},{label:(0,L.jsx)(R.FormattedMessage,{id:"bi.ticket.timeRange.lastWeek"}),value:"lastWeek"},{label:(0,L.jsx)(R.FormattedMessage,{id:"bi.ticket.timeRange.month"}),value:"month"},{label:(0,L.jsx)(R.FormattedMessage,{id:"bi.ticket.timeRange.custom"}),value:"custom"}];(0,c.useEffect)((function(){if("custom"===J)A(W),q(Q);else{var e=F()();"today"===J?(A(e),q(e)):"yesterday"===J?(A(e.subtract(1,"day")),q(e.subtract(1,"day"))):"week"===J?(A(e.startOf("week")),q(e.endOf("week"))):"lastWeek"===J?(A(e.subtract(1,"week").startOf("week")),q(e.subtract(1,"week").endOf("week"))):"month"===J&&(A(e.startOf("month")),q(e.endOf("month")))}}),[J]);var Re=function(){var e=s()(i()().mark((function e(){var t,a;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T.yw.loading("loading"),t={pageNumber:0,pageSize:100,orgUid:null==de?void 0:de.uid},e.next=4,(0,B.dF)(t);case 4:200===(a=e.sent).code?(T.yw.destroy(),he(a),a.data.content.length>0&&ce(a.data.content[0].uid)):(T.yw.destroy(),T.yw.error(a.message));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ye=function(){var e=s()(i()().mark((function e(){var t,a;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T.yw.loading("loading"),t={pageNumber:0,pageSize:50,orgUid:null==de?void 0:de.uid},e.next=4,(0,z._t)(t);case 4:200===(a=e.sent).code?(T.yw.destroy(),me(a),a.data.content.length>0&&re(a.data.content[0].uid)):(T.yw.destroy(),T.yw.error(l(a.message)));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Te=function(){var e=s()(i()().mark((function e(){var t,a;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Me(!0),e.prev=1,T.yw.loading("loading"),t={type:ee,startDate:null==W?void 0:W.format("YYYY-MM-DD"),endDate:null==Q?void 0:Q.format("YYYY-MM-DD"),departmentUid:oe,assigneeUid:ie,orgUid:null==de?void 0:de.uid},e.next=6,(0,Y.AD)(t);case 6:a=e.sent,console.log("queryStatisticTicketByDate response:",a.data,t),200===a.code?(T.yw.destroy(),ke(a.data)):(T.yw.destroy(),T.yw.error(a.message)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),T.yw.error(r.formatMessage({id:"ticket.message.operation.failed"}));case 14:return e.prev=14,Me(!1),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])})));return function(){return e.apply(this,arguments)}}();(0,c.useEffect)((function(){Re(),Ye()}),[]),(0,c.useEffect)((function(){Te()}),[ee,ie,oe]),(0,c.useEffect)((function(){Te()}),[W,Q]);var Se=(null===(e=fe.data)||void 0===e||null===(e=e.content)||void 0===e?void 0:e.map((function(e,t){return{key:null==e?void 0:e.uid,name:l(null==e?void 0:e.nickname),avatar:null==e?void 0:e.avatar,totalTickets:(null==ye?void 0:ye.assigneeTickets)||0,resolvedTickets:(null==ye?void 0:ye.resolvedTickets)||0,avgResolutionTime:"".concat((null==ye?void 0:ye.averageResolutionTime)||0,"小时"),workHours:"8小时",efficiency:(null==ye?void 0:ye.assigneeResolutionRate)||0}})))||[],De=[{title:r.formatMessage({id:"bi.ticket.table.agentName"}),dataIndex:"name",key:"name",render:function(e,t){return(0,L.jsxs)(f.Z,{children:[(0,L.jsx)(m.Z,{src:t.avatar,size:"small"}),(0,L.jsx)("span",{children:e})]})}},{title:r.formatMessage({id:"bi.ticket.table.assigneeTickets"}),dataIndex:"totalTickets",key:"totalTickets"},{title:r.formatMessage({id:"bi.ticket.table.resolvedTickets"}),dataIndex:"resolvedTickets",key:"resolvedTickets"},{title:r.formatMessage({id:"bi.ticket.table.avgResolutionTime"}),dataIndex:"avgResolutionTime",key:"avgResolutionTime",render:function(e){return"".concat(e).concat(r.formatMessage({id:"bi.ticket.unit.minute"}))}},{title:r.formatMessage({id:"bi.ticket.table.efficiency"}),dataIndex:"efficiency",key:"efficiency",render:function(e){return(0,L.jsx)(v.Z,{percent:e,size:"small",format:function(e){return"".concat(e,"%")}})}}];return(0,L.jsxs)("div",{style:{padding:"24px"},children:[(0,L.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,L.jsx)("h2",{children:r.formatMessage({id:"bi.ticket.title.workload"})}),(0,L.jsxs)("p",{children:[r.formatMessage({id:"bi.ticket.description.workload"}),"today"===J&&(0,L.jsxs)("span",{style:{color:"#666",marginLeft:8},children:["(",W.format("YYYY-MM-DD"),")"]}),"yesterday"===J&&(0,L.jsxs)("span",{style:{color:"#666",marginLeft:8},children:["(",W.format("YYYY-MM-DD"),")"]}),("week"===J||"lastWeek"===J||"month"===J||"custom"===J)&&(0,L.jsxs)("span",{style:{color:"#666",marginLeft:8},children:["(",W.format("YYYY-MM-DD")," ~ ",Q.format("YYYY-MM-DD"),")"]})]})]}),(0,L.jsx)(g.Z,{style:{marginBottom:16},children:(0,L.jsx)(f.Z,{direction:"vertical",style:{width:"100%"},children:(0,L.jsxs)(f.Z,{wrap:!0,style:{width:"100%",justifyContent:"space-between"},children:[(0,L.jsxs)(f.Z,{wrap:!0,children:[(0,L.jsx)(h.ZP.Group,{value:J,onChange:function(e){return K(e.target.value)},children:Ze.map((function(e){return(0,L.jsx)(h.ZP.Button,{value:e.value,children:e.label},e.value)}))}),"custom"===J&&(0,L.jsx)(U,{value:[W,Q],onChange:function(e){A(e[0]),q(e[1])}})]}),(0,L.jsxs)(f.Z,{wrap:!0,children:[(0,L.jsxs)(u.Z,{value:ee,onChange:te,style:{width:120},placeholder:r.formatMessage({id:"bi.ticket.filter.type"}),children:[(0,L.jsx)(P,{value:H.whQ,children:r.formatMessage({id:"bi.ticket.filterType.organization"})}),(0,L.jsx)(P,{value:H.fyH,children:r.formatMessage({id:"bi.ticket.filterType.agent"})}),(0,L.jsx)(P,{value:H.nYM,children:r.formatMessage({id:"bi.ticket.filterType.department"})})]}),ee===H.fyH&&(0,L.jsx)(u.Z,{value:ie,onChange:re,style:{width:150},placeholder:r.formatMessage({id:"bi.ticket.filter.agent"}),allowClear:!0,children:null===(t=fe.data)||void 0===t||null===(t=t.content)||void 0===t?void 0:t.map((function(e){return(0,L.jsx)(P,{value:e.uid,children:l(e.nickname)},e.uid)}))}),ee===H.nYM&&(0,L.jsx)(u.Z,{value:oe,onChange:ce,style:{width:150},placeholder:r.formatMessage({id:"bi.ticket.filter.department"}),allowClear:!0,children:null===(a=ge.data)||void 0===a||null===(a=a.content)||void 0===a?void 0:a.map((function(e){return(0,L.jsx)(P,{value:e.uid,children:l(e.name)},e.uid)}))}),(0,L.jsx)(x.ZP,{type:"primary",icon:(0,L.jsx)(b.Z,{}),onClick:function(){return Te()},children:(0,L.jsx)(R.FormattedMessage,{id:"bi.common.refresh"})})]})]})})}),(0,L.jsxs)(p.Z,{gutter:16,style:{marginBottom:"24px"},children:[(0,L.jsx)(y.Z,{span:6,children:(0,L.jsx)(g.Z,{children:(0,L.jsx)(k.Z,{title:r.formatMessage({id:"bi.ticket.card.onlineAgents"}),value:(null===(n=fe.data)||void 0===n||null===(n=n.content)||void 0===n?void 0:n.length)||0,prefix:(0,L.jsx)(w.Z,{}),valueStyle:{color:"#3f8600"}})})}),(0,L.jsx)(y.Z,{span:6,children:(0,L.jsx)(g.Z,{children:(0,L.jsx)(k.Z,{title:r.formatMessage({id:"bi.ticket.card.totalTickets"}),value:(null==ye?void 0:ye.totalTickets)||0,prefix:(0,L.jsx)(M.Z,{}),valueStyle:{color:"#1890ff"}})})}),(0,L.jsx)(y.Z,{span:6,children:(0,L.jsx)(g.Z,{children:(0,L.jsx)(k.Z,{title:r.formatMessage({id:"bi.ticket.card.avgResponseTime"}),value:(null==ye?void 0:ye.averageFirstResponseTime)||0,prefix:(0,L.jsx)(Z.Z,{}),valueStyle:{color:"#722ed1"},suffix:r.formatMessage({id:"bi.ticket.unit.minute"})})})}),(0,L.jsx)(y.Z,{span:6,children:(0,L.jsx)(g.Z,{children:(0,L.jsx)(k.Z,{title:r.formatMessage({id:"bi.ticket.card.assigneeResolutionRate"}),value:(null==ye?void 0:ye.assigneeResolutionRate)||0,prefix:(0,L.jsx)(I.Z,{}),valueStyle:{color:"#eb2f96"},suffix:r.formatMessage({id:"bi.ticket.unit.percent"})})})})]}),(0,L.jsx)(g.Z,{title:"客服工作量详细数据",loading:we,children:(0,L.jsx)(j.Z,{columns:De,dataSource:Se,pagination:!1,size:"middle"})})]})}}}]);