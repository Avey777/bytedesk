"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[9290],{22014:function(e,r,n){n.d(r,{Z:function(){return c}});var t=n(77260),a=n(44194),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},o=n(5901),i=function(e,r){return a.createElement(o.Z,(0,t.Z)({},e,{ref:r,icon:s}))};var c=a.forwardRef(i)},12581:function(e,r,n){var t=n(39328),a=n(17323),s=n(44194),o=n(8598),i=n(31549),c=["fieldProps","proFieldProps"],l=function(e,r){var n=e.fieldProps,s=e.proFieldProps,l=(0,a.Z)(e,c);return(0,i.jsx)(o.Z,(0,t.Z)({ref:r,valueType:"textarea",fieldProps:n,proFieldProps:s},l))};r.Z=s.forwardRef(l)},98899:function(e,r,n){n.d(r,{Z:function(){return w}});var t=n(90819),a=n.n(t),s=n(89933),o=n.n(s),i=n(45332),c=n.n(i),l=n(31756),u=n(25191),d=n(75699);function f(){return p.apply(this,arguments)}function p(){return(p=o()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/kaptcha/api/v1/get",{method:"GET",params:{channel:u.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e,r){return h.apply(this,arguments)}function h(){return(h=o()(a()().mark((function e(r,n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/kaptcha/api/v1/check",{method:"POST",data:{captchaUid:r,captchaCode:n,channel:u.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var m=n(80597),x=n(25950),v=n(44194),y=n(31549),w=function(e){var r=e.onKaptchaChange,n=e.onKaptchaCheck,t=(0,d.useIntl)(),s=(0,v.useState)(),i=c()(s,2),u=i[0],p=i[1],h=(0,v.useState)(),w=c()(h,2),j=w[0],b=w[1],Z=function(){var e=o()(a()().mark((function e(){var r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:200===(r=e.sent).code?(p(r.data.captchaUid),b(r.data.captchaImage)):l.yw.error(t.formatMessage({id:"kaptcha.get.error",defaultMessage:"获取验证码失败"}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=o()(a()().mark((function e(r,t){var s;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(r,t);case 2:s=e.sent,console.log("checkCaptcha response",s),200===s.code?n&&n(!0):n&&n(!1);case 5:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}();(0,v.useEffect)((function(){Z()}),[]);return(0,y.jsx)(y.Fragment,{children:j&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(x.Z,{onChange:function(e){r&&(r(u,e.target.value),e.target.value&&""!==e.target.value&&4===e.target.value.trim().length?k(u,e.target.value):n&&n(!1))},prefix:(0,y.jsx)(m.Z,{}),placeholder:t.formatMessage({id:"captcha",defaultMessage:"captcha"}),style:{width:"65%",float:"left",height:40},allowClear:!0}),(0,y.jsx)("img",{src:j,alt:"captcha",onClick:Z})]})})}},74625:function(e,r,n){n.d(r,{G:function(){return f}});var t=n(73193),a=n.n(t),s=(n(44194),n(21853)),o=n(25191),i=n(28977),c=n.n(i),l=n(31756),u=n(32597),d=n(31549),f=function(e){var r=e.children,n=e.onSuccess,t=e.onError,i={file:null,fileName:"test.png",fileType:"image/png",isAvatar:"true",kbType:o.IrL,categoryUid:"",kbUid:"",channel:o.XtJ},f={name:"file",accept:"image/*",action:(0,u.M$)(),headers:{Authorization:"Bearer "+localStorage.getItem(o.LA8)},data:i,showUploadList:!1,beforeUpload:function(e){console.log("beforeUpload",e);var r=c()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name;return i.file=e,i.fileName=r,i.fileType=e.type,console.log("beforeUpload",i),!0},onChange:function(e){if("uploading"!==e.file.status&&console.log("not uploading:",e.file),"done"===e.file.status)if(console.log("response: ",e.file.response),200===e.file.response.code){var r=e.file.response.data.fileUrl;n(r),l.yw.success("".concat(e.file.name," 上传成功"))}else t(e.file),l.yw.error("".concat(e.file.name," 上传失败"));else"error"===e.file.status&&(l.yw.error("".concat(e.file.name," 上传失败")),t(e.file))}};return(0,d.jsx)(s.Z,a()(a()({},f),{},{children:r}))}},30234:function(e,r,n){var t=n(25191),a=n(32057),s=n(75699);r.Z=function(){var e=(0,s.useIntl)();return{translateString:function(r){return null==r?r:r&&(null!=r&&r.startsWith(t.VoP)||null!=r&&r.startsWith("ROLE_"))?e.formatMessage({id:r,defaultMessage:r}):r},translateStringTranct:function(r){return null==r?r:null!=r&&r.startsWith(t.VoP)||null!=r&&r.startsWith("ROLE_")?(0,a.aS)(e.formatMessage({id:r,defaultMessage:r}),10):(0,a.aS)(r,10)}}}},2746:function(e,r,n){n.r(r),n.d(r,{default:function(){return ne}});var t=n(73193),a=n.n(t),s=n(90819),o=n.n(s),i=n(89933),c=n.n(i),l=n(45332),u=n.n(l),d=n(44194),f=n(55738),p=n(63065),g=n(5858),h=n(9248),m=n(43413),x=n(89176),v=n(77407),y=n(38478),w=n(43443),j=n(6373),b=n(22766),Z=n(12581),k=n(75699),M=n(57039),C=n(22014),P=n(76630),S=n(38086),U=n(16829),I=n(38722),z=n(15883),F=n(76790),R=n(25400),T=n(31756),A=n(74625),E=n(30234),V=n(32057),q=n(14163),L=n(98899),B=n(31881),W=n(25191),N=n(82325),K=n(97913),O=n(35129),G=n(31549),D=function(e){var r=e.open,n=e.onSubmit,t=e.onClose,a=(0,k.useIntl)(),s=j.A.useForm(),i=u()(s,1)[0],l=(0,E.Z)().translateString,f=(0,F.L)((function(e){return{userInfo:e.userInfo,deviceUid:e.deviceUid}})),p=f.userInfo,g=f.deviceUid,h=(0,B.u)((function(e){return e.currentOrg})),m=(0,d.useRef)(),x=(0,d.useState)(""),v=u()(x,2),y=v[0],w=v[1],Z=(0,d.useState)(""),M=u()(Z,2),C=M[0],S=M[1],U=(0,d.useState)(!1),I=u()(U,2),z=I[0],A=I[1],V=function(){var e=c()(o()().mark((function e(r,n){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("captchaUid",r," captchaValue",n),w(r),S(n);case 3:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}(),D=function(){var e=c()(o()().mark((function e(r){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("captcha check result",r),A(r);case 2:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),H=function(){var e=c()(o()().mark((function e(){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.validateFields().then(function(){var e=c()(o()().mark((function e(r){var a,s;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("changeEmail:",r),(null==p?void 0:p.email)!==r.email){e.next=4;break}return T.yw.error("Email is not changed!"),e.abrupt("return");case 4:return a={email:r.email,code:r.code,platform:W.iw8},e.next=7,(0,R.Uk)(a);case 7:s=e.sent,console.log("changeEmail response:",s),200===s.code?(T.yw.success("Email changed successfully!"),n(r.email),t()):T.yw.error(l(s.message));case 10:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Y=function(){setTimeout((function(){var e;console.log("endCaptchaTiming"),null===(e=m.current)||void 0===e||e.endTiming()}),2)};return(0,G.jsx)(G.Fragment,{children:(0,G.jsx)(O.Z,{title:a.formatMessage({id:"pages.settings.reset.email",defaultMessage:"重置邮箱"}),forceRender:!0,open:r,footer:null,onCancel:function(){t()},children:(0,G.jsxs)(j.A,{form:i,onFinish:function(){var e=c()(o()().mark((function e(r){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("changeEmail:",r),H();case 2:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),children:[(0,G.jsx)(b.Z,{fieldProps:{size:"large",prefix:(0,G.jsx)(N.Z,{})},name:"email",placeholder:a.formatMessage({id:"pages.login.email.placeholder",defaultMessage:"邮箱"}),rules:[{required:!0,message:(0,G.jsx)(k.FormattedMessage,{id:"pages.login.email.required",defaultMessage:"请输入邮箱！"})},{pattern:/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z0-9]{2,6}$/,message:"邮箱格式不正确"},{max:50,message:"邮箱不得超过50字符"}]}),(0,G.jsx)(j.A.Item,{name:"captchaCode",rules:[],children:(0,G.jsx)(L.Z,{onKaptchaChange:V,onKaptchaCheck:D})}),(0,G.jsx)(K.Z,{fieldProps:{size:"large",prefix:(0,G.jsx)(P.Z,{})},captchaProps:{size:"large",disabled:!z},placeholder:a.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"请输入验证码"}),captchaTextRender:function(e,r){return e?"".concat(r," ").concat(a.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"获取验证码"})):a.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"获取验证码"})},phoneName:"email",name:"code",rules:[{required:!0,message:(0,G.jsx)(k.FormattedMessage,{id:"pages.login.captcha.required",defaultMessage:"请输入验证码！"})}],fieldRef:m,onGetCaptcha:function(){var e=c()(o()().mark((function e(r){var n,t;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("email:",r),!r){e.next=18;break}if((null==p?void 0:p.email)!==r){e.next=6;break}return T.yw.error("Email is not changed!"),Y(),e.abrupt("return");case 6:return n={email:r,type:W.Iju,captchaUid:y,captchaCode:C,deviceUid:g,userUid:null==p?void 0:p.uid,orgUid:null==h?void 0:h.uid,platform:W.iw8},e.next=9,(0,q.O8)(n);case 9:if(t=e.sent,console.log("sendEmailCode",t),200===t.code){e.next=15;break}return T.yw.error(t.message),Y(),e.abrupt("return");case 15:T.yw.success(t.message),e.next=19;break;case 18:T.yw.error("手机号格式错误");case 19:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()})]})})})},H=function(e){var r=e.open,n=e.onSubmit,t=e.onClose,a=(0,k.useIntl)(),s=j.A.useForm(),i=u()(s,1)[0],l=(0,E.Z)().translateString,f=(0,F.L)((function(e){return{userInfo:e.userInfo,deviceUid:e.deviceUid}})),p=f.userInfo,g=f.deviceUid,h=(0,B.u)((function(e){return e.currentOrg})),m=(0,d.useRef)(),x=(0,d.useState)(""),v=u()(x,2),y=v[0],w=v[1],Z=(0,d.useState)(""),M=u()(Z,2),C=M[0],S=M[1],U=(0,d.useState)(!1),I=u()(U,2),z=I[0],A=I[1],V=function(){var e=c()(o()().mark((function e(r,n){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("captchaUid",r," captchaValue",n),w(r),S(n);case 3:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}(),D=function(){var e=c()(o()().mark((function e(r){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("captcha check result",r),A(r);case 2:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),H=function(){var e=c()(o()().mark((function e(){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.validateFields().then(function(){var e=c()(o()().mark((function e(r){var a,s;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("changeMobile:",r),(null==p?void 0:p.mobile)!==r.mobile){e.next=4;break}return T.yw.error("mobile is not changed"),e.abrupt("return");case 4:return a={mobile:r.mobile,code:r.code,platform:W.iw8},e.next=7,(0,R.KF)(a);case 7:s=e.sent,console.log("changeMobile response:",s),200===s.code?(T.yw.success("Mobile changed successfully!"),n(r.mobile),t()):T.yw.error(l(s.message));case 10:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Y=function(){setTimeout((function(){var e;console.log("endCaptchaTiming"),null===(e=m.current)||void 0===e||e.endTiming()}),2)};return(0,G.jsx)(G.Fragment,{children:(0,G.jsx)(O.Z,{title:a.formatMessage({id:"pages.settings.reset.mobile",defaultMessage:"重置手机号"}),forceRender:!0,open:r,footer:null,onCancel:function(){t()},children:(0,G.jsxs)(j.A,{form:i,onFinish:function(){var e=c()(o()().mark((function e(r){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("changeMobile:",r),H();case 2:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),children:[(0,G.jsx)(b.Z,{fieldProps:{size:"large",prefix:(0,G.jsx)(N.Z,{})},name:"mobile",placeholder:a.formatMessage({id:"pages.login.phoneNumber.placeholder",defaultMessage:"手机号"}),rules:[{required:!0,message:(0,G.jsx)(k.FormattedMessage,{id:"pages.login.phoneNumber.required",defaultMessage:"请输入手机号！"})},{pattern:/^1\d{10}$/,message:(0,G.jsx)(k.FormattedMessage,{id:"pages.login.phoneNumber.invalid",defaultMessage:"手机号格式错误！"})}]}),(0,G.jsx)(j.A.Item,{name:"captchaCode",rules:[],children:(0,G.jsx)(L.Z,{onKaptchaChange:V,onKaptchaCheck:D})}),(0,G.jsx)(K.Z,{fieldProps:{size:"large",prefix:(0,G.jsx)(P.Z,{})},captchaProps:{size:"large",disabled:!z},placeholder:a.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"请输入验证码"}),captchaTextRender:function(e,r){return e?"".concat(r," ").concat(a.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"获取验证码"})):a.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"获取验证码"})},phoneName:"mobile",name:"code",rules:[{required:!0,message:(0,G.jsx)(k.FormattedMessage,{id:"pages.login.captcha.required",defaultMessage:"请输入验证码！"})}],fieldRef:m,onGetCaptcha:function(){var e=c()(o()().mark((function e(r){var n,t;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("mobile:",r),!r||11!==r.length){e.next=18;break}if((null==p?void 0:p.mobile)!==r){e.next=6;break}return T.yw.error("mobile is not changed"),Y(),e.abrupt("return");case 6:return n={mobile:r,type:W.BG8,captchaUid:y,captchaCode:C,deviceUid:g,userUid:null==p?void 0:p.uid,orgUid:null==h?void 0:h.uid,platform:W.iw8},e.next=9,(0,q.Y7)(n);case 9:if(t=e.sent,console.log("sendMobileCode",t),200===t.code){e.next=15;break}return T.yw.error(t.message),Y(),e.abrupt("return");case 15:T.yw.success(t.message),e.next=19;break;case 18:T.yw.error("手机号格式错误");case 19:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()})]})})})},Y=n(52544);n(46803);function $(e){var r=0;return e?(e.length>=8&&(r+=20),e.length>=12&&(r+=10),/\d/.test(e)&&(r+=20),/[a-z]/.test(e)&&(r+=20),/[A-Z]/.test(e)&&(r+=20),/[!@#$%^&*(),.?":{}|<>]/.test(e)&&(r+=10),Math.min(r,100)):0}var _=n(71373),J=f.Z.Text,X=function(e){var r=e.open,n=e.onClose,t=(0,k.useIntl)(),a=(0,E.Z)().translateString,s=(0,d.useState)(0),i=u()(s,2),l=i[0],f=i[1],p=(0,d.useState)(""),g=u()(p,2),h=g[0],x=g[1],v=function(e){return e>=80?"#52c41a":e>=60?"#faad14":e>=40?"#fa8c16":"#ff4d4f"};return(0,G.jsx)(O.Z,{title:t.formatMessage({id:"pages.settings.reset.password",defaultMessage:"重置密码"}),forceRender:!0,open:r,footer:null,onCancel:function(){n()},children:(0,G.jsxs)(j.A,{initialValues:{oldPassword:"",newPassword:"",confirmPassword:""},onFinish:function(){var e=c()(o()().mark((function e(r){var t,s;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!($(r.newPassword)<40)){e.next=4;break}return T.yw.error("密码强度太弱，请设置更强的密码"),e.abrupt("return");case 4:if(!(r.newPassword.trim().length<6)){e.next=7;break}return T.yw.error("密码最小长度不能小于6"),e.abrupt("return");case 7:if(r.newPassword===r.confirmPassword){e.next=10;break}return T.yw.error("两次输入密码不一致"),e.abrupt("return");case 10:return t={oldPassword:r.oldPassword,newPassword:r.newPassword},e.next=13,(0,R.Cp)(t);case 13:200===(s=e.sent).code?(T.yw.success("Password changed successfully!"),n()):T.yw.error(a(s.message));case 15:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),children:[(0,G.jsx)(b.Z.Password,{name:"oldPassword",label:"原密码(手机号直接登录用户，可以留空)"}),(0,G.jsx)(b.Z.Password,{name:"newPassword",label:"新密码",fieldProps:{onChange:function(e){var r,n=$(e.target.value),t=(r=n)>=80?"强":r>=60?"中":r>=40?"弱":"很弱";f(n),x(t)}},rules:[{required:!0,message:"请输入新密码"},{min:6,message:"密码长度不能少于6位"}]}),l>0&&(0,G.jsx)("div",{style:{marginBottom:16},children:(0,G.jsxs)(m.Z,{direction:"vertical",style:{width:"100%"},children:[(0,G.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,G.jsx)(J,{type:"secondary",children:"密码强度："}),(0,G.jsx)(J,{strong:!0,style:{color:v(l)},children:h})]}),(0,G.jsx)(_.Z,{percent:l,strokeColor:v(l),showInfo:!1,size:"small"}),(0,G.jsx)(J,{type:"secondary",style:{fontSize:"12px"},children:"建议：包含大小写字母、数字和特殊字符，长度至少8位"})]})}),(0,G.jsx)(b.Z.Password,{name:"confirmPassword",label:"确认密码",rules:[{required:!0,message:"请确认密码"},function(e){var r=e.getFieldValue;return{validator:function(e,n){return n&&r("newPassword")!==n?Promise.reject(new Error("两次输入密码不一致")):Promise.resolve()}}}]})]})})},Q={labelCol:{span:6},wrapperCol:{span:18}},ee=f.Z.Title,re=f.Z.Text,ne=function(){var e=(0,k.useIntl)(),r=(0,Y.Z)().isDarkMode,n=j.A.useForm(),t=u()(n,1)[0],s=(0,E.Z)().translateString,i=(0,F.L)((function(e){return{userInfo:e.userInfo,setUserInfo:e.setUserInfo}})),l=i.userInfo,f=i.setUserInfo,q=(0,d.useState)(""),L=u()(q,2),B=L[0],W=L[1],N=(0,d.useState)(!1),K=u()(N,2),O=K[0],$=K[1],_=(0,d.useState)(!1),J=u()(_,2),ne=J[0],te=J[1],ae=(0,d.useState)(!1),se=u()(ae,2),oe=se[0],ie=se[1],ce=function(){var r=c()(o()().mark((function r(n,a){var i,c;return o()().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,(0,R.ck)(n);case 3:if(i=r.sent,console.log("updateProfile response:",i),200!==i.code){r.next=12;break}return c=a||e.formatMessage({id:"update.success"}),T.yw.success(c),i.data.username!==l.username?(0,V.NZ)():(f(i.data),t.setFieldsValue({uid:i.data.uid,username:i.data.username,nickname:s(i.data.nickname),email:i.data.email,mobile:i.data.mobile,description:s(i.data.description)})),r.abrupt("return",!0);case 12:return T.yw.error(i.message),r.abrupt("return",!1);case 14:r.next=21;break;case 16:return r.prev=16,r.t0=r.catch(0),console.error("Update profile error:",r.t0),T.yw.error(e.formatMessage({id:"update.failed",defaultMessage:"更新失败"})),r.abrupt("return",!1);case 21:case"end":return r.stop()}}),r,null,[[0,16]])})));return function(e,n){return r.apply(this,arguments)}}(),le=function(){var r=c()(o()().mark((function r(n){var t;return o()().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return console.log("handleUploadSuccess:",n),W(n),t=a()(a()({},l),{},{avatar:n}),r.next=5,ce(t,e.formatMessage({id:"avatar.upload.success",defaultMessage:"头像上传成功"}));case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),ue=function(){var e=c()(o()().mark((function e(r){var n;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a()(a()(a()({},l),r),{},{avatar:B}),console.log("Form submit userObject:",n),e.next=4,ce(n);case 4:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();(0,d.useEffect)((function(){l&&W(l.avatar)}),[l]);var de=function(){var e=c()(o()().mark((function e(){var r;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,R.Ai)();case 2:r=e.sent,console.log("handleRefreshProfile getProfile response:",r),200===r.code?(f(r.data),t.setFieldsValue({uid:r.data.uid,username:r.data.username,nickname:s(r.data.nickname),email:r.data.email,mobile:r.data.mobile,description:s(r.data.description)})):T.yw.error(r.message);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,d.useEffect)((function(){de()}),[]),(0,G.jsxs)("div",{style:{padding:"24px",backgroundColor:r?"#1f1f1f":"#f0f2f5",minHeight:"100vh"},children:[(0,G.jsxs)(p.Z,{variant:"borderless",style:{maxWidth:800,margin:"0 auto",borderRadius:"12px",boxShadow:r?"0 2px 8px rgba(255, 255, 255, 0.05)":"0 2px 8px rgba(0, 0, 0, 0.1)"},children:[(0,G.jsxs)(ee,{level:2,style:{marginBottom:"24px",textAlign:"center"},children:[(0,G.jsx)(M.Z,{style:{marginRight:"8px",color:"#1890ff"}}),e.formatMessage({id:"profile.title",defaultMessage:"个人资料"})]}),(0,G.jsx)(p.Z,{size:"small",style:{marginBottom:"24px",backgroundColor:r?"#2d2d2d":"#fafafa",borderRadius:"8px"},children:(0,G.jsx)(g.Z,{justify:"center",align:"middle",style:{padding:"20px 0"},children:(0,G.jsx)(h.Z,{children:(0,G.jsxs)(m.Z,{direction:"vertical",align:"center",size:"large",children:[(0,G.jsx)(x.Z,{src:B,size:100,style:{border:"4px solid #fff",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)"}}),(0,G.jsx)(A.G,{onSuccess:le,onError:function(e){console.log("handleUploadError:",e)},children:(0,G.jsx)(v.ZP,{type:"primary",icon:(0,G.jsx)(C.Z,{}),style:{borderRadius:"20px"},children:e.formatMessage({id:"pages.robot.upload",defaultMessage:"上传头像"})})},"avatar")]})})})}),(0,G.jsxs)(j.A,a()(a()({},Q),{},{form:t,onFinish:ue,submitter:{render:function(e,r){return(0,G.jsx)(g.Z,{justify:"center",style:{marginTop:"32px"},children:(0,G.jsx)(h.Z,{children:(0,G.jsx)(m.Z,{size:"middle",children:r})})})},submitButtonProps:{size:"large",style:{borderRadius:"8px",minWidth:"120px"}},resetButtonProps:{size:"large",style:{borderRadius:"8px",minWidth:"120px"}}},children:[(0,G.jsxs)(p.Z,{title:(0,G.jsxs)(re,{strong:!0,style:{fontSize:"16px"},children:[(0,G.jsx)(M.Z,{style:{marginRight:"8px",color:"#1890ff"}}),"基本信息"]}),size:"small",style:{marginBottom:"24px",backgroundColor:r?"#262626":void 0},children:[(0,G.jsx)(b.Z,{name:"uid",label:"用户ID",rules:[{required:!0}],readonly:!0,fieldProps:{style:{backgroundColor:r?"#2a2a2a":"#f5f5f5"}}}),(0,G.jsx)(b.Z,{name:"username",label:e.formatMessage({id:"username.change.tip",defaultMessage:"用户名"}),rules:[{required:!0}],fieldProps:{prefix:(0,G.jsx)(M.Z,{style:{color:"#1890ff"}})}}),(0,G.jsx)(b.Z,{name:"nickname",label:e.formatMessage({id:"nickname",defaultMessage:"昵称"}),rules:[{required:!0}],fieldProps:{prefix:(0,G.jsx)(M.Z,{style:{color:"#52c41a"}})}}),(0,G.jsx)(Z.Z,{name:"description",label:e.formatMessage({id:"description",defaultMessage:"个人简介"}),fieldProps:{rows:4,placeholder:"请输入个人简介..."}})]}),(0,G.jsx)(p.Z,{title:(0,G.jsxs)(re,{strong:!0,style:{fontSize:"16px"},children:[(0,G.jsx)(P.Z,{style:{marginRight:"8px",color:"#fa541c"}}),"安全设置"]}),size:"small",style:{marginBottom:"24px",backgroundColor:r?"#262626":void 0},children:(0,G.jsx)(g.Z,{gutter:[16,16],children:(0,G.jsx)(h.Z,{span:24,children:(0,G.jsxs)(m.Z,{direction:"vertical",style:{width:"100%"},children:[(0,G.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0"},children:[(0,G.jsxs)(m.Z,{children:[(0,G.jsx)(P.Z,{style:{color:"#fa541c"}}),(0,G.jsx)(re,{children:"登录密码"})]}),(0,G.jsx)(v.ZP,{type:"link",onClick:function(){$(!0)},style:{fontWeight:"bold"},children:e.formatMessage({id:"pages.settings.reset.password",defaultMessage:"修改密码"})})]}),(0,G.jsx)(y.Z,{style:{margin:"8px 0"}})]})})})}),(0,G.jsx)(p.Z,{title:(0,G.jsxs)(re,{strong:!0,style:{fontSize:"16px"},children:[(0,G.jsx)(S.Z,{style:{marginRight:"8px",color:"#722ed1"}}),"联系方式"]}),size:"small",children:(0,G.jsx)(g.Z,{gutter:[16,16],children:(0,G.jsxs)(h.Z,{span:24,children:[(0,G.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0"},children:[(0,G.jsxs)(m.Z,{children:[(0,G.jsx)(S.Z,{style:{color:"#722ed1"}}),(0,G.jsx)(re,{children:"邮箱地址"}),null!=l&&l.emailVerified?(0,G.jsx)(w.Z,{icon:(0,G.jsx)(U.Z,{}),color:"success",children:"已验证"}):(0,G.jsx)(w.Z,{icon:(0,G.jsx)(I.Z,{}),color:"error",children:"未验证"})]}),(0,G.jsxs)(m.Z,{children:[(0,G.jsx)(re,{type:"secondary",children:(null==l?void 0:l.email)||"未设置"}),(0,G.jsx)(v.ZP,{type:"link",onClick:function(){te(!0)},style:{fontWeight:"bold"},children:e.formatMessage({id:"pages.settings.reset.email",defaultMessage:"修改邮箱"})})]})]}),(0,G.jsx)(y.Z,{style:{margin:"8px 0"}}),(0,G.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0"},children:[(0,G.jsxs)(m.Z,{children:[(0,G.jsx)(z.Z,{style:{color:"#13c2c2"}}),(0,G.jsx)(re,{children:"手机号码"}),null!=l&&l.mobileVerified?(0,G.jsx)(w.Z,{icon:(0,G.jsx)(U.Z,{}),color:"success",children:"已验证"}):(0,G.jsx)(w.Z,{icon:(0,G.jsx)(I.Z,{}),color:"error",children:"未验证"})]}),(0,G.jsxs)(m.Z,{children:[(0,G.jsx)(re,{type:"secondary",children:(null==l?void 0:l.mobile)||"未设置"}),(0,G.jsx)(v.ZP,{type:"link",onClick:function(){ie(!0)},style:{fontWeight:"bold"},children:e.formatMessage({id:"pages.settings.reset.mobile",defaultMessage:"修改手机号"})})]})]})]})})})]}))]}),O&&(0,G.jsx)(X,{open:O,onClose:function(){$(!1)}}),ne&&(0,G.jsx)(D,{open:ne,onSubmit:function(e){te(!1),l.email=e,f(l),t.setFieldValue("email",e)},onClose:function(){te(!1)}}),oe&&(0,G.jsx)(H,{open:oe,onSubmit:function(e){ie(!1),l.mobile=e,f(l),t.setFieldValue("mobile",e)},onClose:function(){ie(!1)}})]})}}}]);