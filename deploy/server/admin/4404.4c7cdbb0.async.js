"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[4404],{17062:function(e,t,r){r.d(t,{$l:function(){return h},JT:function(){return b},Xd:function(){return S},gf:function(){return j},lg:function(){return f},lz:function(){return x},p0:function(){return p},s9:function(){return g}});var a=r(90819),n=r.n(a),o=r(73193),i=r.n(o),s=r(89933),l=r.n(s),d=r(2622),u=r(59318);function p(e){return c.apply(this,arguments)}function c(){return(c=l()(n()().mark((function e(t){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/robot/query/org",{method:"GET",params:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return m.apply(this,arguments)}function m(){return(m=l()(n()().mark((function e(t){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/robot/create",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return v.apply(this,arguments)}function v(){return(v=l()(n()().mark((function e(t){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/robot/create/prompt",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return M.apply(this,arguments)}function M(){return(M=l()(n()().mark((function e(t){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/robot/update",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return y.apply(this,arguments)}function y(){return(y=l()(n()().mark((function e(t){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/robot/update/avatar",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return w.apply(this,arguments)}function w(){return(w=l()(n()().mark((function e(t){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/robot/update/prompt",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return k.apply(this,arguments)}function k(){return(k=l()(n()().mark((function e(t){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/robot/update/kbUid",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){return I.apply(this,arguments)}function I(){return(I=l()(n()().mark((function e(t){return n()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/robot/delete",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},64404:function(e,t,r){r.d(t,{Z:function(){return ee}});var a=r(84176),n=r.n(a),o=r(73193),i=r.n(o),s=r(90819),l=r.n(s),d=r(89933),u=r.n(d),p=r(45332),c=r.n(p),f=r(44194),m=r(71589),g=r(63855),v=r(20374),h=r(61826),M=r(78929),x=r(17062),y=r(59318),b=r(2622),w=r(23268),S=r(10154),k=r.n(S),j=r(89520),I=r(92964),Z=r(22916),P=r(59935),E=r(67896),T=r(62821),C=r(18613),A=r(12722),U=r(49297),q=r(55599),z=r(78991),O=r(22014),B=r(67794),D=r(38804),F=r(37420),J=r(31549),Y=T.Z.Text,H=function(e){var t,r,a=e.isEdit,n=e.robot,o=e.open,s=e.level,d=e.onClose,p=e.onSubmit,m=I.A.useForm(),g=c()(m,1)[0],h=(0,y.useIntl)(),x=(0,j.u)((function(e){return e.currentOrg})),S=(0,f.useState)("https://cdn.weiyuai.cn/assets/images/llm/provider/zhipu.png"),T=c()(S,2),H=T[0],L=(T[1],(0,f.useState)()),X=c()(L,2),N=X[0],K=X[1],R=(0,w.v)((function(e){return e.categoryResult})),Q=(0,B.Z)(),G=Q.translateString,V=(Q.translateStringTranct,(0,f.useState)(!1)),W=c()(V,2),$=W[0],_=W[1],ee=(0,f.useState)([]),te=c()(ee,2),re=te[0],ae=te[1],ne=(0,f.useState)({}),oe=c()(ne,2),ie=oe[0],se=oe[1],le=(0,f.useState)(!1),de=c()(le,2),ue=de[0],pe=de[1],ce=(0,f.useState)(""),fe=c()(ce,2),me=fe[0],ge=fe[1],ve=(0,f.useState)(""),he=c()(ve,2),Me=he[0],xe=he[1],ye=(0,f.useState)(""),be=c()(ye,2),we=be[0],Se=be[1];(0,f.useEffect)((function(){if(a&&n&&g){var e,t,r,o,i,s;g.setFieldsValue({uid:null==n?void 0:n.uid,nickname:null==n?void 0:n.nickname,name:null==n?void 0:n.name,prompt:null==n||null===(e=n.llm)||void 0===e?void 0:e.prompt,description:null==n?void 0:n.description,categoryUid:null==n?void 0:n.categoryUid,provider:null==n||null===(t=n.llm)||void 0===t?void 0:t.textProvider,model:null==n||null===(r=n.llm)||void 0===r?void 0:r.textModel});var l=null==R||null===(o=R.data)||void 0===o||null===(o=o.content)||void 0===o?void 0:o.find((function(e){return e.uid===(null==n?void 0:n.categoryUid)}));K(l),ge((null==n||null===(i=n.llm)||void 0===i?void 0:i.textProvider)||""),xe((null==n||null===(s=n.llm)||void 0===s?void 0:s.textModel)||""),_((null==n?void 0:n.system)||!1)}else console.log("form resetFields"),g.resetFields(),ge(""),xe(""),Se(""),_(!1);ke()}),[n]);var ke=function(){var e=u()(l()().mark((function e(){var t,r,a;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={pageNumber:0,pageSize:100,sortBy:"createdAt",sortDirection:"ascend",orgUid:null==x?void 0:x.uid,level:b.whQ},e.next=4,(0,F.mK)(t);case 4:200===(r=e.sent).code?(a=r.data.content||[],ae(a)):M.yw.error(r.message),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Failed to fetch providers:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),je=(0,f.useCallback)((function(){pe(!0)}),[]),Ie=(0,f.useCallback)((function(){pe(!1)}),[]),Ze=(0,f.useCallback)((function(e,t,r){ge(e),xe(t),Se(r),g.setFieldValue("provider",e),g.setFieldValue("model",t),pe(!1)}),[g]),Pe=(0,f.useCallback)((function(e,t){se((function(r){return i()(i()({},r),{},k()({},e,t))}))}),[]);(0,f.useEffect)((function(){}),[n]);return(0,J.jsx)("div",{children:(0,J.jsxs)(C.Z,{title:a?"编辑提示语":"新建提示语",width:650,onClose:d,open:o,extra:(0,J.jsxs)(A.Z,{children:[(0,J.jsx)(v.ZP,{onClick:d,children:"取消"}),(0,J.jsx)(v.ZP,{onClick:function(){console.log("handleSubmit"),g.validateFields().then((function(e){console.log("Form values:",e);var t={uid:a?null==n?void 0:n.uid:"",nickname:e.nickname,name:e.name,avatar:H,categoryUid:null==N?void 0:N.uid,llm:{prompt:e.prompt,textProvider:e.provider,textModel:e.model},description:e.description,type:b.Qeb,level:s,orgUid:null==x?void 0:x.uid};console.log("robotObject:",t),p(t)})).catch((function(e){console.log("Form errors:",e)}))},type:"primary",children:"保存"})]}),children:[(0,J.jsxs)(I.A,{form:g,name:"model",submitter:!1,children:[(0,J.jsx)(Z.Z,{label:"类别",name:"categoryUid",required:!0,options:null==R||null===(t=R.data)||void 0===t||null===(t=t.content)||void 0===t||null===(t=t.filter((function(e){return e.uid!==b.zBg})))||void 0===t?void 0:t.map((function(e){return{label:G(null==e?void 0:e.name),value:null==e?void 0:e.uid}})),fieldProps:{allowClear:!0,onChange:function(e){var t;console.log("handleChange:",e),K(null==R||null===(t=R.data)||void 0===t||null===(t=t.content)||void 0===t?void 0:t.find((function(t){return t.uid===e})))}}}),(0,J.jsx)(P.Z,{label:"昵称",name:"nickname",required:!0,tooltip:"显示给用户的名称"}),(0,J.jsx)(P.Z,{label:"名称",name:"name",tooltip:"内部识别使用的名称",disabled:$,fieldProps:{placeholder:$?"系统代理不可修改名称":"请输入名称"}}),$&&(0,J.jsx)("div",{style:{color:"#ff4d4f",fontSize:"12px",marginTop:"-20px",marginBottom:"10px"},children:"系统内置代理，无法修改名称"}),(0,J.jsx)(I.A.Item,{name:"avatar",valuePropName:"fileList",getValueFromEvent:function(e){return Array.isArray(e)?e:null==e?void 0:e.fileList},label:h.formatMessage({id:"pages.robot.tab.avatar",defaultMessage:"Avatar"}),children:(0,J.jsxs)(z.G,{onSuccess:function(e){console.log("handleUploadSuccess:",e)},onError:function(e){console.log("handleUploadError:",e),M.yw.error(e)},children:[(0,J.jsx)(U.Z,{src:H}),(0,J.jsx)(v.ZP,{icon:(0,J.jsx)(O.Z,{}),children:h.formatMessage({id:"pages.robot.upload",defaultMessage:"Upload"})})]},"avatar")}),(0,J.jsxs)("div",{children:[(0,J.jsx)(Y,{style:{marginBottom:"8px",display:"block"},children:"文字对话模型提供商"}),(0,J.jsx)(q.Z,{size:"small",style:{width:"100%",cursor:"pointer",border:"1px solid #d9d9d9",marginBottom:"16px"},onClick:je,children:me&&Me?(0,J.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,J.jsxs)("div",{children:[(0,J.jsx)(Y,{type:"secondary",children:"供应商："}),(0,J.jsx)(Y,{strong:!0,children:G((null===(r=re.find((function(e){return e.name===me})))||void 0===r?void 0:r.nickname)||me)}),(0,J.jsx)("br",{}),(0,J.jsx)(Y,{type:"secondary",children:"模型："}),(0,J.jsx)(Y,{strong:!0,children:we||Me})]}),(0,J.jsx)(v.ZP,{type:"primary",children:"更换模型"})]}):(0,J.jsx)("div",{style:{textAlign:"center"},children:(0,J.jsx)(v.ZP,{type:"primary",children:"选择AI模型"})})}),(0,J.jsxs)("div",{style:{display:"none"},children:[(0,J.jsx)(Z.Z,{name:"provider",width:"lg"}),(0,J.jsx)(Z.Z,{name:"model",width:"lg"})]})]}),(0,J.jsx)(E.Z,{label:"提示语Prompt",name:"prompt",required:!0}),(0,J.jsx)(E.Z,{label:"简介描述",name:"description"})]}),(0,J.jsx)(D.Z,{visible:ue,onCancel:Ie,onOk:Ze,initialProvider:me,initialModel:Me,initialModelLabel:we,providers:re,currentOrgUid:null==x?void 0:x.uid,existingProviderModels:ie,onModelsLoaded:Pe,allowedModelTypes:[b.l55,"CHAT"]})]})})},L=r(83381),X=r(32164),N=r(6992),K=r(28031),R=r(80503),Q=r(99220),G=r(28977),V=r.n(G),W=r(32157),$=r(59639),_=["current","pageSize","prompt"],ee=function(e){var t=e.level,r=(e.type,(0,f.useRef)()),a=(0,y.useIntl)(),o=(0,f.useState)(!0),s=c()(o,2),d=s[0],p=s[1],S=(0,B.Z)().translateString,k=(0,f.useState)(1),I=c()(k,2),Z=I[0],P=I[1],E=(0,f.useState)(10),T=c()(E,2),C=T[0],A=T[1],U=(0,f.useState)(!1),q=c()(U,2),z=q[0],O=q[1],D=(0,f.useState)([]),F=c()(D,2),Y=(F[0],F[1]),G=(0,f.useState)({}),ee=c()(G,2),te=ee[0],re=ee[1],ae=(0,w.v)((function(e){return e.currentCategory})),ne=(0,j.u)((function(e){return e.currentOrg})),oe=m.Z.useModal(),ie=c()(oe,2),se=ie[0],le=ie[1],de=(0,f.useState)(0),ue=c()(de,2),pe=ue[0],ce=ue[1],fe=(0,f.useState)({}),me=c()(fe,2),ge=me[0],ve=me[1],he=function(){var e=u()(l()().mark((function e(t){var n,o;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return M.yw.loading(a.formatMessage({id:"deleting",defaultMessage:"Deleting"})),e.next=3,(0,x.gf)(t);case 3:200===(n=e.sent).code?(M.yw.destroy(),M.yw.success(a.formatMessage({id:"delete.success",defaultMessage:"Delete success"})),null===(o=r.current)||void 0===o||o.reload()):(M.yw.destroy(),M.yw.error(n.message));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Me=function(){var e=u()(l()().mark((function e(t){var n,o,i,s;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d){e.next=8;break}return M.yw.loading(a.formatMessage({id:"updating",defaultMessage:"Updating"})),e.next=4,(0,x.JT)(t);case 4:200===(n=e.sent).code?(M.yw.success(a.formatMessage({id:"update.success",defaultMessage:"update success"})),null===(o=r.current)||void 0===o||o.reload(),O(!1)):M.yw.error(n.message),e.next=13;break;case 8:return M.yw.loading(a.formatMessage({id:"creating",defaultMessage:"Creating"})),e.next=11,(0,x.s9)(t);case 11:200===(i=e.sent).code?(M.yw.success(a.formatMessage({id:"create.success",defaultMessage:"create success"})),null===(s=r.current)||void 0===s||s.reload(),O(!1)):M.yw.error(i.message);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,f.useEffect)((function(){var e;null===(e=r.current)||void 0===e||e.reload()}),[ae]);var xe=function(){var e=u()(l()().mark((function e(r,a,n){var o,s;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleExportExcel",r,a,n),o=localStorage.getItem(b.LA8),s=i()({categoryUid:(null==ae?void 0:ae.uid)===b.zBg?"":null==ae?void 0:ae.uid,orgUid:t===b.Hxq?"":null==ne?void 0:ne.uid,level:t,type:b.Qeb,accessToken:o||"",exportType:r},ge),"current"===r?(s.pageNumber=String(Z-1),s.pageSize=String(C)):"all"===r?(s.pageNumber="0",s.pageSize="1000"):"range"===r&&void 0!==a&&void 0!==n&&(s.pageNumber=String(a),s.pageSize=String(n)),window.open((0,W.kG)()+"/api/v1/robot/export?"+new URLSearchParams(s).toString());case 5:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}(),ye=function(e){for(var t=[],r=1e3,a=Math.ceil(e/r),n=function(){var a=o,n=o*r+1,i=Math.min((o+1)*r,e);t.push({key:"export-".concat(o),label:"".concat(n,"-").concat(i," (").concat(i-n+1,"条)"),onClick:function(){return xe("range",a,r)}})},o=0;o<a;o++)n();return t},be=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:a.formatMessage({id:"pages.prompt.nickname",defaultMessage:"昵称"}),dataIndex:"nickname",hideInSearch:!1,fixed:"left",width:150,copyable:!0,ellipsis:!0,tooltip:a.formatMessage({id:"pages.prompt.nickname.tooltip",defaultMessage:"代理的昵称，用于展示"})},{title:a.formatMessage({id:"pages.prompt.name",defaultMessage:"名称"}),dataIndex:"name",width:200,copyable:!0,ellipsis:!0,tooltip:a.formatMessage({id:"pages.prompt.name.tooltip",defaultMessage:"代理的名称，用于内部识别"})},{title:a.formatMessage({id:"pages.prompt.description",defaultMessage:"描述"}),dataIndex:"description",width:200,copyable:!0,ellipsis:!0,tooltip:a.formatMessage({id:"pages.prompt.description.tooltip",defaultMessage:"代理的功能描述"})},{title:a.formatMessage({id:"pages.prompt.prompt",defaultMessage:"提示词"}),dataIndex:"prompt",ellipsis:!0,hideInSearch:!1,copyable:!0,width:250,tooltip:a.formatMessage({id:"pages.prompt.prompt.tooltip",defaultMessage:"传递给模型的指令和上下文"}),render:function(e,t){var r,n=(null===(r=t.llm)||void 0===r?void 0:r.prompt)||"-",o=function(){var e=u()(l()().mark((function e(t){return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,$.TE)(t);case 2:e.sent.success?M.yw.success(a.formatMessage({id:"copy.success",defaultMessage:"复制成功"})):M.yw.error(a.formatMessage({id:"copy.failed",defaultMessage:"复制失败"}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,J.jsx)(g.Z,{content:(0,J.jsxs)("div",{children:[(0,J.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[(0,J.jsx)("span",{children:a.formatMessage({id:"pages.prompt.prompt.content",defaultMessage:"提示词内容"})}),(0,J.jsx)(v.ZP,{type:"text",icon:(0,J.jsx)(X.Z,{}),onClick:function(e){e.stopPropagation(),o(n)},title:a.formatMessage({id:"copy.to.clipboard",defaultMessage:"复制到剪贴板"})})]}),(0,J.jsx)("div",{style:{maxWidth:"600px",maxHeight:"400px",overflow:"auto",whiteSpace:"pre-wrap"},children:n})]}),title:a.formatMessage({id:"pages.prompt.prompt",defaultMessage:"提示词"}),trigger:"hover",overlayStyle:{maxWidth:"800px"},children:(0,J.jsx)("span",{style:{cursor:"pointer"},children:n})})}},{title:a.formatMessage({id:"pages.prompt.provider",defaultMessage:"提供商"}),dataIndex:["llm","provider"],hideInSearch:!0,width:120,tooltip:a.formatMessage({id:"pages.prompt.provider.tooltip",defaultMessage:"模型提供商"})},{title:a.formatMessage({id:"pages.prompt.model",defaultMessage:"模型"}),dataIndex:["llm","model"],hideInSearch:!0,width:150,tooltip:a.formatMessage({id:"pages.prompt.model.tooltip",defaultMessage:"使用的大语言模型"})},{title:a.formatMessage({id:"pages.prompt.visionEnabled",defaultMessage:"视觉模型启用"}),dataIndex:["llm","visionEnabled"],hideInSearch:!0,width:120,tooltip:a.formatMessage({id:"pages.prompt.visionEnabled.tooltip",defaultMessage:"是否启用视觉模型功能"}),render:function(e,t){var r;return null!==(r=t.llm)&&void 0!==r&&r.visionEnabled?"是":"否"}},{title:a.formatMessage({id:"pages.prompt.visionProvider",defaultMessage:"视觉提供商"}),dataIndex:["llm","visionProvider"],hideInSearch:!0,width:120,tooltip:a.formatMessage({id:"pages.prompt.visionProvider.tooltip",defaultMessage:"视觉模型的服务提供商"}),render:function(e,t){var r;return(null===(r=t.llm)||void 0===r?void 0:r.visionProvider)||"-"}},{title:a.formatMessage({id:"pages.prompt.visionModel",defaultMessage:"视觉模型"}),dataIndex:["llm","visionModel"],hideInSearch:!0,width:150,tooltip:a.formatMessage({id:"pages.prompt.visionModel.tooltip",defaultMessage:"使用的视觉模型名称"}),render:function(e,t){var r;return(null===(r=t.llm)||void 0===r?void 0:r.visionModel)||"-"}},{title:a.formatMessage({id:"pages.prompt.audioEnabled",defaultMessage:"语音模型启用"}),dataIndex:["llm","audioEnabled"],hideInSearch:!0,width:120,tooltip:a.formatMessage({id:"pages.prompt.audioEnabled.tooltip",defaultMessage:"是否启用语音模型功能"}),render:function(e,t){var r;return null!==(r=t.llm)&&void 0!==r&&r.audioEnabled?"是":"否"}},{title:a.formatMessage({id:"pages.prompt.audioProvider",defaultMessage:"语音提供商"}),dataIndex:["llm","audioProvider"],hideInSearch:!0,width:120,tooltip:a.formatMessage({id:"pages.prompt.audioProvider.tooltip",defaultMessage:"语音模型的服务提供商"}),render:function(e,t){var r;return(null===(r=t.llm)||void 0===r?void 0:r.audioProvider)||"-"}},{title:a.formatMessage({id:"pages.prompt.audioModel",defaultMessage:"语音模型"}),dataIndex:["llm","audioModel"],hideInSearch:!0,width:150,tooltip:a.formatMessage({id:"pages.prompt.audioModel.tooltip",defaultMessage:"使用的语音模型名称"}),render:function(e,t){var r;return(null===(r=t.llm)||void 0===r?void 0:r.audioModel)||"-"}},{title:a.formatMessage({id:"pages.prompt.temperature",defaultMessage:"温度"}),dataIndex:["llm","temperature"],hideInSearch:!0,width:80,tooltip:a.formatMessage({id:"pages.prompt.temperature.tooltip",defaultMessage:"控制输出的随机性，值越高输出越随机创新"}),render:function(e,t){var r,a;return 0===(null===(r=t.llm)||void 0===r?void 0:r.temperature)?"0":(null===(a=t.llm)||void 0===a?void 0:a.temperature)||"-"}},{title:a.formatMessage({id:"pages.prompt.topK",defaultMessage:"Top K"}),dataIndex:["llm","topK"],hideInSearch:!0,width:80,tooltip:a.formatMessage({id:"pages.prompt.topK.tooltip",defaultMessage:"检索时返回的相关文档数量"}),render:function(e,t){var r;return(null===(r=t.llm)||void 0===r?void 0:r.topK)||"-"}},{title:a.formatMessage({id:"pages.prompt.system",defaultMessage:"系统"}),dataIndex:"system",hideInSearch:!0,width:80,tooltip:a.formatMessage({id:"pages.prompt.system.tooltip",defaultMessage:"是否为系统内置代理"}),render:function(e,t){return t.system?"是":"否"}},{title:a.formatMessage({id:"pages.prompt.kbEnabled",defaultMessage:"知识库启用"}),dataIndex:"kbEnabled",hideInSearch:!0,width:120,tooltip:a.formatMessage({id:"pages.prompt.kbEnabled.tooltip",defaultMessage:"是否启用知识库增强功能"}),render:function(e,t){return t.kbEnabled?"是":"否"}},{title:a.formatMessage({id:"pages.prompt.flowEnabled",defaultMessage:"流程启用"}),dataIndex:"flowEnabled",hideInSearch:!0,width:120,tooltip:a.formatMessage({id:"pages.prompt.flowEnabled.tooltip",defaultMessage:"是否启用流程控制功能"}),render:function(e,t){return t.flowEnabled?"是":"否"}},{title:a.formatMessage({id:"pages.prompt.createdAt",defaultMessage:"创建时间"}),dataIndex:"createdAt",valueType:"dateTime",sorter:!0,width:160,hideInSearch:!0,tooltip:a.formatMessage({id:"pages.prompt.createdAt.tooltip",defaultMessage:"代理创建的时间"}),render:function(e,t){return t.createdAt?V()(t.createdAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:a.formatMessage({id:"pages.prompt.updatedAt",defaultMessage:"更新时间"}),dataIndex:"updatedAt",valueType:"dateTime",sorter:!0,hideInSearch:!0,width:160,tooltip:a.formatMessage({id:"pages.prompt.updatedAt.tooltip",defaultMessage:"代理最后更新的时间"}),render:function(e,t){return t.updatedAt?V()(t.updatedAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:a.formatMessage({id:"actions",defaultMessage:"操作"}),dataIndex:"option",valueType:"option",width:120,fixed:"right",tooltip:a.formatMessage({id:"pages.prompt.actions.tooltip",defaultMessage:"可进行的操作"}),render:function(e,t){var r;return[(0,J.jsx)("a",{onClick:function(){return function(e){p(!0),re(e),O(!0)}(t)},children:a.formatMessage({id:"pages.robot.edit",defaultMessage:"Edit"})},"edit"),!(null!=t&&null!==(r=t.uid)&&void 0!==r&&r.includes("void_agent"))&&(0,J.jsx)("a",{onClick:function(){return e=t,void se.confirm({title:a.formatMessage({id:"deleteTip"}),icon:(0,J.jsx)(L.Z,{}),content:"".concat(a.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(S(e.nickname),"】？"),onOk:function(){he(e)},okText:a.formatMessage({id:"ok"}),cancelText:a.formatMessage({id:"cancel"})});var e},children:a.formatMessage({id:"pages.robot.delete",defaultMessage:"Delete"})},"delete")]}}],we=function(){var e=u()(l()().mark((function e(r,o,s){var d,u,p,c,f,m,g,v,h;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return M.yw.loading(a.formatMessage({id:"loading",defaultMessage:"Loading"})),d=r.current,u=r.pageSize,p=r.prompt,c=n()(r,_),P(d),A(u),ve(i()(i()({},c),{},{prompt:p})),f=void 0,m=void 0,o&&Object.keys(o).length>0&&(g=Object.keys(o)[0],f=g,m="ascend"===o[g]?"ascend":"descend"),v=i()(i()({pageNumber:d-1,pageSize:u,nickname:"",orgUid:t===b.Hxq?"":null==ne?void 0:ne.uid,categoryUid:(null==ae?void 0:ae.uid)===b.zBg?"":null==ae?void 0:ae.uid,type:b.Qeb,level:t},c),{},{prompt:p,sortBy:f,sortDirection:m}),e.next=11,(0,x.p0)(v);case 11:if(h=e.sent,console.log("queryRobotsByOrg response:",h,v),200!==h.code){e.next=20;break}return M.yw.destroy(),Y(h.data.content),ce(h.data.totalElements),e.abrupt("return",{data:h.data.content,success:!0,total:h.data.totalElements});case 20:return M.yw.destroy(),M.yw.error(h.message),e.abrupt("return",{data:[],success:!1,total:0});case 23:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}();return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(Q.Z,{columns:be,actionRef:r,cardBordered:!0,rowKey:"uid",scroll:{x:2400},search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,pageSize:10,onChange:function(e,t){P(e),A(t)}},dateFormatter:"string",headerTitle:a.formatMessage({id:"pages.prompt.list",defaultMessage:"提示语列表"}),toolBarRender:function(){var e=[(0,J.jsx)(v.ZP,{type:"primary",onClick:function(){p(!1),re({}),O(!0)},icon:(0,J.jsx)(N.Z,{}),children:a.formatMessage({id:"pages.prompt.create",defaultMessage:"添加提示语"})},"create")],t=[{key:"export-current",icon:(0,J.jsx)(K.Z,{}),label:a.formatMessage({id:"export.current",defaultMessage:"导出当前页"}),onClick:function(){return xe("current")}}];return pe>0&&(pe<=1e3?t.push({key:"export-all",icon:(0,J.jsx)(K.Z,{}),label:a.formatMessage({id:"export.all",defaultMessage:"导出全部"})+" (".concat(pe,"条)"),onClick:function(){return xe("all")}}):t.push({key:"export-range",icon:(0,J.jsx)(K.Z,{}),label:a.formatMessage({id:"export.range",defaultMessage:"分段导出"})+" (".concat(pe,"条)"),children:ye(pe)})),e.push((0,J.jsx)(h.Z,{menu:{items:t},placement:"bottom",children:(0,J.jsxs)(v.ZP,{type:"primary",icon:(0,J.jsx)(K.Z,{}),children:[a.formatMessage({id:"export",defaultMessage:"导出"}),(0,J.jsx)(R.Z,{})]})},"export")),e},request:we}),z&&(0,J.jsx)(H,{isEdit:d,robot:te,level:t,open:z,onClose:function(){return O(!1)},onSubmit:Me}),le]})}},78991:function(e,t,r){r.d(t,{G:function(){return f}});var a=r(73193),n=r.n(a),o=(r(44194),r(51679)),i=r(2622),s=r(28977),l=r.n(s),d=r(18598),u=r(78929),p=r(32157),c=r(31549),f=function(e){var t=e.children,r=e.onSuccess,a=e.onError,s={file:null,fileName:"test.png",fileType:"image/png",isAvatar:"true",kbType:i.IrL,categoryUid:"",kbUid:"",channel:i.XtJ},f={name:"file",accept:"image/*",action:(0,p.M$)(),headers:{Authorization:"Bearer "+localStorage.getItem(i.LA8)},data:s,showUploadList:!1,beforeUpload:function(e){d.Z.log("beforeUpload",e);var t=l()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name;return s.file=e,s.fileName=t,s.fileType=e.type,d.Z.log("beforeUpload",s),!0},onChange:function(e){if("uploading"!==e.file.status&&d.Z.log("not uploading:",e.file),"done"===e.file.status)if(d.Z.log("response: ",e.file.response),200===e.file.response.code){var t=e.file.response.data.fileUrl;r(t),u.yw.success("".concat(e.file.name," 上传成功"))}else a(e.file),u.yw.error("".concat(e.file.name," 上传失败"));else"error"===e.file.status&&(u.yw.error("".concat(e.file.name," 上传失败")),a(e.file))}};return(0,c.jsx)(o.Z,n()(n()({},f),{},{children:t}))}}}]);