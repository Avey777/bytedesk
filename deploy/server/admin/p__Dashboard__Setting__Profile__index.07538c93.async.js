"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[9290],{8448:function(e,r,n){n.d(r,{Z:function(){return w}});var t=n(90819),a=n.n(t),s=n(89933),o=n.n(s),i=n(45332),c=n.n(i),l=n(78929),u=n(2622),d=n(59318);function f(){return p.apply(this,arguments)}function p(){return(p=o()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/kaptcha/api/v1/get",{method:"GET",params:{channel:u.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e,r){return h.apply(this,arguments)}function h(){return(h=o()(a()().mark((function e(r,n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/kaptcha/api/v1/check",{method:"POST",data:{captchaUid:r,captchaCode:n,channel:u.XtJ}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var m=n(80597),x=n(71370),v=n(44194),y=n(31549),w=function(e){var r=e.onKaptchaChange,n=e.onKaptchaCheck,t=(0,d.useIntl)(),s=(0,v.useState)(),i=c()(s,2),u=i[0],p=i[1],h=(0,v.useState)(),w=c()(h,2),j=w[0],b=w[1],Z=function(){var e=o()(a()().mark((function e(){var r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:200===(r=e.sent).code?(p(r.data.captchaUid),b(r.data.captchaImage)):l.yw.error(t.formatMessage({id:"kaptcha.get.error",defaultMessage:"获取验证码失败"}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=o()(a()().mark((function e(r,t){var s;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(r,t);case 2:s=e.sent,console.log("checkCaptcha response",s),200===s.code?n&&n(!0):n&&n(!1);case 5:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}();(0,v.useEffect)((function(){Z()}),[]);return(0,y.jsx)(y.Fragment,{children:j&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(x.Z,{onChange:function(e){r&&(r(u,e.target.value),e.target.value&&""!==e.target.value&&4===e.target.value.trim().length?k(u,e.target.value):n&&n(!1))},prefix:(0,y.jsx)(m.Z,{}),placeholder:t.formatMessage({id:"captcha",defaultMessage:"captcha"}),style:{width:"65%",float:"left",height:40},allowClear:!0}),(0,y.jsx)("img",{src:j,alt:"captcha",onClick:Z})]})})}},78991:function(e,r,n){n.d(r,{G:function(){return p}});var t=n(73193),a=n.n(t),s=(n(44194),n(51679)),o=n(2622),i=n(28977),c=n.n(i),l=n(18598),u=n(78929),d=n(32157),f=n(31549),p=function(e){var r=e.children,n=e.onSuccess,t=e.onError,i={file:null,fileName:"test.png",fileType:"image/png",isAvatar:"true",kbType:o.IrL,categoryUid:"",kbUid:"",channel:o.XtJ},p={name:"file",accept:"image/*",action:(0,d.M$)(),headers:{Authorization:"Bearer "+localStorage.getItem(o.LA8)},data:i,showUploadList:!1,beforeUpload:function(e){l.Z.log("beforeUpload",e);var r=c()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name;return i.file=e,i.fileName=r,i.fileType=e.type,l.Z.log("beforeUpload",i),!0},onChange:function(e){if("uploading"!==e.file.status&&l.Z.log("not uploading:",e.file),"done"===e.file.status)if(l.Z.log("response: ",e.file.response),200===e.file.response.code){var r=e.file.response.data.fileUrl;n(r),u.yw.success("".concat(e.file.name," 上传成功"))}else t(e.file),u.yw.error("".concat(e.file.name," 上传失败"));else"error"===e.file.status&&(u.yw.error("".concat(e.file.name," 上传失败")),t(e.file))}};return(0,f.jsx)(s.Z,a()(a()({},p),{},{children:r}))}},26851:function(e,r,n){n.r(r),n.d(r,{default:function(){return ne}});var t=n(73193),a=n.n(t),s=n(90819),o=n.n(s),i=n(89933),c=n.n(i),l=n(45332),u=n.n(l),d=n(44194),f=n(62821),p=n(55599),g=n(89323),h=n(23377),m=n(12722),x=n(49297),v=n(20374),y=n(56389),w=n(59983),j=n(92964),b=n(59935),Z=n(67896),k=n(59318),M=n(57039),C=n(22014),P=n(76630),S=n(38086),U=n(16829),I=n(38722),z=n(15883),F=n(20353),A=n(54135),E=n(78929),R=n(78991),T=n(67794),q=n(59639),V=n(68970),B=n(8448),N=n(89520),K=n(2622),L=n(82325),G=n(50528),W=n(71589),D=n(31549),O=function(e){var r=e.open,n=e.onSubmit,t=e.onClose,a=(0,k.useIntl)(),s=j.A.useForm(),i=u()(s,1)[0],l=(0,T.Z)().translateString,f=(0,F.L)((function(e){return{userInfo:e.userInfo,deviceUid:e.deviceUid}})),p=f.userInfo,g=f.deviceUid,h=(0,N.u)((function(e){return e.currentOrg})),m=(0,d.useRef)(),x=(0,d.useState)(""),v=u()(x,2),y=v[0],w=v[1],Z=(0,d.useState)(""),M=u()(Z,2),C=M[0],S=M[1],U=(0,d.useState)(!1),I=u()(U,2),z=I[0],R=I[1],q=function(){var e=c()(o()().mark((function e(r,n){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("captchaUid",r," captchaValue",n),w(r),S(n);case 3:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}(),O=function(){var e=c()(o()().mark((function e(r){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("captcha check result",r),R(r);case 2:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),Y=function(){var e=c()(o()().mark((function e(){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.validateFields().then(function(){var e=c()(o()().mark((function e(r){var a,s;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("changeEmail:",r),(null==p?void 0:p.email)!==r.email){e.next=4;break}return E.yw.error("Email is not changed!"),e.abrupt("return");case 4:return a={email:r.email,code:r.code,platform:K.iw8},e.next=7,(0,A.Uk)(a);case 7:s=e.sent,console.log("changeEmail response:",s),200===s.code?(E.yw.success("Email changed successfully!"),n(r.email),t()):E.yw.error(l(s.message));case 10:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$=function(){setTimeout((function(){var e;console.log("endCaptchaTiming"),null===(e=m.current)||void 0===e||e.endTiming()}),2)};return(0,D.jsx)(D.Fragment,{children:(0,D.jsx)(W.Z,{title:a.formatMessage({id:"pages.settings.reset.email",defaultMessage:"重置邮箱"}),forceRender:!0,open:r,footer:null,onCancel:function(){t()},children:(0,D.jsxs)(j.A,{form:i,onFinish:function(){var e=c()(o()().mark((function e(r){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("changeEmail:",r),Y();case 2:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),children:[(0,D.jsx)(b.Z,{fieldProps:{size:"large",prefix:(0,D.jsx)(L.Z,{})},name:"email",placeholder:a.formatMessage({id:"pages.login.email.placeholder",defaultMessage:"邮箱"}),rules:[{required:!0,message:(0,D.jsx)(k.FormattedMessage,{id:"pages.login.email.required",defaultMessage:"请输入邮箱！"})},{pattern:/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z0-9]{2,6}$/,message:"邮箱格式不正确"},{max:50,message:"邮箱不得超过50字符"}]}),(0,D.jsx)(j.A.Item,{name:"captchaCode",rules:[],children:(0,D.jsx)(B.Z,{onKaptchaChange:q,onKaptchaCheck:O})}),(0,D.jsx)(G.Z,{fieldProps:{size:"large",prefix:(0,D.jsx)(P.Z,{})},captchaProps:{size:"large",disabled:!z},placeholder:a.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"请输入验证码"}),captchaTextRender:function(e,r){return e?"".concat(r," ").concat(a.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"获取验证码"})):a.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"获取验证码"})},phoneName:"email",name:"code",rules:[{required:!0,message:(0,D.jsx)(k.FormattedMessage,{id:"pages.login.captcha.required",defaultMessage:"请输入验证码！"})}],fieldRef:m,onGetCaptcha:function(){var e=c()(o()().mark((function e(r){var n,t;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("email:",r),!r){e.next=18;break}if((null==p?void 0:p.email)!==r){e.next=6;break}return E.yw.error("Email is not changed!"),$(),e.abrupt("return");case 6:return n={email:r,type:K.Iju,captchaUid:y,captchaCode:C,deviceUid:g,userUid:null==p?void 0:p.uid,orgUid:null==h?void 0:h.uid,platform:K.iw8},e.next=9,(0,V.O8)(n);case 9:if(t=e.sent,console.log("sendEmailCode",t),200===t.code){e.next=15;break}return E.yw.error(t.message),$(),e.abrupt("return");case 15:E.yw.success(t.message),e.next=19;break;case 18:E.yw.error("手机号格式错误");case 19:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()})]})})})},Y=function(e){var r=e.open,n=e.onSubmit,t=e.onClose,a=(0,k.useIntl)(),s=j.A.useForm(),i=u()(s,1)[0],l=(0,T.Z)().translateString,f=(0,F.L)((function(e){return{userInfo:e.userInfo,deviceUid:e.deviceUid}})),p=f.userInfo,g=f.deviceUid,h=(0,N.u)((function(e){return e.currentOrg})),m=(0,d.useRef)(),x=(0,d.useState)(""),v=u()(x,2),y=v[0],w=v[1],Z=(0,d.useState)(""),M=u()(Z,2),C=M[0],S=M[1],U=(0,d.useState)(!1),I=u()(U,2),z=I[0],R=I[1],q=function(){var e=c()(o()().mark((function e(r,n){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("captchaUid",r," captchaValue",n),w(r),S(n);case 3:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}(),O=function(){var e=c()(o()().mark((function e(r){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("captcha check result",r),R(r);case 2:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),Y=function(){var e=c()(o()().mark((function e(){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.validateFields().then(function(){var e=c()(o()().mark((function e(r){var a,s;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("changeMobile:",r),(null==p?void 0:p.mobile)!==r.mobile){e.next=4;break}return E.yw.error("mobile is not changed"),e.abrupt("return");case 4:return a={mobile:r.mobile,code:r.code,platform:K.iw8},e.next=7,(0,A.KF)(a);case 7:s=e.sent,console.log("changeMobile response:",s),200===s.code?(E.yw.success("Mobile changed successfully!"),n(r.mobile),t()):E.yw.error(l(s.message));case 10:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$=function(){setTimeout((function(){var e;console.log("endCaptchaTiming"),null===(e=m.current)||void 0===e||e.endTiming()}),2)};return(0,D.jsx)(D.Fragment,{children:(0,D.jsx)(W.Z,{title:a.formatMessage({id:"pages.settings.reset.mobile",defaultMessage:"重置手机号"}),forceRender:!0,open:r,footer:null,onCancel:function(){t()},children:(0,D.jsxs)(j.A,{form:i,onFinish:function(){var e=c()(o()().mark((function e(r){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("changeMobile:",r),Y();case 2:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),children:[(0,D.jsx)(b.Z,{fieldProps:{size:"large",prefix:(0,D.jsx)(L.Z,{})},name:"mobile",placeholder:a.formatMessage({id:"pages.login.phoneNumber.placeholder",defaultMessage:"手机号"}),rules:[{required:!0,message:(0,D.jsx)(k.FormattedMessage,{id:"pages.login.phoneNumber.required",defaultMessage:"请输入手机号！"})},{pattern:/^1\d{10}$/,message:(0,D.jsx)(k.FormattedMessage,{id:"pages.login.phoneNumber.invalid",defaultMessage:"手机号格式错误！"})}]}),(0,D.jsx)(j.A.Item,{name:"captchaCode",rules:[],children:(0,D.jsx)(B.Z,{onKaptchaChange:q,onKaptchaCheck:O})}),(0,D.jsx)(G.Z,{fieldProps:{size:"large",prefix:(0,D.jsx)(P.Z,{})},captchaProps:{size:"large",disabled:!z},placeholder:a.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"请输入验证码"}),captchaTextRender:function(e,r){return e?"".concat(r," ").concat(a.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"获取验证码"})):a.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"获取验证码"})},phoneName:"mobile",name:"code",rules:[{required:!0,message:(0,D.jsx)(k.FormattedMessage,{id:"pages.login.captcha.required",defaultMessage:"请输入验证码！"})}],fieldRef:m,onGetCaptcha:function(){var e=c()(o()().mark((function e(r){var n,t;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("mobile:",r),!r||11!==r.length){e.next=18;break}if((null==p?void 0:p.mobile)!==r){e.next=6;break}return E.yw.error("mobile is not changed"),$(),e.abrupt("return");case 6:return n={mobile:r,type:K.BG8,captchaUid:y,captchaCode:C,deviceUid:g,userUid:null==p?void 0:p.uid,orgUid:null==h?void 0:h.uid,platform:K.iw8},e.next=9,(0,V.Y7)(n);case 9:if(t=e.sent,console.log("sendMobileCode",t),200===t.code){e.next=15;break}return E.yw.error(t.message),$(),e.abrupt("return");case 15:E.yw.success(t.message),e.next=19;break;case 18:E.yw.error("手机号格式错误");case 19:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()})]})})})},$=n(31557),H=n(21153),J=n(31218),Q=f.Z.Text,X=function(e){var r=e.open,n=e.onClose,t=(0,k.useIntl)(),a=(0,T.Z)().translateString,s=(0,d.useState)(0),i=u()(s,2),l=i[0],f=i[1],p=(0,d.useState)(""),g=u()(p,2),h=g[0],x=g[1],v=function(e){return e>=80?"#52c41a":e>=60?"#faad14":e>=40?"#fa8c16":"#ff4d4f"};return(0,D.jsx)(W.Z,{title:t.formatMessage({id:"pages.settings.reset.password",defaultMessage:"重置密码"}),forceRender:!0,open:r,footer:null,onCancel:function(){n()},children:(0,D.jsxs)(j.A,{initialValues:{oldPassword:"",newPassword:"",confirmPassword:""},onFinish:function(){var e=c()(o()().mark((function e(r){var t,s;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((0,H.Qc)(r.newPassword)<40)){e.next=4;break}return E.yw.error("密码强度太弱，请设置更强的密码"),e.abrupt("return");case 4:if(!(r.newPassword.trim().length<6)){e.next=7;break}return E.yw.error("密码最小长度不能小于6"),e.abrupt("return");case 7:if(r.newPassword===r.confirmPassword){e.next=10;break}return E.yw.error("两次输入密码不一致"),e.abrupt("return");case 10:return t={oldPassword:r.oldPassword,newPassword:r.newPassword},e.next=13,(0,A.Cp)(t);case 13:200===(s=e.sent).code?(E.yw.success("Password changed successfully!"),n()):E.yw.error(a(s.message));case 15:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),children:[(0,D.jsx)(b.Z.Password,{name:"oldPassword",label:"原密码(手机号直接登录用户，可以留空)"}),(0,D.jsx)(b.Z.Password,{name:"newPassword",label:"新密码",fieldProps:{onChange:function(e){var r=e.target.value,n=(0,H.Qc)(r),t=(0,H.$g)(n);f(n),x(t)}},rules:[{required:!0,message:"请输入新密码"},{min:6,message:"密码长度不能少于6位"}]}),l>0&&(0,D.jsx)("div",{style:{marginBottom:16},children:(0,D.jsxs)(m.Z,{direction:"vertical",style:{width:"100%"},children:[(0,D.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,D.jsx)(Q,{type:"secondary",children:"密码强度："}),(0,D.jsx)(Q,{strong:!0,style:{color:v(l)},children:h})]}),(0,D.jsx)(J.Z,{percent:l,strokeColor:v(l),showInfo:!1,size:"small"}),(0,D.jsx)(Q,{type:"secondary",style:{fontSize:"12px"},children:"建议：包含大小写字母、数字和特殊字符，长度至少8位"})]})}),(0,D.jsx)(b.Z.Password,{name:"confirmPassword",label:"确认密码",rules:[{required:!0,message:"请确认密码"},function(e){var r=e.getFieldValue;return{validator:function(e,n){return n&&r("newPassword")!==n?Promise.reject(new Error("两次输入密码不一致")):Promise.resolve()}}}]})]})})},_={labelCol:{span:6},wrapperCol:{span:18}},ee=f.Z.Title,re=f.Z.Text,ne=function(){var e=(0,k.useIntl)(),r=(0,$.Z)().isDarkMode,n=j.A.useForm(),t=u()(n,1)[0],s=(0,T.Z)().translateString,i=(0,F.L)((function(e){return{userInfo:e.userInfo,setUserInfo:e.setUserInfo}})),l=i.userInfo,f=i.setUserInfo,V=(0,d.useState)(""),B=u()(V,2),N=B[0],K=B[1],L=(0,d.useState)(!1),G=u()(L,2),W=G[0],H=G[1],J=(0,d.useState)(!1),Q=u()(J,2),ne=Q[0],te=Q[1],ae=(0,d.useState)(!1),se=u()(ae,2),oe=se[0],ie=se[1],ce=function(){var r=c()(o()().mark((function r(n,a){var i,c;return o()().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,(0,A.ck)(n);case 3:if(i=r.sent,console.log("updateProfile response:",i),200!==i.code){r.next=12;break}return c=a||e.formatMessage({id:"update.success"}),E.yw.success(c),i.data.username!==l.username?(0,q.NZ)():(f(i.data),t.setFieldsValue({uid:i.data.uid,username:i.data.username,nickname:s(i.data.nickname),email:i.data.email,mobile:i.data.mobile,description:s(i.data.description)})),r.abrupt("return",!0);case 12:return E.yw.error(i.message),r.abrupt("return",!1);case 14:r.next=21;break;case 16:return r.prev=16,r.t0=r.catch(0),console.error("Update profile error:",r.t0),E.yw.error(e.formatMessage({id:"update.failed",defaultMessage:"更新失败"})),r.abrupt("return",!1);case 21:case"end":return r.stop()}}),r,null,[[0,16]])})));return function(e,n){return r.apply(this,arguments)}}(),le=function(){var r=c()(o()().mark((function r(n){var t;return o()().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return console.log("handleUploadSuccess:",n),K(n),t=a()(a()({},l),{},{avatar:n}),r.next=5,ce(t,e.formatMessage({id:"avatar.upload.success",defaultMessage:"头像上传成功"}));case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),ue=function(){var e=c()(o()().mark((function e(r){var n;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a()(a()(a()({},l),r),{},{avatar:N}),console.log("Form submit userObject:",n),e.next=4,ce(n);case 4:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();(0,d.useEffect)((function(){l&&K(l.avatar)}),[l]);var de=function(){var e=c()(o()().mark((function e(){var r;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,A.Ai)();case 2:r=e.sent,console.log("handleRefreshProfile getProfile response:",r),200===r.code?(f(r.data),t.setFieldsValue({uid:r.data.uid,username:r.data.username,nickname:s(r.data.nickname),email:r.data.email,mobile:r.data.mobile,description:s(r.data.description)})):E.yw.error(r.message);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,d.useEffect)((function(){de()}),[]),(0,D.jsxs)("div",{style:{padding:"24px",backgroundColor:r?"#1f1f1f":"#f0f2f5",minHeight:"100vh"},children:[(0,D.jsxs)(p.Z,{variant:"borderless",style:{maxWidth:800,margin:"0 auto",borderRadius:"12px",boxShadow:r?"0 2px 8px rgba(255, 255, 255, 0.05)":"0 2px 8px rgba(0, 0, 0, 0.1)"},children:[(0,D.jsxs)(ee,{level:2,style:{marginBottom:"24px",textAlign:"center"},children:[(0,D.jsx)(M.Z,{style:{marginRight:"8px",color:"#1890ff"}}),e.formatMessage({id:"profile.title",defaultMessage:"个人资料"})]}),(0,D.jsx)(p.Z,{size:"small",style:{marginBottom:"24px",backgroundColor:r?"#2d2d2d":"#fafafa",borderRadius:"8px"},children:(0,D.jsx)(g.Z,{justify:"center",align:"middle",style:{padding:"20px 0"},children:(0,D.jsx)(h.Z,{children:(0,D.jsxs)(m.Z,{direction:"vertical",align:"center",size:"large",children:[(0,D.jsx)(x.Z,{src:N,size:100,style:{border:"4px solid #fff",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)"}}),(0,D.jsx)(R.G,{onSuccess:le,onError:function(e){console.log("handleUploadError:",e)},children:(0,D.jsx)(v.ZP,{type:"primary",icon:(0,D.jsx)(C.Z,{}),style:{borderRadius:"20px"},children:e.formatMessage({id:"pages.robot.upload",defaultMessage:"上传头像"})})},"avatar")]})})})}),(0,D.jsxs)(j.A,a()(a()({},_),{},{form:t,onFinish:ue,submitter:{render:function(e,r){return(0,D.jsx)(g.Z,{justify:"center",style:{marginTop:"32px"},children:(0,D.jsx)(h.Z,{children:(0,D.jsx)(m.Z,{size:"middle",children:r})})})},submitButtonProps:{size:"large",style:{borderRadius:"8px",minWidth:"120px"}},resetButtonProps:{size:"large",style:{borderRadius:"8px",minWidth:"120px"}}},children:[(0,D.jsxs)(p.Z,{title:(0,D.jsxs)(re,{strong:!0,style:{fontSize:"16px"},children:[(0,D.jsx)(M.Z,{style:{marginRight:"8px",color:"#1890ff"}}),"基本信息"]}),size:"small",style:{marginBottom:"24px",backgroundColor:r?"#262626":void 0},children:[(0,D.jsx)(b.Z,{name:"uid",label:"用户ID",rules:[{required:!0}],readonly:!0,fieldProps:{style:{backgroundColor:r?"#2a2a2a":"#f5f5f5"}}}),(0,D.jsx)(b.Z,{name:"username",label:e.formatMessage({id:"username.change.tip",defaultMessage:"用户名"}),rules:[{required:!0}],fieldProps:{prefix:(0,D.jsx)(M.Z,{style:{color:"#1890ff"}})}}),(0,D.jsx)(b.Z,{name:"nickname",label:e.formatMessage({id:"nickname",defaultMessage:"昵称"}),rules:[{required:!0}],fieldProps:{prefix:(0,D.jsx)(M.Z,{style:{color:"#52c41a"}})}}),(0,D.jsx)(Z.Z,{name:"description",label:e.formatMessage({id:"description",defaultMessage:"个人简介"}),fieldProps:{rows:4,placeholder:"请输入个人简介..."}})]}),(0,D.jsx)(p.Z,{title:(0,D.jsxs)(re,{strong:!0,style:{fontSize:"16px"},children:[(0,D.jsx)(P.Z,{style:{marginRight:"8px",color:"#fa541c"}}),"安全设置"]}),size:"small",style:{marginBottom:"24px",backgroundColor:r?"#262626":void 0},children:(0,D.jsx)(g.Z,{gutter:[16,16],children:(0,D.jsx)(h.Z,{span:24,children:(0,D.jsxs)(m.Z,{direction:"vertical",style:{width:"100%"},children:[(0,D.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0"},children:[(0,D.jsxs)(m.Z,{children:[(0,D.jsx)(P.Z,{style:{color:"#fa541c"}}),(0,D.jsx)(re,{children:"登录密码"})]}),(0,D.jsx)(v.ZP,{type:"link",onClick:function(){H(!0)},style:{fontWeight:"bold"},children:e.formatMessage({id:"pages.settings.reset.password",defaultMessage:"修改密码"})})]}),(0,D.jsx)(y.Z,{style:{margin:"8px 0"}})]})})})}),(0,D.jsx)(p.Z,{title:(0,D.jsxs)(re,{strong:!0,style:{fontSize:"16px"},children:[(0,D.jsx)(S.Z,{style:{marginRight:"8px",color:"#722ed1"}}),"联系方式"]}),size:"small",children:(0,D.jsx)(g.Z,{gutter:[16,16],children:(0,D.jsxs)(h.Z,{span:24,children:[(0,D.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0"},children:[(0,D.jsxs)(m.Z,{children:[(0,D.jsx)(S.Z,{style:{color:"#722ed1"}}),(0,D.jsx)(re,{children:"邮箱地址"}),null!=l&&l.emailVerified?(0,D.jsx)(w.Z,{icon:(0,D.jsx)(U.Z,{}),color:"success",children:"已验证"}):(0,D.jsx)(w.Z,{icon:(0,D.jsx)(I.Z,{}),color:"error",children:"未验证"})]}),(0,D.jsxs)(m.Z,{children:[(0,D.jsx)(re,{type:"secondary",children:(null==l?void 0:l.email)||"未设置"}),(0,D.jsx)(v.ZP,{type:"link",onClick:function(){te(!0)},style:{fontWeight:"bold"},children:e.formatMessage({id:"pages.settings.reset.email",defaultMessage:"修改邮箱"})})]})]}),(0,D.jsx)(y.Z,{style:{margin:"8px 0"}}),(0,D.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0"},children:[(0,D.jsxs)(m.Z,{children:[(0,D.jsx)(z.Z,{style:{color:"#13c2c2"}}),(0,D.jsx)(re,{children:"手机号码"}),null!=l&&l.mobileVerified?(0,D.jsx)(w.Z,{icon:(0,D.jsx)(U.Z,{}),color:"success",children:"已验证"}):(0,D.jsx)(w.Z,{icon:(0,D.jsx)(I.Z,{}),color:"error",children:"未验证"})]}),(0,D.jsxs)(m.Z,{children:[(0,D.jsx)(re,{type:"secondary",children:(null==l?void 0:l.mobile)||"未设置"}),(0,D.jsx)(v.ZP,{type:"link",onClick:function(){ie(!0)},style:{fontWeight:"bold"},children:e.formatMessage({id:"pages.settings.reset.mobile",defaultMessage:"修改手机号"})})]})]})]})})})]}))]}),W&&(0,D.jsx)(X,{open:W,onClose:function(){H(!1)}}),ne&&(0,D.jsx)(O,{open:ne,onSubmit:function(e){te(!1),l.email=e,f(l),t.setFieldValue("email",e)},onClose:function(){te(!1)}}),oe&&(0,D.jsx)(Y,{open:oe,onSubmit:function(e){ie(!1),l.mobile=e,f(l),t.setFieldValue("mobile",e)},onClose:function(){ie(!1)}})]})}},21153:function(e,r,n){n.d(r,{$g:function(){return l},N9:function(){return i},Qc:function(){return c},vC:function(){return o}});var t=n(46803),a=n.n(t);function s(e){return"bytedesk_salt"!==e&&e?a().SHA256(e).toString().substring(0,16):"bytedesk_license"}function o(e,r){if(!e)throw new Error("密码不能为空");if(!r)throw new Error("盐值不能为空");try{var n=s(r);console.log("前端加密参数:",{password:"***",salt:r,generatedKey:n});var t=a().enc.Utf8.parse(n),o=a().AES.encrypt(e,t,{mode:a().mode.ECB,padding:a().pad.Pkcs7}).toString();return console.log("前端加密结果长度:",o.length),o}catch(e){throw console.error("密码加密失败:",e),new Error("密码加密失败: "+e.message)}}function i(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="",t=0;t<e;t++)n+=r.charAt(Math.floor(Math.random()*r.length));return n}function c(e){var r=0;return e?(e.length>=8&&(r+=20),e.length>=12&&(r+=10),/\d/.test(e)&&(r+=20),/[a-z]/.test(e)&&(r+=20),/[A-Z]/.test(e)&&(r+=20),/[!@#$%^&*(),.?":{}|<>]/.test(e)&&(r+=10),Math.min(r,100)):0}function l(e){return e>=80?"强":e>=60?"中":e>=40?"弱":"很弱"}}}]);