"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[731],{60731:function(e,a,t){t.d(a,{uploadScreenshot:function(){return n}});var i=t(41365);async function n(e,a){var t;const n=`screenshot_${(new Date).toISOString().replace(/[-:T.]/g,"").slice(0,14)}.jpg`;return(null==(t=(await async function(e,a,t,n){try{const o=(new Date).toISOString().replace(/[-:T.]/g,"").slice(0,14),l=a||`${o}_${e.name}`,r=t||e.type||"image/jpeg",d=new FormData;d.append("file",e),d.append("fileName",l),d.append("fileType",r),d.append("isAvatar",(null==n?void 0:n.isAvatar)||"false"),d.append("kbType",(null==n?void 0:n.kbType)||"feedback");const s=(null==n?void 0:n.visitorUid)||localStorage.getItem("bytedesk_uid")||localStorage.getItem("bytedesk_visitor_uid")||"",p=(null==n?void 0:n.visitorNickname)||localStorage.getItem("bytedesk_nickname")||"",c=(null==n?void 0:n.visitorAvatar)||localStorage.getItem("bytedesk_avatar")||"",u=(null==n?void 0:n.orgUid)||"";d.append("visitorUid",s),d.append("visitorNickname",p),d.append("visitorAvatar",c),d.append("orgUid",u),d.append("client",(null==n?void 0:n.client)||"web"),null!=n&&n.isDebug&&console.log("handleUpload formData",d);const g=`${(0,i.k)()}/visitor/api/upload/file`,v=await fetch(g,{method:"POST",headers:{},body:d});if(!v.ok)throw new Error(`上传失败: ${v.status} ${v.statusText}`);const k=await v.json();return null!=n&&n.isDebug&&console.log("upload data:",k),k}catch(e){throw console.error("文件上传失败:",e),e}}(e,n,"image/jpeg",{...a,kbType:"feedback"})).data)?void 0:t.fileUrl)||""}}}]);