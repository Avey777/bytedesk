"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[7072],{83381:function(e,t,r){r.d(t,{Z:function(){return l}});var a=r(77260),s=r(44194),n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},i=r(5901),o=function(e,t){return s.createElement(i.Z,(0,a.Z)({},e,{ref:t,icon:n}))};var l=s.forwardRef(o)},17115:function(e,t,r){r.d(t,{Z:function(){return w}});var a=r(39328),s=r(17323),n=r(44194),i=r(17881),o=r(63383),l=r(31549),d=["proFieldProps","fieldProps"],u="date",c=n.forwardRef((function(e,t){var r=e.proFieldProps,c=e.fieldProps,p=(0,s.Z)(e,d),f=(0,n.useContext)(i.Z);return(0,l.jsx)(o.Z,(0,a.Z)({ref:t,valueType:u,fieldProps:(0,a.Z)({getPopupContainer:f.getPopupContainer},c),proFieldProps:r,filedConfig:{valueType:u,customLightMode:!0}},p))})),p=["proFieldProps","fieldProps"],f="dateMonth",m=n.forwardRef((function(e,t){var r=e.proFieldProps,d=e.fieldProps,u=(0,s.Z)(e,p),c=(0,n.useContext)(i.Z);return(0,l.jsx)(o.Z,(0,a.Z)({ref:t,valueType:f,fieldProps:(0,a.Z)({getPopupContainer:c.getPopupContainer},d),proFieldProps:r,filedConfig:{valueType:f,customLightMode:!0}},u))})),g=["fieldProps"],h="dateQuarter",v=n.forwardRef((function(e,t){var r=e.fieldProps,d=(0,s.Z)(e,g),u=(0,n.useContext)(i.Z);return(0,l.jsx)(o.Z,(0,a.Z)({ref:t,valueType:h,fieldProps:(0,a.Z)({getPopupContainer:u.getPopupContainer},r),filedConfig:{valueType:h,customLightMode:!0}},d))})),x=["proFieldProps","fieldProps"],M="dateWeek",y=n.forwardRef((function(e,t){var r=e.proFieldProps,d=e.fieldProps,u=(0,s.Z)(e,x),c=(0,n.useContext)(i.Z);return(0,l.jsx)(o.Z,(0,a.Z)({ref:t,valueType:M,fieldProps:(0,a.Z)({getPopupContainer:c.getPopupContainer},d),proFieldProps:r,filedConfig:{valueType:M,customLightMode:!0}},u))})),P=["proFieldProps","fieldProps"],Z="dateYear",C=n.forwardRef((function(e,t){var r=e.proFieldProps,d=e.fieldProps,u=(0,s.Z)(e,P),c=(0,n.useContext)(i.Z);return(0,l.jsx)(o.Z,(0,a.Z)({ref:t,valueType:Z,fieldProps:(0,a.Z)({getPopupContainer:c.getPopupContainer},d),proFieldProps:r,filedConfig:{valueType:Z,customLightMode:!0}},u))})),b=c;b.Week=y,b.Month=m,b.Quarter=v,b.Year=C,b.displayName="ProFormComponent";var w=b},31051:function(e,t,r){var a=r(39328),s=r(17323),n=r(90098),i=r(44194),o=r(17881),l=r(63383),d=r(31549),u=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],c=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],p=function(e,t){var r=e.fieldProps,c=e.children,p=e.params,f=e.proFieldProps,m=e.mode,g=e.valueEnum,h=e.request,v=e.showSearch,x=e.options,M=(0,s.Z)(e,u),y=(0,i.useContext)(o.Z);return(0,d.jsx)(l.Z,(0,a.Z)((0,a.Z)({valueEnum:(0,n.h)(g),request:h,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,a.Z)({options:x,mode:m,showSearch:v,getPopupContainer:y.getPopupContainer},r),ref:t,proFieldProps:f},M),{},{children:c}))},f=i.forwardRef((function(e,t){var r=e.fieldProps,u=e.children,p=e.params,f=e.proFieldProps,m=e.mode,g=e.valueEnum,h=e.request,v=e.options,x=(0,s.Z)(e,c),M=(0,a.Z)({options:v,mode:m||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},r),y=(0,i.useContext)(o.Z);return(0,d.jsx)(l.Z,(0,a.Z)((0,a.Z)({valueEnum:(0,n.h)(g),request:h,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,a.Z)({getPopupContainer:y.getPopupContainer},M),ref:t,proFieldProps:f},x),{},{children:u}))})),m=i.forwardRef(p);m.SearchSelect=f,m.displayName="ProFormComponent",t.Z=m},3e3:function(e,t,r){var a=r(39328),s=r(17323),n=r(44194),i=r(63383),o=r(31549),l=["fieldProps","unCheckedChildren","checkedChildren","proFieldProps"],d=n.forwardRef((function(e,t){var r=e.fieldProps,n=e.unCheckedChildren,d=e.checkedChildren,u=e.proFieldProps,c=(0,s.Z)(e,l);return(0,o.jsx)(i.Z,(0,a.Z)({valueType:"switch",fieldProps:(0,a.Z)({unCheckedChildren:n,checkedChildren:d},r),ref:t,valuePropName:"checked",proFieldProps:u,filedConfig:{valuePropName:"checked",ignoreWidth:!0,customLightMode:!0}},c))}));t.Z=d},22766:function(e,t,r){var a=r(76285),s=r(39328),n=r(17323),i=r(92032),o=r(34651),l=r(72583),d=r(21762),u=r(44194),c=r(63383),p=r(31549),f=["fieldProps","proFieldProps"],m=["fieldProps","proFieldProps"],g="text",h=function(e){var t=(0,i.Z)(e.open||!1,{value:e.open,onChange:e.onOpenChange}),r=(0,a.Z)(t,2),n=r[0],d=r[1];return(0,p.jsx)(o.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(t){var r,a=t.getFieldValue(e.name||[]);return(0,p.jsx)(l.Z,(0,s.Z)((0,s.Z)({getPopupContainer:function(e){return e&&e.parentNode?e.parentNode:e},onOpenChange:function(e){return d(e)},content:(0,p.jsxs)("div",{style:{padding:"4px 0"},children:[null===(r=e.statusRender)||void 0===r?void 0:r.call(e,a),e.strengthText?(0,p.jsx)("div",{style:{marginTop:10},children:(0,p.jsx)("span",{children:e.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},e.popoverProps),{},{open:n,children:e.children}))}})},v=function(e){var t=e.fieldProps,r=e.proFieldProps,a=(0,n.Z)(e,f);return(0,p.jsx)(c.Z,(0,s.Z)({valueType:g,fieldProps:t,filedConfig:{valueType:g},proFieldProps:r},a))};v.Password=function(e){var t=e.fieldProps,r=e.proFieldProps,i=(0,n.Z)(e,m),o=(0,u.useState)(!1),l=(0,a.Z)(o,2),f=l[0],v=l[1];return null!=t&&t.statusRender&&i.name?(0,p.jsx)(h,{name:i.name,statusRender:null==t?void 0:t.statusRender,popoverProps:null==t?void 0:t.popoverProps,strengthText:null==t?void 0:t.strengthText,open:f,onOpenChange:v,children:(0,p.jsx)("div",{children:(0,p.jsx)(c.Z,(0,s.Z)({valueType:"password",fieldProps:(0,s.Z)((0,s.Z)({},(0,d.Z)(t,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(e){var r;null==t||null===(r=t.onBlur)||void 0===r||r.call(t,e),v(!1)},onClick:function(e){var r;null==t||null===(r=t.onClick)||void 0===r||r.call(t,e),v(!0)}}),proFieldProps:r,filedConfig:{valueType:g}},i))})}):(0,p.jsx)(c.Z,(0,s.Z)({valueType:"password",fieldProps:t,proFieldProps:r,filedConfig:{valueType:g}},i))},v.displayName="ProFormComponent",t.Z=v},12581:function(e,t,r){var a=r(39328),s=r(17323),n=r(44194),i=r(63383),o=r(31549),l=["fieldProps","proFieldProps"],d=function(e,t){var r=e.fieldProps,n=e.proFieldProps,d=(0,s.Z)(e,l);return(0,o.jsx)(i.Z,(0,a.Z)({ref:t,valueType:"textarea",fieldProps:r,proFieldProps:n},d))};t.Z=n.forwardRef(d)},30234:function(e,t,r){var a=r(25191),s=r(32057),n=r(75699);t.Z=function(){var e=(0,n.useIntl)();return{translateString:function(t){return null==t?t:t&&(null!=t&&t.startsWith(a.VoP)||null!=t&&t.startsWith("ROLE_"))?e.formatMessage({id:t,defaultMessage:t}):t},translateStringTranct:function(t){return null==t?t:null!=t&&t.startsWith(a.VoP)||null!=t&&t.startsWith("ROLE_")?(0,s.aS)(e.formatMessage({id:t,defaultMessage:t}),10):(0,s.aS)(t,10)}}}},67072:function(e,t,r){r.d(t,{Z:function(){return G}});var a=r(73193),s=r.n(a),n=r(84176),i=r.n(n),o=r(86222),l=r.n(o),d=r(90819),u=r.n(d),c=r(89933),p=r.n(c),f=r(76711),m=r.n(f),g=r(45332),h=r.n(g),v=r(31756),x=r(25191),M=r(75699);function y(e){return P.apply(this,arguments)}function P(){return(P=p()(u()().mark((function e(t){return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,M.request)("/api/v1/license/query/org",{method:"GET",params:s()(s()({},t),{},{channel:x.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e){return C.apply(this,arguments)}function C(){return(C=p()(u()().mark((function e(t){return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,M.request)("/api/v1/license/create",{method:"POST",data:s()(s()({},t),{},{channel:x.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return w.apply(this,arguments)}function w(){return(w=p()(u()().mark((function e(t){return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,M.request)("/api/v1/license/update",{method:"POST",data:s()(s()({},t),{},{channel:x.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){return F.apply(this,arguments)}function F(){return(F=p()(u()().mark((function e(t){return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,M.request)("/api/v1/license/delete",{method:"POST",data:s()(s()({},t),{},{channel:x.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var S=r(31881),T=r(83381),E=r(6992),I=r(79148),k=r(35129),D=r(44532),L=r(77407),R=r(44194),A=r(6373),q=r(22766),B=r(12581),O=r(31051),Y=r(17115),z=r(3e3),N=r(8957),K=r(24418),U=r(43413),V=r(76790),W=r(28977),_=r.n(W),J=r(31549),X=function(e){var t=e.isEdit,r=e.license,a=e.open,n=e.isSuperUser,i=e.onClose,o=e.onSubmit,d=(0,M.useIntl)(),u=A.A.useForm(),c=h()(u,1)[0],p=(0,V.L)((function(e){return e.userInfo})),f=(0,S.u)((function(e){return e.currentOrg})),m=(0,R.useState)(""),g=h()(m,2);g[0],g[1];return(0,R.useEffect)((function(){if(t)c.setFieldsValue({uid:null==r?void 0:r.uid,name:null==r?void 0:r.name,description:null==r?void 0:r.description,mobile:null==r?void 0:r.mobile,email:null==r?void 0:r.email,userType:null==r?void 0:r.userType,expiryDate:null==r?void 0:r.expiryDate,edition:null==r?void 0:r.edition,serverIps:null==r?void 0:r.serverIps,serverDomains:null==r?void 0:r.serverDomains,enabled:null==r?void 0:r.enabled,activatedAt:null==r?void 0:r.activatedAt,lastCheckedAt:null==r?void 0:r.lastCheckedAt});else{var e=_()().add(30,"day").format("YYYY-MM-DD HH:mm:ss");c.setFieldsValue({mobile:null==p?void 0:p.mobile,email:null==p?void 0:p.email,userType:x.Bv_,edition:x.dbF,expiryDate:e})}}),[t,r,c,p]),(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(K.Z,{title:d.formatMessage({id:"license.title",defaultMessage:"License"}),width:600,onClose:i,open:a,extra:(0,J.jsxs)(U.Z,{children:[(0,J.jsx)(L.ZP,{onClick:i,children:d.formatMessage({id:"cancel",defaultMessage:"Cancel"})}),(0,J.jsx)(L.ZP,{type:"primary",onClick:function(){return c.submit()},children:d.formatMessage({id:"submit",defaultMessage:"Submit"})})]}),children:(0,J.jsxs)(A.A,{form:c,name:"licenseForm",onFinish:function(){console.log("handleSubmit"),null!=p&&p.mobileVerified||null!=p&&p.emailVerified?c.validateFields().then((function(e){var t=s()({},e),r=s()(s()({},t),{},{orgUid:null==f?void 0:f.uid});console.log("submit",r),o(r)})):N.ZP.error(d.formatMessage({id:"license.verification.required",defaultMessage:"请先完成手机或邮箱验证后再创建License"}))},submitter:!1,children:[(0,J.jsx)(q.Z,{label:d.formatMessage({id:"name",defaultMessage:"Name"}),name:"name",rules:[{required:!0},{validator:function(e,t){return"string"==typeof t&&t.toLowerCase().includes("weiyu")?Promise.reject(new Error(d.formatMessage({id:"license.name.weiyu.forbidden",defaultMessage:"名称不能包含 weiyu"}))):Promise.resolve()}}]}),(0,J.jsx)(B.Z,{label:d.formatMessage({id:"description",defaultMessage:"Description"}),name:"description",placeholder:d.formatMessage({id:"license.description.placeholder",defaultMessage:"Optional, license usage description"})}),(0,J.jsx)(q.Z,{label:d.formatMessage({id:"mobile",defaultMessage:"Mobile"}),name:"mobile",disabled:!0}),(0,J.jsx)(q.Z,{label:d.formatMessage({id:"email",defaultMessage:"Email"}),name:"email",disabled:!0}),(0,J.jsx)(O.Z,{label:d.formatMessage({id:"userType",defaultMessage:"User Type"}),name:"userType",options:[{label:d.formatMessage({id:"license.user.type.free",defaultMessage:"Free"}),value:x.Bv_},{label:d.formatMessage({id:"license.user.type.paid",defaultMessage:"Paid"}),value:x.u0z,disabled:!n}],extra:(0,J.jsx)("a",{href:"https://www.weiyuai.cn/docs/zh-CN/docs/payment#%E8%81%94%E7%B3%BB%E6%96%B9%E5%BC%8F",target:"_blank",rel:"noopener noreferrer",style:{color:"#1677ff"},children:d.formatMessage({id:"license.userType.paid.tip",defaultMessage:"购买付费版请访问微语官网-版本与价格"})})}),(0,J.jsx)(Y.Z,{label:d.formatMessage({id:"expiryDate",defaultMessage:"Expiry Date"}),name:"expiryDate",fieldProps:{format:"YYYY-MM-DD"},rules:[{required:!0,message:d.formatMessage({id:"license.expiryDate.required",defaultMessage:"Please select expiry date"})}],disabled:!0}),(0,J.jsx)(O.Z,{label:d.formatMessage({id:"edition",defaultMessage:"Edition"}),name:"edition",options:[{label:d.formatMessage({id:"license.edition.community",defaultMessage:"Community Edition"}),value:x.dbF},{label:d.formatMessage({id:"license.edition.enterprise",defaultMessage:"Enterprise Edition"}),value:x.hj_},{label:d.formatMessage({id:"license.edition.platform",defaultMessage:"Platform Edition"}),value:x.tmZ}]}),(0,J.jsx)(q.Z,{label:d.formatMessage({id:"serverIps",defaultMessage:"Authorized IPs"}),name:"serverIps",placeholder:d.formatMessage({id:"license.comma.separated",defaultMessage:"Comma separated"}),extra:d.formatMessage({id:"license.serverIps.format",defaultMessage:"Format: 192.168.1.1, 10.0.0.1, 2001:db8::1"}),rules:[{validator:function(e,t){if(!t)return Promise.resolve();var r,a=t.split(",").map((function(e){return e.trim()})).filter(Boolean),s=/^(25[0-5]|2[0-4]\d|1\d{2}|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d{2}|[1-9]?\d)){3}$/,n=/^([\da-fA-F]{1,4}:){7}[\da-fA-F]{1,4}$/,i=l()(a);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(!s.test(o)&&!n.test(o))return Promise.reject(new Error(d.formatMessage({id:"license.serverIps.error",defaultMessage:"Please enter valid IP addresses, separated by commas"})))}}catch(e){i.e(e)}finally{i.f()}return Promise.resolve()}}]}),(0,J.jsx)(q.Z,{label:d.formatMessage({id:"serverDomains",defaultMessage:"Authorized Domains"}),name:"serverDomains",placeholder:d.formatMessage({id:"license.comma.separated",defaultMessage:"Comma separated"}),extra:d.formatMessage({id:"license.serverDomains.format",defaultMessage:"Format: example.com, sub.example.com:8080, *.example.com"}),rules:[{validator:function(e,t){if(!t)return Promise.resolve();var r,a=t.split(",").map((function(e){return e.trim()})).filter(Boolean),s=l()(a);try{for(s.s();!(r=s.n()).done;){var n=r.value;if(!/^([A-Za-z0-9-]{1,63}\.)+[A-Za-z]{2,}(:\d{1,5})?$/.test(n))return Promise.reject(new Error(d.formatMessage({id:"license.serverDomains.error",defaultMessage:"Please enter valid domains, separated by commas"})))}}catch(e){s.e(e)}finally{s.f()}return Promise.resolve()}}]}),(0,J.jsx)(z.Z,{label:d.formatMessage({id:"enabled",defaultMessage:"Enabled"}),name:"enabled",fieldProps:{checkedChildren:d.formatMessage({id:"license.enabled",defaultMessage:"Enabled"}),unCheckedChildren:d.formatMessage({id:"license.disabled",defaultMessage:"Disabled"})}})]})})})},H=r(30234),Q=r(223),$=["current","pageSize"],G=function(e){var t=e.isSuperUser,r=(0,M.useIntl)(),a=(0,R.useRef)(),n=(0,H.Z)().translateString,o=(0,R.useState)(1),l=h()(o,2),d=(l[0],l[1]),c=(0,R.useState)(10),f=h()(c,2),g=(f[0],f[1]),x=(0,S.u)((function(e){return e.currentOrg})),P=(0,R.useState)(!1),C=h()(P,2),w=C[0],F=C[1],A=(0,R.useState)({}),q=h()(A,2),B=q[0],O=q[1],Y=(0,R.useState)(!1),z=h()(Y,2),N=z[0],K=z[1],U=k.Z.useModal(),V=h()(U,2),W=V[0],G=V[1],ee=(0,R.useState)([]),te=h()(ee,2),re=te[0],ae=te[1],se=(0,R.useState)([]),ne=h()(se,2),ie=(ne[0],ne[1]),oe=(0,R.useState)(0),le=h()(oe,2),de=(le[0],le[1]),ue=(0,R.useState)({}),ce=h()(ue,2),pe=(ce[0],ce[1]),fe=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:(0,J.jsx)(M.FormattedMessage,{id:"name",defaultMessage:"Name"}),dataIndex:"name",copyable:!0,fixed:"left",width:150},{title:(0,J.jsx)(M.FormattedMessage,{id:"description",defaultMessage:"Description"}),dataIndex:"description",width:150,ellipsis:!0},{title:(0,J.jsx)(M.FormattedMessage,{id:"mobile",defaultMessage:"Mobile"}),dataIndex:"mobile",width:120},{title:(0,J.jsx)(M.FormattedMessage,{id:"email",defaultMessage:"Email"}),dataIndex:"email",width:180},{title:(0,J.jsx)(M.FormattedMessage,{id:"userType",defaultMessage:"User Type"}),dataIndex:"userType",hideInSearch:!0,width:120,valueEnum:{FREE:{text:(0,J.jsx)(M.FormattedMessage,{id:"license.user.type.free",defaultMessage:"Free"})},PAID:{text:(0,J.jsx)(M.FormattedMessage,{id:"license.user.type.paid",defaultMessage:"Paid"})}}},{title:(0,J.jsx)(M.FormattedMessage,{id:"expiryDate",defaultMessage:"Expiry Date"}),dataIndex:"expiryDate",hideInSearch:!0,width:120,render:function(e){return e?_()(e).format("YYYY-MM-DD"):""}},{title:(0,J.jsx)(M.FormattedMessage,{id:"edition",defaultMessage:"Edition"}),dataIndex:"edition",hideInSearch:!0,width:120,valueEnum:{COMMUNITY:{text:(0,J.jsx)(M.FormattedMessage,{id:"license.edition.community",defaultMessage:"Community Edition"})},ENTERPRISE:{text:(0,J.jsx)(M.FormattedMessage,{id:"license.edition.enterprise",defaultMessage:"Enterprise Edition"})},PLATFORM:{text:(0,J.jsx)(M.FormattedMessage,{id:"license.edition.platform",defaultMessage:"Platform Edition"})}}},{title:(0,J.jsx)(M.FormattedMessage,{id:"serverIps",defaultMessage:"Server IPs"}),dataIndex:"serverIps",hideInSearch:!0,width:180,ellipsis:!0},{title:(0,J.jsx)(M.FormattedMessage,{id:"serverDomains",defaultMessage:"Server Domains"}),dataIndex:"serverDomains",hideInSearch:!0,width:180,ellipsis:!0},{title:(0,J.jsx)(M.FormattedMessage,{id:"licenseKey",defaultMessage:"License Key"}),dataIndex:"licenseKey",width:200,copyable:!0,ellipsis:!0}].concat(m()(t?[{title:(0,J.jsx)(M.FormattedMessage,{id:"encryptedLicenseKey",defaultMessage:"Encrypted License Key"}),dataIndex:"encryptedLicenseKey",width:200,copyable:!0,ellipsis:!0}]:[]),[{title:(0,J.jsx)(M.FormattedMessage,{id:"enabled",defaultMessage:"Enabled"}),dataIndex:"enabled",hideInSearch:!0,width:100,valueType:"select",valueEnum:{true:{text:"启用",status:"Success"},false:{text:"禁用",status:"Error"}}},{title:(0,J.jsx)(M.FormattedMessage,{id:"createdAt",defaultMessage:"Created At"}),dataIndex:"createdAt",hideInSearch:!0,width:180,valueType:"dateTime"},{title:(0,J.jsx)(M.FormattedMessage,{id:"updatedAt",defaultMessage:"Updated At"}),dataIndex:"updatedAt",hideInSearch:!0,width:180,valueType:"dateTime"}]),me=[].concat(m()(fe),[{title:r.formatMessage({id:"actions",defaultMessage:"Actions"}),valueType:"option",key:"option",fixed:"right",width:220,render:function(e,t,a,s){return[(0,J.jsx)("a",{onClick:function(){O(t),K(!0),F(!0)},children:r.formatMessage({id:"edit",defaultMessage:"Edit"})},"editable"),(0,J.jsx)(D.Z,{title:r.formatMessage({id:"deleteTip"}),description:"".concat(r.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(n(t.name),"】？"),onConfirm:function(){return ge(t)},okText:r.formatMessage({id:"ok"}),cancelText:r.formatMessage({id:"cancel"}),icon:(0,J.jsx)(T.Z,{style:{color:"red"}}),children:(0,J.jsx)(L.ZP,{type:"link",danger:!0,children:r.formatMessage({id:"delete",defaultMessage:"Delete"})})},"delete"),(0,J.jsx)(L.ZP,{type:"link",onClick:function(){return Me(t.encryptedLicenseKey)},children:"测试"},"test-decrypt")]}}]),ge=function(){var e=p()(u()().mark((function e(t){var s;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("deleteLicense:",t),e.next=3,j(t);case 3:s=e.sent,console.log("deleteLicense:",s),200===s.code?(v.yw.success(r.formatMessage({id:"delete.success",defaultMessage:"Delete success"})),a.current.reload()):v.yw.error(s.message);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),he=function(){var e=p()(u()().mark((function e(t){var r,s;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z(t);case 2:r=e.sent,console.log("handleCreateLicense response:",r),200===r.code?(null===(s=a.current)||void 0===s||s.reload(),F(!1)):v.yw.error(r.message);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ve=function(){var e=p()(u()().mark((function e(t){var r,s;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.uid=null==B?void 0:B.uid,e.next=3,b(t);case 3:r=e.sent,console.log("handleUpdateLicense response:",r),200===r.code?(null===(s=a.current)||void 0===s||s.reload(),F(!1)):v.yw.error(r.message);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),xe=function(){F(!0),K(!1),O({})},Me=function(e){try{var t=(0,Q.K_)(e);W.info({title:"解密结果",content:(0,J.jsx)("div",{style:{wordBreak:"break-all"},children:(0,J.jsx)("pre",{children:JSON.stringify(t,null,2)})}),width:600})}catch(e){W.error({title:"解密失败",content:String(e)})}},ye={selectedRowKeys:re,onChange:function(e,t){ae(e),ie(t)}},Pe=function(){var e=p()(u()().mark((function e(r,a,n){var o,l,c,p,f;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.current,l=r.pageSize,c=i()(r,$),d(o),g(l),pe(c),p=s()({pageNumber:o-1,pageSize:l,orgUid:null==x?void 0:x.uid,isSuperUser:t},c),e.next=7,y(p);case 7:return f=e.sent,console.log("queryLicensesByOrg response:",f,p),200===f.code?de(f.data.totalElements):v.yw.error(f.message),e.abrupt("return",{data:f.data.content,success:!0,total:f.data.totalElements});case 11:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}();return(0,J.jsxs)(J.Fragment,{children:[w&&(0,J.jsx)(X,{isEdit:N,open:w,license:B,isSuperUser:t,onClose:function(){F(!1)},onSubmit:function(e){console.log("onDrawerSubmit:",e),N?ve(e):he(e)}}),(0,J.jsx)(I.Z,{columns:me,actionRef:a,cardBordered:!0,rowSelection:ye,request:Pe,scroll:{x:1e3},rowKey:function(e){return e.uid||e.licenseKey||e.email||e.name},search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,onChange:function(e,t){d(e),g(t)}},dateFormatter:"string",headerTitle:"License列表",toolBarRender:function(){return[(0,J.jsx)(L.ZP,{type:"primary",icon:(0,J.jsx)(E.Z,{}),onClick:xe,children:r.formatMessage({id:"create",defaultMessage:"Create"})},"create")]}}),(0,J.jsx)("div",{style:{marginTop:16,padding:16,backgroundColor:"#f6f8fa",borderRadius:6,border:"1px solid #e1e4e8"},children:(0,J.jsxs)("div",{style:{fontSize:14,color:"#586069",lineHeight:1.6},children:[(0,J.jsx)("strong",{children:"重要说明："}),(0,J.jsx)("br",{}),"为防止客服系统被用于诈骗等非法行为，系统采用licenseKey机制进行授权管理。请妥善保管您的licenseKey，避免泄露或被盗用，确保系统安全使用。"]})}),G]})}}}]);