"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[6826],{16829:function(e,t,n){n.d(t,{Z:function(){return l}});var a=n(77260),r=n(44194),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"},s=n(5901),o=function(e,t){return r.createElement(s.Z,(0,a.Z)({},e,{ref:t,icon:i}))};var l=r.forwardRef(o)},33e3:function(e,t,n){n.d(t,{Z:function(){return l}});var a=n(77260),r=n(44194),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM504 618H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 490v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8z"}}]},name:"file-text",theme:"outlined"},s=n(5901),o=function(e,t){return r.createElement(s.Z,(0,a.Z)({},e,{ref:t,icon:i}))};var l=r.forwardRef(o)},35911:function(e,t,n){n.d(t,{Z:function(){return l}});var a=n(77260),r=n(44194),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"},s=n(5901),o=function(e,t){return r.createElement(s.Z,(0,a.Z)({},e,{ref:t,icon:i}))};var l=r.forwardRef(o)},1820:function(e,t,n){n.r(t);var a=n(90819),r=n.n(a),i=n(89933),s=n.n(i),o=n(45332),l=n.n(o),c=n(44194),u=n(41123),d=n(34251),f=n(43413),m=n(89176),p=n(71373),v=n(63065),g=n(10337),y=n(77407),h=n(5858),x=n(9248),k=n(14318),b=n(68525),j=n(35911),w=n(57039),M=n(33e3),Z=n(14546),S=n(75699),O=n(61628),R=n(31756),E=n(31881),T=n(76001),Y=n(7999),z=n(30234),C=n(25191),D=n(28977),$=n.n(D),F=n(89295),N=n(54693),H=n(16829),I=n(31549),P=u.default.RangePicker,B=d.Z.Option;t.default=function(){var e,t,n,a,i=(0,S.useIntl)(),o=(0,z.Z)().translateStringTranct,u=(0,c.useState)($()().startOf("day")),D=l()(u,2),L=D[0],A=D[1],U=(0,c.useState)($()().endOf("day")),W=l()(U,2),X=W[0],V=W[1],Q=(0,c.useState)("today"),q=l()(Q,2),G=q[0],_=q[1],J=(0,c.useState)(C.whQ),K=l()(J,2),ee=K[0],te=K[1],ne=(0,c.useState)(),ae=l()(ne,2),re=ae[0],ie=ae[1],se=(0,c.useState)(),oe=l()(se,2),le=oe[0],ce=oe[1],ue=(0,E.u)((function(e){return e.currentOrg})),de=(0,T.E)((function(e){return e})),fe=de.agentResult,me=de.setAgentResult,pe=(0,N.H)((function(e){return e})),ve=pe.departmentResult,ge=pe.setDepartmentResult,ye=(0,c.useState)(),he=l()(ye,2),xe=he[0],ke=he[1],be=(0,c.useState)(!1),je=l()(be,2),we=je[0],Me=je[1],Ze=[{label:(0,I.jsx)(S.FormattedMessage,{id:"bi.ticket.timeRange.today"}),value:"today"},{label:(0,I.jsx)(S.FormattedMessage,{id:"bi.ticket.timeRange.yesterday"}),value:"yesterday"},{label:(0,I.jsx)(S.FormattedMessage,{id:"bi.ticket.timeRange.week"}),value:"week"},{label:(0,I.jsx)(S.FormattedMessage,{id:"bi.ticket.timeRange.lastWeek"}),value:"lastWeek"},{label:(0,I.jsx)(S.FormattedMessage,{id:"bi.ticket.timeRange.month"}),value:"month"},{label:(0,I.jsx)(S.FormattedMessage,{id:"bi.ticket.timeRange.custom"}),value:"custom"}];(0,c.useEffect)((function(){if("custom"===G)A(L),V(X);else{var e=$()();"today"===G?(A(e),V(e)):"yesterday"===G?(A(e.subtract(1,"day")),V(e.subtract(1,"day"))):"week"===G?(A(e.startOf("week")),V(e.endOf("week"))):"lastWeek"===G?(A(e.subtract(1,"week").startOf("week")),V(e.subtract(1,"week").endOf("week"))):"month"===G&&(A(e.startOf("month")),V(e.endOf("month")))}}),[G]);var Se=function(){var e=s()(r()().mark((function e(){var t,n;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return R.yw.loading("loading"),t={pageNumber:0,pageSize:100,orgUid:null==ue?void 0:ue.uid},e.next=4,(0,F.dF)(t);case 4:200===(n=e.sent).code?(R.yw.destroy(),ge(n),n.data.content.length>0&&ce(n.data.content[0].uid)):(R.yw.destroy(),R.yw.error(n.message));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Oe=function(){var e=s()(r()().mark((function e(){var t,n;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return R.yw.loading("loading"),t={pageNumber:0,pageSize:50,orgUid:null==ue?void 0:ue.uid},e.next=4,(0,Y._t)(t);case 4:200===(n=e.sent).code?(R.yw.destroy(),me(n),n.data.content.length>0&&ie(n.data.content[0].uid)):(R.yw.destroy(),R.yw.error(o(n.message)));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Re=function(){var e=s()(r()().mark((function e(){var t,n;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Me(!0),e.prev=1,R.yw.loading("loading"),t={type:ee,startDate:null==L?void 0:L.format("YYYY-MM-DD"),endDate:null==X?void 0:X.format("YYYY-MM-DD"),departmentUid:le,assigneeUid:re,orgUid:null==ue?void 0:ue.uid},e.next=6,(0,O.AD)(t);case 6:n=e.sent,console.log("queryStatisticTicketByDate response:",n.data,t),200===n.code?(R.yw.destroy(),ke(n.data)):(R.yw.destroy(),R.yw.error(n.message)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),R.yw.error(i.formatMessage({id:"ticket.message.operation.failed"}));case 14:return e.prev=14,Me(!1),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])})));return function(){return e.apply(this,arguments)}}();(0,c.useEffect)((function(){Se(),Oe()}),[]),(0,c.useEffect)((function(){Re()}),[ee,re,le]),(0,c.useEffect)((function(){Re()}),[L,X]);var Ee=(null===(e=fe.data)||void 0===e||null===(e=e.content)||void 0===e?void 0:e.map((function(e,t){return{key:null==e?void 0:e.uid,name:o(null==e?void 0:e.nickname),avatar:null==e?void 0:e.avatar,totalTickets:(null==xe?void 0:xe.assigneeTickets)||0,resolvedTickets:(null==xe?void 0:xe.resolvedTickets)||0,avgResolutionTime:"".concat((null==xe?void 0:xe.averageResolutionTime)||0,"小时"),workHours:"8小时",efficiency:(null==xe?void 0:xe.assigneeResolutionRate)||0}})))||[],Te=[{title:i.formatMessage({id:"bi.ticket.table.agentName"}),dataIndex:"name",key:"name",render:function(e,t){return(0,I.jsxs)(f.Z,{children:[(0,I.jsx)(m.Z,{src:t.avatar,size:"small"}),(0,I.jsx)("span",{children:e})]})}},{title:i.formatMessage({id:"bi.ticket.table.assigneeTickets"}),dataIndex:"totalTickets",key:"totalTickets"},{title:i.formatMessage({id:"bi.ticket.table.resolvedTickets"}),dataIndex:"resolvedTickets",key:"resolvedTickets"},{title:i.formatMessage({id:"bi.ticket.table.avgResolutionTime"}),dataIndex:"avgResolutionTime",key:"avgResolutionTime",render:function(e){return"".concat(e).concat(i.formatMessage({id:"bi.ticket.unit.minute"}))}},{title:i.formatMessage({id:"bi.ticket.table.efficiency"}),dataIndex:"efficiency",key:"efficiency",render:function(e){return(0,I.jsx)(p.Z,{percent:e,size:"small",format:function(e){return"".concat(e,"%")}})}}];return(0,I.jsxs)("div",{style:{padding:"24px"},children:[(0,I.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,I.jsx)("h2",{children:i.formatMessage({id:"bi.ticket.title.workload"})}),(0,I.jsxs)("p",{children:[i.formatMessage({id:"bi.ticket.description.workload"}),"today"===G&&(0,I.jsxs)("span",{style:{color:"#666",marginLeft:8},children:["(",L.format("YYYY-MM-DD"),")"]}),"yesterday"===G&&(0,I.jsxs)("span",{style:{color:"#666",marginLeft:8},children:["(",L.format("YYYY-MM-DD"),")"]}),("week"===G||"lastWeek"===G||"month"===G||"custom"===G)&&(0,I.jsxs)("span",{style:{color:"#666",marginLeft:8},children:["(",L.format("YYYY-MM-DD")," ~ ",X.format("YYYY-MM-DD"),")"]})]})]}),(0,I.jsx)(v.Z,{style:{marginBottom:16},children:(0,I.jsx)(f.Z,{direction:"vertical",style:{width:"100%"},children:(0,I.jsxs)(f.Z,{wrap:!0,style:{width:"100%",justifyContent:"space-between"},children:[(0,I.jsxs)(f.Z,{wrap:!0,children:[(0,I.jsx)(g.ZP.Group,{value:G,onChange:function(e){return _(e.target.value)},children:Ze.map((function(e){return(0,I.jsx)(g.ZP.Button,{value:e.value,children:e.label},e.value)}))}),"custom"===G&&(0,I.jsx)(P,{value:[L,X],onChange:function(e){A(e[0]),V(e[1])}})]}),(0,I.jsxs)(f.Z,{wrap:!0,children:[(0,I.jsxs)(d.Z,{value:ee,onChange:te,style:{width:120},placeholder:i.formatMessage({id:"bi.ticket.filter.type"}),children:[(0,I.jsx)(B,{value:C.whQ,children:i.formatMessage({id:"bi.ticket.filterType.organization"})}),(0,I.jsx)(B,{value:C.fyH,children:i.formatMessage({id:"bi.ticket.filterType.agent"})}),(0,I.jsx)(B,{value:C.nYM,children:i.formatMessage({id:"bi.ticket.filterType.department"})})]}),ee===C.fyH&&(0,I.jsx)(d.Z,{value:re,onChange:ie,style:{width:150},placeholder:i.formatMessage({id:"bi.ticket.filter.agent"}),allowClear:!0,children:null===(t=fe.data)||void 0===t||null===(t=t.content)||void 0===t?void 0:t.map((function(e){return(0,I.jsx)(B,{value:e.uid,children:o(e.nickname)},e.uid)}))}),ee===C.nYM&&(0,I.jsx)(d.Z,{value:le,onChange:ce,style:{width:150},placeholder:i.formatMessage({id:"bi.ticket.filter.department"}),allowClear:!0,children:null===(n=ve.data)||void 0===n||null===(n=n.content)||void 0===n?void 0:n.map((function(e){return(0,I.jsx)(B,{value:e.uid,children:o(e.name)},e.uid)}))}),(0,I.jsx)(y.ZP,{type:"primary",icon:(0,I.jsx)(j.Z,{}),onClick:function(){return Re()},children:(0,I.jsx)(S.FormattedMessage,{id:"bi.common.refresh"})})]})]})})}),(0,I.jsxs)(h.Z,{gutter:16,style:{marginBottom:"24px"},children:[(0,I.jsx)(x.Z,{span:6,children:(0,I.jsx)(v.Z,{children:(0,I.jsx)(k.Z,{title:i.formatMessage({id:"bi.ticket.card.onlineAgents"}),value:(null===(a=fe.data)||void 0===a||null===(a=a.content)||void 0===a?void 0:a.length)||0,prefix:(0,I.jsx)(w.Z,{}),valueStyle:{color:"#3f8600"}})})}),(0,I.jsx)(x.Z,{span:6,children:(0,I.jsx)(v.Z,{children:(0,I.jsx)(k.Z,{title:i.formatMessage({id:"bi.ticket.card.totalTickets"}),value:(null==xe?void 0:xe.totalTickets)||0,prefix:(0,I.jsx)(M.Z,{}),valueStyle:{color:"#1890ff"}})})}),(0,I.jsx)(x.Z,{span:6,children:(0,I.jsx)(v.Z,{children:(0,I.jsx)(k.Z,{title:i.formatMessage({id:"bi.ticket.card.avgResponseTime"}),value:(null==xe?void 0:xe.averageFirstResponseTime)||0,prefix:(0,I.jsx)(Z.Z,{}),valueStyle:{color:"#722ed1"},suffix:i.formatMessage({id:"bi.ticket.unit.minute"})})})}),(0,I.jsx)(x.Z,{span:6,children:(0,I.jsx)(v.Z,{children:(0,I.jsx)(k.Z,{title:i.formatMessage({id:"bi.ticket.card.assigneeResolutionRate"}),value:(null==xe?void 0:xe.assigneeResolutionRate)||0,prefix:(0,I.jsx)(H.Z,{}),valueStyle:{color:"#eb2f96"},suffix:i.formatMessage({id:"bi.ticket.unit.percent"})})})})]}),(0,I.jsx)(v.Z,{title:"客服工作量详细数据",loading:we,children:(0,I.jsx)(b.Z,{columns:Te,dataSource:Ee,pagination:!1,size:"middle"})})]})}},14318:function(e,t,n){n.d(t,{Z:function(){return O}});var a=n(44194),r=n(99026),i=n(59644),s=n(26867),o=n(51865),l=n.n(o),c=n(53230),u=n(81424),d=n(83043);var f=e=>{const{value:t,formatter:n,precision:r,decimalSeparator:i,groupSeparator:s="",prefixCls:o}=e;let l;if("function"==typeof n)l=n(t);else{const e=String(t),n=e.match(/^(-?)(\d*)(\.(\d+))?$/);if(n&&"-"!==e){const e=n[1];let t=n[2]||"0",c=n[4]||"";t=t.replace(/\B(?=(\d{3})+(?!\d))/g,s),"number"==typeof r&&(c=c.padEnd(r,"0").slice(0,r>0?r:0)),c&&(c=`${i}${c}`),l=[a.createElement("span",{key:"int",className:`${o}-content-value-int`},e,t),c&&a.createElement("span",{key:"decimal",className:`${o}-content-value-decimal`},c)]}else l=e}return a.createElement("span",{className:`${o}-content-value`},l)},m=n(15273),p=n(81254),v=n(10750);const g=e=>{const{componentCls:t,marginXXS:n,padding:a,colorTextDescription:r,titleFontSize:i,colorTextHeading:s,contentFontSize:o,fontFamily:l}=e;return{[t]:Object.assign(Object.assign({},(0,m.Wf)(e)),{[`${t}-title`]:{marginBottom:n,color:r,fontSize:i},[`${t}-skeleton`]:{paddingTop:a},[`${t}-content`]:{color:s,fontSize:o,fontFamily:l,[`${t}-content-value`]:{display:"inline-block",direction:"ltr"},[`${t}-content-prefix, ${t}-content-suffix`]:{display:"inline-block"},[`${t}-content-prefix`]:{marginInlineEnd:n},[`${t}-content-suffix`]:{marginInlineStart:n}}})}};var y=(0,p.I$)("Statistic",(e=>{const t=(0,v.IX)(e,{});return[g(t)]}),(e=>{const{fontSizeHeading3:t,fontSize:n}=e;return{titleFontSize:n,contentFontSize:t}})),h=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n};const x=a.forwardRef(((e,t)=>{const{prefixCls:n,className:r,rootClassName:i,style:s,valueStyle:o,value:m=0,title:p,valueRender:v,prefix:g,suffix:x,loading:k=!1,formatter:b,precision:j,decimalSeparator:w=".",groupSeparator:M=",",onMouseEnter:Z,onMouseLeave:S}=e,O=h(e,["prefixCls","className","rootClassName","style","valueStyle","value","title","valueRender","prefix","suffix","loading","formatter","precision","decimalSeparator","groupSeparator","onMouseEnter","onMouseLeave"]),{getPrefixCls:R,direction:E,className:T,style:Y}=(0,u.dj)("statistic"),z=R("statistic",n),[C,D,$]=y(z),F=a.createElement(f,{decimalSeparator:w,groupSeparator:M,prefixCls:z,formatter:b,precision:j,value:m}),N=l()(z,{[`${z}-rtl`]:"rtl"===E},T,r,i,D,$),H=a.useRef(null);a.useImperativeHandle(t,(()=>({nativeElement:H.current})));const I=(0,c.Z)(O,{aria:!0,data:!0});return C(a.createElement("div",Object.assign({},I,{ref:H,className:N,style:Object.assign(Object.assign({},Y),s),onMouseEnter:Z,onMouseLeave:S}),p&&a.createElement("div",{className:`${z}-title`},p),a.createElement(d.Z,{paragraph:!1,loading:k,className:`${z}-skeleton`},a.createElement("div",{style:o,className:`${z}-content`},g&&a.createElement("span",{className:`${z}-content-prefix`},g),v?v(F):F,x&&a.createElement("span",{className:`${z}-content-suffix`},x)))))}));var k=x;const b=[["Y",31536e6],["M",2592e6],["D",864e5],["H",36e5],["m",6e4],["s",1e3],["S",1]];function j(e,t,n){const{format:a=""}=t,r=new Date(e).getTime(),i=Date.now();return function(e,t){let n=e;const a=/\[[^\]]*]/g,r=(t.match(a)||[]).map((e=>e.slice(1,-1))),i=t.replace(a,"[]"),s=b.reduce(((e,[t,a])=>{if(e.includes(t)){const r=Math.floor(n/a);return n-=r*a,e.replace(new RegExp(`${t}+`,"g"),(e=>{const t=e.length;return r.toString().padStart(t,"0")}))}return e}),i);let o=0;return s.replace(a,(()=>{const e=r[o];return o+=1,e}))}(n?Math.max(r-i,0):Math.max(i-r,0),a)}var w=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n};var M=e=>{const{value:t,format:n="HH:mm:ss",onChange:o,onFinish:l,type:c}=e,u=w(e,["value","format","onChange","onFinish","type"]),d="countdown"===c,[f,m]=a.useState(null),p=(0,r.zX)((()=>{const e=Date.now(),n=function(e){return new Date(e).getTime()}(t);m({});return null==o||o(d?n-e:e-n),!(d&&n<e)||(null==l||l(),!1)}));a.useEffect((()=>{let e;const t=()=>{e=(0,i.Z)((()=>{p()&&t()}))};return t(),()=>i.Z.cancel(e)}),[t,d]),a.useEffect((()=>{m({})}),[]);return a.createElement(k,Object.assign({},u,{value:t,valueRender:e=>(0,s.Tm)(e,{title:void 0}),formatter:(e,t)=>f?j(e,Object.assign(Object.assign({},t),{format:n}),d):"-"}))};const Z=e=>a.createElement(M,Object.assign({},e,{type:"countdown"}));var S=a.memo(Z);k.Timer=M,k.Countdown=S;var O=k}}]);