"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[8472],{5651:function(e,t,n){n.d(t,{Z:function(){return i}});var l=n(77260),o=n(44194),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M869 487.8L491.2 159.9c-2.9-2.5-6.6-3.9-10.5-3.9h-88.5c-7.4 0-10.8 9.2-5.2 14l350.2 304H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h585.1L386.9 854c-5.6 4.9-2.2 14 5.2 14h91.5c1.9 0 3.8-.7 5.2-2L869 536.2a32.07 32.07 0 000-48.4z"}}]},name:"arrow-right",theme:"outlined"},s=n(54183),a=function(e,t){return o.createElement(s.Z,(0,l.Z)({},e,{ref:t,icon:r}))};var i=o.forwardRef(a)},54822:function(e,t,n){n(45332),n(16698),n(68100),n(87663),n(5488),n(14870),n(44194),n(31549)},79519:function(e,t,n){var l=n(45332),o=n.n(l),r=n(34599),s=n(5488),a=n(32394),i=n(48821),u=n(47783),d=n(14870),c=n(68349),f=n(44194),g=n(31549);t.Z=function(e){var t=e.open,n=e.onClose,l=e.onSubmit,m=(0,d.useIntl)(),v=a.A.useForm(),p=o()(v,1)[0],h=(0,r.u)((function(e){return e.currentOrg})),b=function(){console.log("handleSaveRobot"),p.validateFields().then((function(e){console.log("handleSaveRobot values:",e);var t={name:e.nickname,nickname:e.nickname,type:e.type,serviceSettings:{showQuickFaqs:!1,quickFaqs:[],showFaqs:!1,faqs:[],showGuessFaqs:!1,guessFaqs:[],showHotFaqs:!1,hotFaqs:[],showShortcutFaqs:!1,shortcutFaqs:[]},kbEnabled:!1,orgUid:null==h?void 0:h.uid};console.log("robotObject:",t),l(t),p.resetFields()})).catch((function(e){console.log("Form errors:",e)}))};return(0,f.useEffect)((function(){console.log("RobotForm useEffect"),t&&(p.resetFields(),p.setFieldsValue({type:s.f4h}))}),[t,p]),(0,g.jsx)("div",{children:(0,g.jsx)(c.Z,{title:m.formatMessage({id:"pages.robot.new",defaultMessage:"New"}),open:t,forceRender:!0,okText:m.formatMessage({id:"save",defaultMessage:"Save"}),onOk:b,onCancel:function(){p.resetFields(),n()},children:(0,g.jsxs)(a.A,{form:p,name:"basic",style:{maxWidth:400},submitter:!1,children:[(0,g.jsx)(i.Z,{label:m.formatMessage({id:"nickname",defaultMessage:"Nickname"}),name:"nickname",rules:[{required:!0,message:m.formatMessage({id:"nickname",defaultMessage:"Nickname"})}],fieldProps:{onPressEnter:function(){return b()}}}),(0,g.jsx)(u.Z,{label:m.formatMessage({id:"type",defaultMessage:"Type"}),name:["type"],options:[{label:m.formatMessage({id:s.f4h,defaultMessage:"Service"}),value:s.f4h},{label:m.formatMessage({id:s.wG_,defaultMessage:"Marketing"}),value:s.wG_,disabled:!0},{label:m.formatMessage({id:s.Qeb,defaultMessage:"Chat"}),value:s.Qeb,disabled:!0}],rules:[{required:!0,message:m.formatMessage({id:"choose",defaultMessage:"Choose"})}],fieldProps:{placeholder:m.formatMessage({id:"choose",defaultMessage:"Choose"}),onChange:function(e){console.log("onTreeSelectChange:",e)},allowClear:!0}})]})})})}},5631:function(e,t,n){n.r(t),n.d(t,{default:function(){return Ie}});var l=n(66985),o=n(44194),r=n(76711),s=n.n(r),a=n(73193),i=n.n(a),u=n(90819),d=n.n(u),c=n(89933),f=n.n(c),g=n(45332),m=n.n(g),v=n(68100),p=n(68349),h=n(90317),b=n(5780),x=n(27259),M=n(96501),y=n(45681),C=n(15722),k=n(82669),j=n(90727),w=n(14870),Z=n(24522),S=n(79519),F=n(33232),q=n(5025),T=n(34599),P=n(18751),R=n(5488),U=n(31549),V=function(){var e=(0,Z.Z)().isDarkMode,t=(0,w.useIntl)(),n=(0,o.useRef)(!1),l=(0,P.Z)(),r=l.translateString,a=(l.translateStringTranct,(0,v.V)((function(e){return{robotResult:e.robotResult,currentRobot:e.currentRobot,insertRobot:e.insertRobot,deleteCurrentRobot:e.deleteCurrentRobot,setRobotResult:e.setRobotResult,setCurrentRobot:e.setCurrentRobot}}))),u=a.robotResult,c=a.currentRobot,g=a.insertRobot,V=a.deleteCurrentRobot,A=a.setRobotResult,E=a.setCurrentRobot,L=(0,T.u)((function(e){return e.currentOrg})),O=(0,o.useState)(""),z=m()(O,2),I=z[0],B=z[1],N=(0,o.useState)(!1),Q=m()(N,2),W=Q[0],D=Q[1],K=(0,o.useState)(!0),_=m()(K,2),X=_[0],H=_[1],G=(0,o.useState)(0),$=m()(G,2),J=$[0],Y=$[1],ee=p.Z.useModal(),te=m()(ee,2),ne=te[0],le=te[1],oe=function(){var e=f()(d()().mark((function e(n){var l;return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("delete robot",n),q.yw.loading(t.formatMessage({id:"deleting",defaultMessage:"Deleting"})),e.next=4,(0,F.gf)(n);case 4:l=e.sent,console.log("delete robot response",l),200===l.code?(q.yw.destroy(),q.yw.success(t.formatMessage({id:"delete.success",defaultMessage:"Delete success"})),V(n.uid)):(q.yw.destroy(),q.yw.error(l.message));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),re=(0,o.useCallback)(f()(d()().mark((function e(){var t,l,o,r,a,f,g,m,v,p,h,b,x,M=arguments;return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=M.length>0&&void 0!==M[0]?M[0]:0,l=M.length>1&&void 0!==M[1]&&M[1],!W&&!n.current){e.next=4;break}return e.abrupt("return");case 4:return n.current=!0,D(!0),o={pageNumber:t,pageSize:20,categoryUid:"",level:R.whQ,type:R.f4h,orgUid:null==L?void 0:L.uid,searchText:I},e.prev=7,e.next=10,(0,F.p0)(o);case 10:r=e.sent,console.log("queryRobotsByOrg: ",r,o),200===r.code?(m=(null==r||null===(a=r.data)||void 0===a?void 0:a.content)||[],v=null!==(f=null==r||null===(g=r.data)||void 0===g?void 0:g.last)&&void 0!==f?f:0===m.length,H(!v),Y(t),l?(h=(null==u||null===(p=u.data)||void 0===p?void 0:p.content)||[],b=i()(i()({},r),{},{data:i()(i()({},r.data),{},{content:[].concat(s()(h),s()(m))})}),A(b)):(A(r),m.length>0&&(x=c&&m.some((function(e){return e.uid===(null==c?void 0:c.uid)})),c&&x||E(m[0])))):q.yw.error(r.message);case 13:return e.prev=13,n.current=!1,D(!1),e.finish(13);case 17:case"end":return e.stop()}}),e,null,[[7,,13,17]])}))),[W,I,null==L?void 0:L.uid,u,c,A,E]);(0,o.useEffect)((function(){Y(0),H(!0),re(0,!1)}),[I,null==L?void 0:L.uid]);var se=(0,o.useState)(!1),ae=m()(se,2),ie=ae[0],ue=ae[1],de=function(){var e=f()(d()().mark((function e(n){var l;return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return q.yw.loading(t.formatMessage({id:"creating",defaultMessage:"Creating"})),e.next=3,(0,F.lg)(n);case 3:l=e.sent,console.log("handleSaveRobot response:",l),200===l.code?(q.yw.destroy(),q.yw.success(t.formatMessage({id:"create.success"})),g(l.data),E(l.data),ue(!1)):(q.yw.destroy(),ue(!1),q.yw.error(l.message));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(e){return t.formatMessage({id:null==e?void 0:e.type,defaultMessage:null==e?void 0:e.type})};return(0,U.jsxs)("div",{children:[(0,U.jsxs)("div",{style:{margin:10},children:[(0,U.jsxs)(h.Z,{gap:"small",align:"flex-start",children:[(0,U.jsx)(b.ZP,{size:"small",type:"primary",icon:(0,U.jsx)(k.Z,{}),onClick:function(){ue(!0)},children:t.formatMessage({id:"pages.robot.new",defaultMessage:"New"})}),(0,U.jsx)(b.ZP,{size:"small",onClick:function(){Y(0),H(!0),re(0,!1)},children:t.formatMessage({id:"refresh",defaultMessage:"Refresh"})}),(0,U.jsx)(b.ZP,{onClick:function(){return function(e){ne.confirm({title:t.formatMessage({id:"deleteTip"}),icon:(0,U.jsx)(C.Z,{}),content:"".concat(t.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(r(e.nickname),"】？"),onOk:function(){oe(e)},onCancel:function(){},okText:t.formatMessage({id:"ok"}),cancelText:t.formatMessage({id:"cancel"})})}(c)},size:"small",style:{float:"right"},danger:!0,disabled:""===(null==c?void 0:c.uid),children:t.formatMessage({id:"pages.robot.delete",defaultMessage:"Delete"})})]}),(0,U.jsx)("div",{style:{marginTop:16},children:(0,U.jsx)(x.Z.Search,{placeholder:t.formatMessage({id:"robot.search.placeholder",defaultMessage:"搜索机器人名称或描述"}),value:I,onChange:function(e){return B(e.target.value)},onSearch:function(e){console.log("搜索内容:",e)},enterButton:(0,U.jsx)(j.Z,{}),allowClear:!0,style:{width:"100%"}})})]}),(0,U.jsx)("div",{style:{overflow:"auto",maxHeight:"calc(100vh - 200px)"},onScroll:function(e){var t=e.currentTarget,n=t.scrollTop;t.scrollHeight-n-t.clientHeight<50&&X&&!W&&re(J+1,!0)},children:(0,U.jsx)(M.Z,{itemLayout:"horizontal",dataSource:u.data.content,renderItem:function(t,n){return(0,U.jsx)(M.Z.Item,{style:(null==c?void 0:c.uid)===t.uid?{backgroundColor:e?"#333333":"#dddddd",cursor:"pointer"}:{cursor:"pointer"},onClick:function(){E(t)},children:(0,U.jsx)(M.Z.Item.Meta,{style:{marginLeft:"10px"},avatar:(0,U.jsx)(y.Z,{src:t.avatar}),title:(0,U.jsx)(U.Fragment,{children:null==t?void 0:t.nickname}),description:ce(t)})})}})}),ie&&(0,U.jsx)(S.Z,{open:ie,onClose:function(){ue(!1)},onSubmit:de}),le]})},A=n(37963),E=n(29787),L=n(92023),O=n(59908),z=n(32394),I=n(48821),B=n(16331),N=n(20903),Q=(n(53),function(){var e,t=z.A.useForm(),n=m()(t,1)[0],l=(0,w.useIntl)(),r=(0,P.Z)().translateString,s=(0,v.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}})),a=s.currentRobot,u=s.setCurrentRobot,c=(0,o.useState)(""),g=m()(c,2),p=g[0],h=g[1],x=(0,o.useState)(r(null==a||null===(e=a.serviceSettings)||void 0===e?void 0:e.welcomeTip)||""),M=m()(x,2),C=M[0],k=M[1];(0,o.useEffect)((function(){var e;a&&(n.setFieldValue("nickname",r(null==a?void 0:a.nickname)),k(r(null==a||null===(e=a.serviceSettings)||void 0===e?void 0:e.welcomeTip)),n.setFieldValue("description",r(null==a?void 0:a.description)))}),[a]);var j=function(){var e=f()(d()().mark((function e(t){var n,o,r,s,c,f,g,m;return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("onFinish:",t),q.yw.loading(l.formatMessage({id:"updating"})),g=i()(i()({},a),{},{serviceSettings:i()(i()({},a.serviceSettings),{},{welcomeTip:C,welcomeFaqUids:null==a||null===(n=a.serviceSettings)||void 0===n||null===(n=n.welcomeFaqs)||void 0===n?void 0:n.map((function(e){return e.uid})),quickFaqUids:null==a||null===(o=a.serviceSettings)||void 0===o||null===(o=o.quickFaqs)||void 0===o?void 0:o.map((function(e){return e.uid})),faqUids:null==a||null===(r=a.serviceSettings)||void 0===r||null===(r=r.faqs)||void 0===r?void 0:r.map((function(e){return e.uid})),guessFaqUids:null==a||null===(s=a.serviceSettings)||void 0===s||null===(s=s.guessFaqs)||void 0===s?void 0:s.map((function(e){return e.uid})),hotFaqUids:null==a||null===(c=a.serviceSettings)||void 0===c||null===(c=c.hotFaqs)||void 0===c?void 0:c.map((function(e){return e.uid})),shortcutFaqUids:null==a||null===(f=a.serviceSettings)||void 0===f||null===(f=f.shortcutFaqs)||void 0===f?void 0:f.map((function(e){return e.uid}))}),nickname:t.nickname,description:t.description,avatar:p}),console.log("robotObject:",g),e.next=6,(0,F.$l)(g);case 6:m=e.sent,console.log("updateRobot response:",m),200===m.code?(q.yw.success(l.formatMessage({id:"update.success"})),u(m.data)):q.yw.error(m.message),q.yw.destroy();case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=f()(d()().mark((function e(t){var n,o;return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("handleUploadSuccess:",t),h(t),n=i()(i()({},a),{},{avatar:t}),e.next=5,(0,F.lz)(n);case 5:o=e.sent,console.log("updateAvatar response:",o),200===o.code?(q.yw.success(l.formatMessage({id:"update.success"})),u(o.data)):q.yw.error(o.message);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){h(null==a?void 0:a.avatar)}),[a]),(0,U.jsxs)(z.A,{form:n,style:{marginLeft:"20px"},onFinish:j,children:[(0,U.jsx)(N.Z.Item,{name:"avatar",valuePropName:"fileList",getValueFromEvent:function(e){return console.log("Upload event:",e),Array.isArray(e)?e:null==e?void 0:e.fileList},label:l.formatMessage({id:"pages.robot.tab.avatar",defaultMessage:"Avatar"}),children:(0,U.jsxs)(L.G,{onSuccess:Z,onError:function(e){console.log("handleUploadError:",e)},children:[(0,U.jsx)(y.Z,{src:p}),(0,U.jsx)(b.ZP,{icon:(0,U.jsx)(O.Z,{}),children:l.formatMessage({id:"pages.robot.upload",defaultMessage:"Upload"})})]},"avatar")}),(0,U.jsx)(I.Z,{width:"md",name:"nickname",label:l.formatMessage({id:"agent.info.nickname"}),rules:[{required:!0,message:l.formatMessage({id:"agent.info.nickname.required"})}]}),(0,U.jsx)(B.Z,{width:"md",name:"description",label:l.formatMessage({id:"pages.robot.tab.description",defaultMessage:"description"}),tooltip:l.formatMessage({id:"pages.robot.tab.description",defaultMessage:"description"}),placeholder:l.formatMessage({id:"pages.robot.tab.description",defaultMessage:"description"}),rules:[{required:!0,message:l.formatMessage({id:"pages.robot.tab.description",defaultMessage:"description"})}]})]})}),W=n(90486),D=n(90297),K=n(5651),_=n(11137),X=n(47783),H=n(49616),G=function(){var e=(0,w.useIntl)(),t=(0,w.useNavigate)(),n=z.A.useForm(),l=m()(n,1)[0],r=(0,P.Z)().translateString,s=(0,o.useState)(),a=m()(s,2),u=a[0],c=a[1],g=(0,T.u)((function(e){return e.currentOrg})),p=(0,v.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}})),h=p.currentRobot,x=p.setCurrentRobot,M=function(){var t=f()(d()().mark((function t(){var n,l;return d()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return q.yw.loading(e.formatMessage({id:"loading",defaultMessage:"Loading"})),n={pageNumber:0,pageSize:50,type:R.QPQ,orgUid:null==g?void 0:g.uid},t.next=4,(0,W.AP)(n);case 4:l=t.sent,console.log("getKeywordBase response:",n,l),q.yw.destroy(),200===l.code?c(l):q.yw.error(l.message);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();(0,o.useEffect)((function(){M()}),[]),(0,o.useEffect)((function(){l.setFieldValue("kbUid",null==h?void 0:h.kbUid),l.setFieldValue("kbEnabled",null==h?void 0:h.kbEnabled)}),[h]);var y=function(){var t=f()(d()().mark((function t(n){var l,o,r,s,a,u,c;return d()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("onFinish values:",n),u=i()(i()({},h),{},{serviceSettings:i()(i()({},h.serviceSettings),{},{faqUids:null==h||null===(l=h.serviceSettings)||void 0===l||null===(l=l.faqs)||void 0===l?void 0:l.map((function(e){return e.uid})),quickFaqUids:null==h||null===(o=h.serviceSettings)||void 0===o||null===(o=o.quickFaqs)||void 0===o?void 0:o.map((function(e){return e.uid})),guessFaqUids:null==h||null===(r=h.serviceSettings)||void 0===r||null===(r=r.guessFaqs)||void 0===r?void 0:r.map((function(e){return e.uid})),hotFaqUids:null==h||null===(s=h.serviceSettings)||void 0===s||null===(s=s.hotFaqs)||void 0===s?void 0:s.map((function(e){return e.uid})),shortcutFaqUids:null==h||null===(a=h.serviceSettings)||void 0===a||null===(a=a.shortcutFaqs)||void 0===a?void 0:a.map((function(e){return e.uid}))}),kbUid:n.kbUid,kbEnabled:n.kbEnabled}),console.log("robotObject:",u),t.next=5,(0,F.$l)(u);case 5:c=t.sent,console.log("updateRobot response:",c),200===c.code?(q.yw.destroy(),q.yw.success(e.formatMessage({id:"update.success"})),x(c.data)):(q.yw.destroy(),q.yw.error(c.message));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),C=function(){var e=f()(d()().mark((function e(t){var n;return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l.setFieldValue("kbEnabled",t),e.prev=1,e.next=4,l.validateFields();case 4:n=e.sent,y(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log("验证失败:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return(0,U.jsx)("div",{children:(0,U.jsxs)(z.A,{form:l,onFinish:y,submitter:{render:function(t,n){return(0,U.jsxs)(H.Z,{children:[n,(0,U.jsx)(b.ZP,{color:"danger",variant:"outlined",icon:(0,U.jsx)(D.Z,{}),onClick:function(){var e;null===(e=window.bytedesk)||void 0===e||e.showChat()},children:e.formatMessage({id:"chat.test",defaultMessage:"ChatTest"})})]})}},children:[(0,U.jsx)(_.Z,{name:"kbEnabled",label:e.formatMessage({id:"robot.kb.enable",defaultMessage:"启用大模型知识库"}),tooltip:e.formatMessage({id:"robot.kb.enable.tooltip",defaultMessage:"开启后，机器人将优先使用知识库回答问题"}),fieldProps:{onChange:C}}),(0,U.jsx)(X.Z,{width:"md",name:"kbUid",label:"大模型知识库",options:null==u?void 0:u.data.content.map((function(e){return{value:e.uid,label:r(e.name)}})),fieldProps:{onChange:function(e){console.log("kbUid:",e)}}}),(0,U.jsx)(z.A.Item,{children:(0,U.jsx)(b.ZP,{icon:(0,U.jsx)(K.Z,{}),onClick:function(){t("/kb/llm")},children:"添加大模型知识库"},"github")})]})})},$=n(72054),J=n(94146),Y=(n(50027),n(10154)),ee=n.n(Y),te=n(91221),ne=n(41282),le=n(39328),oe=n(17323),re=n(64665),se=["fieldProps","proFieldProps","min","max","step","marks","vertical","range"],ae=o.forwardRef((function(e,t){var n=e.fieldProps,l=e.proFieldProps,o=e.min,r=e.max,s=e.step,a=e.marks,i=e.vertical,u=e.range,d=(0,oe.Z)(e,se);return(0,U.jsx)(re.Z,(0,le.Z)({valueType:"slider",fieldProps:(0,le.Z)((0,le.Z)({},n),{},{min:o,max:r,step:s,marks:a,vertical:i,range:u,style:null==n?void 0:n.style}),ref:t,proFieldProps:l,filedConfig:{ignoreWidth:!0}},d))})),ie=n(85817),ue=n(79401),de=n(52202),ce=n(21463),fe=n(18580),ge=n(33363),me=function(){var e,t=(0,w.useIntl)(),n=(0,Z.Z)().isDarkMode,l=z.A.useForm(),r=m()(l,1)[0],s=(0,P.Z)().translateString,a=(0,T.u)((function(e){return e.currentOrg})),u=(0,o.useState)([]),c=m()(u,2),g=c[0],p=c[1],h=(0,o.useState)({}),x=m()(h,2),M=x[0],y=x[1],C=(0,o.useState)(!1),k=m()(C,2),j=k[0],S=k[1],V=(0,o.useState)(""),A=m()(V,2),E=A[0],L=A[1],O=(0,o.useState)(""),I=m()(O,2),N=I[0],Q=I[1],W=(0,o.useState)(""),D=m()(W,2),K=D[0],H=D[1],G=(0,o.useState)(""),$=m()(G,2),J=($[0],$[1]),Y=(0,o.useState)(""),le=m()(Y,2),oe=(le[0],le[1]),re=(0,o.useState)(!1),se=m()(re,2),me=se[0],ve=se[1],pe=(0,o.useState)(""),he=m()(pe,2),be=(he[0],he[1]),xe=(0,o.useState)(""),Me=m()(xe,2),ye=Me[0],Ce=Me[1],ke=(0,o.useState)(""),je=m()(ke,2),we=je[0],Ze=je[1],Se=(0,o.useState)(""),Fe=m()(Se,2),qe=Fe[0],Te=Fe[1],Pe=(0,o.useState)({}),Re=m()(Pe,2),Ue=Re[0],Ve=Re[1],Ae=(0,v.V)((function(e){return{currentRobot:e.currentRobot,setCurrentRobot:e.setCurrentRobot}})),Ee=Ae.currentRobot,Le=Ae.setCurrentRobot;(0,o.useEffect)((function(){var e,t,n,l,o,a,i,u,d,c,f,g,m,v,p,h,b,x,M,y,C,k,j,w;r.setFieldValue("enabled",null==Ee||null===(e=Ee.llm)||void 0===e?void 0:e.enabled),r.setFieldValue("enableThinking",null==Ee||null===(t=Ee.llm)||void 0===t?void 0:t.enableThinking),r.setFieldValue("enableStreaming",null==Ee||null===(n=Ee.llm)||void 0===n?void 0:n.enableStreaming),r.setFieldValue("topK",null==Ee||null===(l=Ee.llm)||void 0===l?void 0:l.topK),r.setFieldValue("scoreThreshold",null==Ee||null===(o=Ee.llm)||void 0===o?void 0:o.scoreThreshold),r.setFieldValue("textProviderUid",null==Ee||null===(a=Ee.llm)||void 0===a?void 0:a.textProviderUid),r.setFieldValue("textModel",null==Ee||null===(i=Ee.llm)||void 0===i?void 0:i.textModel),r.setFieldValue("temperature",null==Ee||null===(u=Ee.llm)||void 0===u?void 0:u.temperature),r.setFieldValue("topP",null==Ee||null===(d=Ee.llm)||void 0===d?void 0:d.topP),r.setFieldValue("prompt",s(null==Ee||null===(c=Ee.llm)||void 0===c?void 0:c.prompt)),r.setFieldValue("defaultReply",null==Ee||null===(f=Ee.llm)||void 0===f?void 0:f.defaultReply),r.setFieldValue("contextMsgCount",null==Ee||null===(g=Ee.llm)||void 0===g?void 0:g.contextMsgCount),r.setFieldValue("rerankEnabled",null==Ee||null===(m=Ee.llm)||void 0===m?void 0:m.rerankEnabled),r.setFieldValue("rerankProvider",null==Ee||null===(v=Ee.llm)||void 0===v?void 0:v.rerankProvider),r.setFieldValue("rerankProviderUid",null==Ee||null===(p=Ee.llm)||void 0===p?void 0:p.rerankProviderUid),r.setFieldValue("rerankModel",null==Ee||null===(h=Ee.llm)||void 0===h?void 0:h.rerankModel),r.setFieldValue("searchType",(null==Ee||null===(b=Ee.llm)||void 0===b?void 0:b.searchType)||"MIXED");var Z=(null==Ee||null===(x=Ee.llm)||void 0===x?void 0:x.textProviderUid)||"",S=(null==Ee||null===(M=Ee.llm)||void 0===M?void 0:M.textModel)||"";J((null==Ee||null===(y=Ee.llm)||void 0===y?void 0:y.rerankProvider)||""),oe((null==Ee||null===(C=Ee.llm)||void 0===C?void 0:C.rerankModel)||""),L(Z),Q(S);var F=(null==Ee||null===(k=Ee.llm)||void 0===k?void 0:k.rerankProvider)||"",q=(null==Ee||null===(j=Ee.llm)||void 0===j?void 0:j.rerankProviderUid)||"",T=(null==Ee||null===(w=Ee.llm)||void 0===w?void 0:w.rerankModel)||"";be(F),Ce(q),Ze(T),S&&!K&&H(S)}),[Ee]),(0,o.useEffect)((function(){var e=E,t=N;if(e&&t&&M[e]){var n=M[e].find((function(e){return e.value===t}));n&&H(n.label)}}),[M,E,N]),(0,o.useEffect)((function(){var e=ye,t=we;if(e&&t&&Ue[e]){var n=Ue[e].find((function(e){return e.value===t}));n&&Te(n.label)}}),[Ue,ye,we]);var Oe=function(){var e=f()(d()().mark((function e(){var t,n,l,o,r,s,i;return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={pageNumber:0,pageSize:100,sortBy:"createdAt",sortDirection:"ascend",enabled:!0,orgUid:null==a?void 0:a.uid,level:R.whQ},e.next=4,(0,te.mK)(t);case 4:n=e.sent,console.log("queryLlmProvidersByOrg:",n,t),200===n.code?(o=n.data.content||[],r=o.filter((function(e){return!ge.ju.includes(e.type)})),p(r),(s=null==Ee||null===(l=Ee.llm)||void 0===l?void 0:l.textProviderUid)&&(i=r.find((function(e){return e.uid===s})))&&(i.type===R.CZ7?Xe(i):Ge(i))):q.yw.error(n.message),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Failed to fetch providers:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();(0,o.useEffect)((function(){Oe()}),[]);var ze=(0,o.useCallback)((function(){S(!0)}),[]),Ie=(0,o.useCallback)((function(){S(!1)}),[]),Be=(0,o.useCallback)((function(e,t,n){S(!1);var l=g.find((function(t){return t.uid===e})),o=l?l.type:e;L(e),Q(t),H(n),r.setFieldsValue({textProvider:o,textProviderUid:e,textModel:t}),r.submit()}),[r,g]),Ne=((0,o.useCallback)((function(){ve(!0)}),[]),(0,o.useCallback)((function(){ve(!1)}),[])),Qe=(0,o.useCallback)((function(e,t,n){ve(!1);var l=g.find((function(t){return t.uid===e})),o=l?l.type:e;be(o),Ce(e),Ze(t),Te(n),r.setFieldsValue({rerankProvider:o,rerankProviderUid:e,rerankModel:t}),r.submit()}),[r,g]),We=(0,o.useCallback)((function(e,t){y((function(n){return i()(i()({},n),{},ee()({},e,t))}))}),[]),De=(0,o.useCallback)((function(e,t){Ve((function(n){return i()(i()({},n),{},ee()({},e,t))}))}),[]),Ke=function(){var e=f()(d()().mark((function e(n){var l,o,r,s,a,i,u,c,f,g,m;return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return q.yw.loading(t.formatMessage({id:"updating"})),g={uid:null==Ee?void 0:Ee.uid,name:null==Ee?void 0:Ee.name,nickname:null==Ee?void 0:Ee.nickname,avatar:null==Ee?void 0:Ee.avatar,description:null==Ee?void 0:Ee.description,serviceSettings:{showFaqs:null==Ee||null===(l=Ee.serviceSettings)||void 0===l?void 0:l.showFaqs,faqKbUid:null==Ee||null===(o=Ee.serviceSettings)||void 0===o?void 0:o.faqKbUid,welcomeTip:null==Ee||null===(r=Ee.serviceSettings)||void 0===r?void 0:r.welcomeTip,welcomeFaqUids:null==Ee||null===(s=Ee.serviceSettings)||void 0===s||null===(s=s.welcomeFaqs)||void 0===s?void 0:s.map((function(e){return e.uid})),faqUids:null==Ee||null===(a=Ee.serviceSettings)||void 0===a||null===(a=a.faqs)||void 0===a?void 0:a.map((function(e){return e.uid})),quickFaqUids:null==Ee||null===(i=Ee.serviceSettings)||void 0===i||null===(i=i.quickFaqs)||void 0===i?void 0:i.map((function(e){return e.uid})),guessFaqUids:null==Ee||null===(u=Ee.serviceSettings)||void 0===u||null===(u=u.guessFaqs)||void 0===u?void 0:u.map((function(e){return e.uid})),hotFaqUids:null==Ee||null===(c=Ee.serviceSettings)||void 0===c||null===(c=c.hotFaqs)||void 0===c?void 0:c.map((function(e){return e.uid})),shortcutFaqUids:null==Ee||null===(f=Ee.serviceSettings)||void 0===f||null===(f=f.shortcutFaqs)||void 0===f?void 0:f.map((function(e){return e.uid}))},llm:{enabled:n.enabled,enableThinking:n.enableThinking,enableStreaming:n.enableStreaming,topK:n.topK,scoreThreshold:n.scoreThreshold,textProvider:n.textProvider,textProviderUid:n.textProviderUid,textModel:n.textModel,temperature:n.temperature,topP:n.topP,prompt:n.prompt,defaultReply:n.defaultReply,contextMsgCount:n.contextMsgCount,rerankEnabled:n.rerankEnabled,rerankProvider:n.rerankProvider,rerankProviderUid:n.rerankProviderUid,rerankModel:n.rerankModel,searchType:n.searchType}},e.next=4,(0,F.$l)(g);case 4:200===(m=e.sent).code?(q.yw.destroy(),q.yw.success(t.formatMessage({id:"update.success"})),Le(m.data)):(q.yw.destroy(),q.yw.error(m.message));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_e=(0,o.useCallback)((function(e,n){return[(0,U.jsx)(b.ZP,{type:"default",onClick:function(){var t;null===(t=e.form)||void 0===t||t.resetFields()},children:t.formatMessage({id:"llm.reset"})},"reset"),(0,U.jsx)(b.ZP,{type:"primary",onClick:function(){var t;null===(t=e.form)||void 0===t||t.submit()},children:t.formatMessage({id:"llm.save"})},"submit")]}),[t]),Xe=function(){var e=f()(d()().mark((function e(n){var l,o;return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l={baseUrl:n.baseUrl},e.next=4,(0,de.VM)(l);case 4:o=e.sent,console.log("getOllamaServerStatus: ",o),200===o.code&&o.data?He(n):q.yw.error(o.message),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Failed to check Ollama status:",e.t0),q.yw.error(t.formatMessage({id:"error"}));case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),He=function(){var e=f()(d()().mark((function e(n){var l,o,r,s;return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l={baseUrl:n.baseUrl},e.next=4,(0,de.c8)(l);case 4:o=e.sent,console.log("getOllamaLocalModels: ",o),200===o.code?(r=o.data.map((function(e){return{value:e.name,label:e.name,providerName:n.uid}})),y((function(e){return i()(i()({},e),{},ee()({},n.uid,r))})),E===n.uid&&N&&(s=r.find((function(e){return e.value===N})))&&H(s.label)):q.yw.error(o.message),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Failed to fetch local models:",e.t0),q.yw.error(t.formatMessage({id:"error"}));case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),Ge=function(){var e=f()(d()().mark((function e(n){var l,o,s,u;return d()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l={pageNumber:0,pageSize:50,providerUid:null==n?void 0:n.uid,orgUid:null==a?void 0:a.uid,level:R.whQ},e.next=4,(0,ne.LF)(l);case 4:o=e.sent,console.log("queryLlmModelsByOrg: ",o,l),200===o.code?(s=o.data.content.map((function(e){return{value:e.name,label:e.nickname,description:e.description,providerName:n.nickname}})),y((function(e){return i()(i()({},e),{},ee()({},n.uid,s))})),n.uid===r.getFieldValue("textProviderUid")&&N&&(u=s.find((function(e){return e.value===N})))&&H(u.label)):q.yw.error(o.message),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Failed to fetch models:",e.t0),q.yw.error(t.formatMessage({id:"error"}));case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}();return(0,U.jsxs)(U.Fragment,{children:[(0,U.jsxs)(z.A,{form:r,size:"large",layout:"vertical",style:{maxWidth:"800px"},submitter:{render:_e,submitButtonProps:{size:"large",htmlType:"button"}},onFinish:Ke,children:[(0,U.jsx)(_.Z,{width:"lg",name:"enabled",label:t.formatMessage({id:"llm.enabled.label"}),tooltip:t.formatMessage({id:"llm.enabled.tooltip"}),fieldProps:{onChange:function(e){setTimeout((function(){r.submit()}),100)}}}),r.getFieldValue("enabled")&&(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(_.Z,{width:"lg",name:"enableThinking",label:t.formatMessage({id:"llm.thinking.label"}),tooltip:t.formatMessage({id:"llm.thinking.tooltip"}),fieldProps:{onChange:function(e){setTimeout((function(){r.submit()}),100)}}}),!1,(0,fe.OJ)()&&(0,U.jsx)(X.Z,{width:"lg",name:"searchType",label:t.formatMessage({id:"llm.searchType.label"}),tooltip:t.formatMessage({id:"llm.searchType.tooltip"}),options:[{label:t.formatMessage({id:"llm.searchType.fulltext"}),value:R.ccx},{label:t.formatMessage({id:"llm.searchType.vector"}),value:R.DGp},{label:t.formatMessage({id:"llm.searchType.mixed"}),value:R.rk3}],rules:[{required:!0,message:t.formatMessage({id:"llm.searchType.required"})}],fieldProps:{popupRender:function(e){return(0,U.jsxs)("div",{children:[e,(0,U.jsxs)("div",{style:{padding:"8px 12px"},children:[(0,U.jsx)("div",{style:{borderTop:"1px solid #e8e8e8",margin:"4px 0"}}),(0,U.jsxs)("div",{style:{padding:"8px 0",fontSize:"12px",color:n?"rgba(255, 255, 255, 0.7)":"rgba(0,0,0,0.45)"},children:[(0,U.jsxs)("strong",{children:[t.formatMessage({id:"llm.searchType.fulltext"}),"："]}),t.formatMessage({id:"llm.searchType.fulltext.description"}),(0,U.jsx)("br",{}),(0,U.jsx)("br",{}),(0,U.jsxs)("strong",{children:[t.formatMessage({id:"llm.searchType.vector"}),"："]}),t.formatMessage({id:"llm.searchType.vector.description"}),(0,U.jsx)("br",{}),(0,U.jsx)("br",{}),(0,U.jsxs)("strong",{children:[t.formatMessage({id:"llm.searchType.mixed"}),"："]}),t.formatMessage({id:"llm.searchType.mixed.description"})]})]})]})}}}),(0,U.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,U.jsx)(ie.Z.Text,{strong:!0,style:{marginRight:"8px"},children:t.formatMessage({id:"llm.modelSelection.label"})}),(0,U.jsx)("div",{style:{display:"flex",alignItems:"center",marginTop:"8px"},children:(0,U.jsx)(ue.Z,{size:"small",style:{width:"100%",maxWidth:"500px",cursor:"pointer",border:"1px solid #d9d9d9"},onClick:ze,children:E&&N?(0,U.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,U.jsxs)("div",{children:[(0,U.jsx)(ie.Z.Text,{type:"secondary",children:t.formatMessage({id:"llm.modelSelection.provider"})}),(0,U.jsx)(ie.Z.Text,{strong:!0,children:s((null===(e=g.find((function(e){return e.uid===E})))||void 0===e?void 0:e.nickname)||E)}),(0,U.jsx)("br",{}),(0,U.jsx)(ie.Z.Text,{type:"secondary",children:t.formatMessage({id:"llm.modelSelection.model"})}),(0,U.jsx)(ie.Z.Text,{strong:!0,children:K||N})]}),(0,U.jsx)(b.ZP,{type:"primary",children:t.formatMessage({id:"llm.modelSelection.change"})})]}):(0,U.jsx)("div",{style:{textAlign:"center"},children:(0,U.jsx)(b.ZP,{type:"primary",children:t.formatMessage({id:"llm.modelSelection.select"})})})})}),(0,U.jsxs)("div",{style:{display:"none"},children:[(0,U.jsx)(X.Z,{name:"textProvider",width:"lg"}),(0,U.jsx)(X.Z,{name:"textProviderUid",width:"lg"}),(0,U.jsx)(X.Z,{name:"textModel",width:"lg"})]})]}),!1,(0,U.jsx)(B.Z,{width:"lg",name:"prompt",label:t.formatMessage({id:"llm.prompt.label"}),tooltip:t.formatMessage({id:"llm.prompt.tooltip"}),placeholder:t.formatMessage({id:"llm.prompt.placeholder"}),fieldProps:{rows:13,maxLength:16383,showCount:!0},rules:[{required:!0,message:t.formatMessage({id:"llm.prompt.required"})},{max:16383,message:t.formatMessage({id:"llm.prompt.maxLength"})}]}),(0,U.jsx)(B.Z,{width:"lg",name:"defaultReply",label:t.formatMessage({id:"llm.defaultReply.label"}),tooltip:t.formatMessage({id:"llm.defaultReply.tooltip"}),placeholder:t.formatMessage({id:"llm.defaultReply.placeholder"}),fieldProps:{rows:1,maxLength:100,showCount:!0},rules:[{required:!0,message:t.formatMessage({id:"llm.defaultReply.required"})},{max:100,message:t.formatMessage({id:"llm.defaultReply.maxLength"})}]}),(0,U.jsxs)("div",{style:{width:"500px"},children:[(0,U.jsx)(ae,{width:"md",label:t.formatMessage({id:"llm.temperature.label"}),name:"temperature",min:0,max:1,step:.1,marks:{0:t.formatMessage({id:"llm.temperature.precise"}),.5:t.formatMessage({id:"llm.temperature.balanced"}),1:t.formatMessage({id:"llm.temperature.creative"})},tooltip:t.formatMessage({id:"llm.temperature.tooltip"}),rules:[{required:!0,message:t.formatMessage({id:"llm.temperature.required"})}]}),(0,U.jsx)(ae,{width:"md",label:t.formatMessage({id:"llm.topP.label"}),name:"topP",min:0,max:1,step:.05,marks:{0:t.formatMessage({id:"llm.topP.low"}),.5:t.formatMessage({id:"llm.topP.medium"}),1:t.formatMessage({id:"llm.topP.high"})},tooltip:t.formatMessage({id:"llm.topP.tooltip"})}),(0,U.jsx)(ae,{width:"md",label:t.formatMessage({id:"llm.contextMsgCount.label"}),name:"contextMsgCount",min:0,max:50,step:1,marks:{0:"0",5:"5",10:"10",15:"15",20:"20",25:"25",30:"30",35:"35",40:"40",45:"45",50:"50"},tooltip:t.formatMessage({id:"llm.contextMsgCount.tooltip"}),rules:[{required:!0,message:t.formatMessage({id:"llm.contextMsgCount.required"})}]})]})]})]}),(0,U.jsx)(ce.Z,{visible:j,onCancel:Ie,onOk:Be,initialProvider:E,initialModel:N,initialModelLabel:K,providers:g,currentOrgUid:null==a?void 0:a.uid,existingProviderModels:M,onModelsLoaded:We,allowedModelTypes:[R.l55,R.xZ8,"CHAT"]}),(0,U.jsx)(ce.Z,{visible:me,onCancel:Ne,onOk:Qe,initialProvider:ye,initialModel:we,initialModelLabel:qe,providers:g,currentOrgUid:null==a?void 0:a.uid,existingProviderModels:Ue,onModelsLoaded:De,allowedModelTypes:[R.SeQ]})]})},ve=(n(74790),n(59956)),pe=n(3642),he=n(67072),be=n(10826),xe=(n(39120),n(54822),function(){var e=(0,w.useIntl)(),t=(0,o.useMemo)((function(){return[{key:"kb",label:(0,U.jsx)(w.FormattedMessage,{id:"pages.robot.tab.kb",defaultMessage:"Knowledge Base"}),children:(0,U.jsx)(G,{})},{key:"faq",label:(0,U.jsx)(w.FormattedMessage,{id:"menu.kbase.faq",defaultMessage:"FAQ"}),children:(0,U.jsx)($.Z,{type:R._X4})},{key:"quickFaqs",label:(0,U.jsx)(w.FormattedMessage,{id:"menu.kbase.quickbutton",defaultMessage:"Quick Button"}),children:(0,U.jsx)(J.Z,{type:R._X4})},{key:"llm",label:(0,U.jsx)(w.FormattedMessage,{id:"llm",defaultMessage:"LLM"}),children:(0,U.jsx)(me,{})},{key:"rate",label:(0,U.jsx)(w.FormattedMessage,{id:"rate",defaultMessage:"Rate"}),children:(0,U.jsx)(be.Z,{type:R._X4})},{key:"right",label:(0,U.jsx)(w.FormattedMessage,{id:"right",defaultMessage:"Right"}),children:(0,U.jsx)(pe.Z,{type:R._X4})},{key:"popup",label:(0,U.jsx)(w.FormattedMessage,{id:"popup",defaultMessage:"Popup"}),children:(0,U.jsx)(ve.Z,{type:R._X4})},{key:"trigger",label:(0,U.jsx)(w.FormattedMessage,{id:"trigger",defaultMessage:"Trigger"}),children:(0,U.jsx)(he.Z,{type:R._X4})}]}),[e]);return(0,U.jsx)(A.Z,{tabPosition:"left",items:t})}),Me=n(1155),ye=n(92634),Ce=n(27473),ke=n(53504),je=n(78875),we=n(20228),Ze=n(65532),Se=n(82373),Fe=n(80556),qe=n(40074),Te=n(58791),Pe=n(61353),Re=n(16852),Ue=n(40439),Ve=n(86994),Ae=n(58087),Ee=n(75831),Le=function(){var e=(0,w.useIntl)(),t=(0,o.useContext)(Ee.I).isDarkMode,n=(0,v.V)((function(e){return e.currentRobot})),l=(0,T.u)((function(e){return e.currentOrg})),r=(0,o.useState)(!1),s=m()(r,2),a=s[0],u=s[1],c=(0,o.useState)({totalCount:0,queuingCount:0,chattingCount:0,offlineCount:0,closedCount:0,leaveMsgCount:0,robotToAgentCount:0,avgWaitTime:0,avgResolveTime:0}),g=m()(c,2),p=g[0],h=g[1],x=function(){var t=f()(d()().mark((function t(){var o,r,s,a,i,c,f,g,m,v,p,b,x;return d()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("requestQueue"),u(!0),q.yw.info(e.formatMessage({id:"refresh",defaultMessage:"正在刷新队列数据..."})),t.prev=3,o={pageNumber:0,pageSize:100,agentUid:null==n?void 0:n.uid,orgUid:null==l?void 0:l.uid},t.next=7,(0,ye.Wq)(o);case 7:r=t.sent,console.log("queryQueuesByOrg response:",r.data),200===(null==r?void 0:r.code)?(q.yw.destroy(),null!=r&&null!==(s=r.data)&&void 0!==s&&s.content&&r.data.content.length>0?(x=r.data.content.reduce((function(e,t){return e.totalCount+=t.totalCount||0,e.queuingCount+=t.queuingCount||0,e.chattingCount+=t.chattingCount||0,e.offlineCount+=t.offlineCount||0,e.closedCount+=t.closedCount||0,e.leaveMsgCount+=t.leaveMsgCount||0,e.robotToAgentCount+=t.robotToAgentCount||0,e.avgWaitTime=t.avgWaitTime,e.avgResolveTime=t.avgResolveTime,e}),{totalCount:0,queuingCount:0,chattingCount:0,offlineCount:0,closedCount:0,leaveMsgCount:0,robotToAgentCount:0,avgWaitTime:0,avgResolveTime:0}),h({totalCount:null!==(a=x.totalCount)&&void 0!==a?a:0,queuingCount:null!==(i=x.queuingCount)&&void 0!==i?i:0,chattingCount:null!==(c=x.chattingCount)&&void 0!==c?c:0,offlineCount:null!==(f=x.offlineCount)&&void 0!==f?f:0,closedCount:null!==(g=x.closedCount)&&void 0!==g?g:0,leaveMsgCount:null!==(m=x.leaveMsgCount)&&void 0!==m?m:0,robotToAgentCount:null!==(v=x.robotToAgentCount)&&void 0!==v?v:0,avgWaitTime:null!==(p=x.avgWaitTime)&&void 0!==p?p:0,avgResolveTime:null!==(b=x.avgResolveTime)&&void 0!==b?b:0})):h({totalCount:0,queuingCount:0,chattingCount:0,offlineCount:0,closedCount:0,leaveMsgCount:0,robotToAgentCount:0,avgWaitTime:0,avgResolveTime:0})):q.yw.error(null==r?void 0:r.message);case 10:return t.prev=10,u(!1),t.finish(10);case 13:case"end":return t.stop()}}),t,null,[[3,,10,13]])})));return function(){return t.apply(this,arguments)}}();(0,o.useEffect)((function(){x()}),[n]);var M={boxShadow:t?"0 4px 8px rgba(255,255,255,0.05)":"0 4px 8px rgba(0,0,0,0.1)",borderRadius:"8px",height:"100%",transition:"transform 0.3s",cursor:"pointer"},y={totalCount:{bg:t?"#0a2642":"#e6f7ff",valueColor:"#1890ff"},queuingCount:{bg:t?"#3b2500":"#fff7e6",valueColor:"#fa8c16"},chattingCount:{bg:t?"#162312":"#f6ffed",valueColor:"#52c41a"},offlineCount:{bg:t?"#1f1f1f":"#fcfcfc",valueColor:t?"#d9d9d9":"#8c8c8c"},closedCount:{bg:t?"#2a0e0d":"#fff1f0",valueColor:"#ff4d4f"},leaveMsgCount:{bg:t?"#230e2c":"#f9f0ff",valueColor:"#722ed1"},robotToAgentCount:{bg:t?"#102039":"#e6fffb",valueColor:"#13c2c2"},avgWaitTime:{bg:t?"#273010":"#fcffe6",valueColor:"#a0d911"},avgResolveTime:{bg:t?"#172b4d":"#f0f5ff",valueColor:"#2f54eb"}};return(0,U.jsxs)("div",{style:{padding:"4px"},children:[(0,U.jsx)("div",{style:{marginBottom:"10px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,U.jsx)(Ce.Z,{title:e.formatMessage({id:"refresh",defaultMessage:"刷新数据"}),children:(0,U.jsx)(b.ZP,{type:"primary",icon:(0,U.jsx)(Fe.Z,{}),loading:a,onClick:x,size:"small",children:e.formatMessage({id:"refresh",defaultMessage:"刷新"})})})}),(0,U.jsxs)(ke.Z,{spinning:a,children:[(0,U.jsxs)(je.Z,{gutter:[16,16],children:[(0,U.jsx)(we.Z,{xs:24,sm:12,md:8,lg:8,xl:4,children:(0,U.jsx)(ue.Z,{style:i()(i()({},M),{},{backgroundColor:y.totalCount.bg}),hoverable:!0,children:(0,U.jsx)(Ze.Z,{title:e.formatMessage({id:"queue.totalCount",defaultMessage:"总会话"}),value:p.totalCount,prefix:(0,U.jsx)(qe.Z,{}),valueStyle:{color:"#1890ff"}})})}),(0,U.jsx)(we.Z,{xs:24,sm:12,md:8,lg:8,xl:4,children:(0,U.jsx)(ue.Z,{style:i()(i()({},M),{},{backgroundColor:y.queuingCount.bg}),hoverable:!0,children:(0,U.jsx)(Ze.Z,{title:e.formatMessage({id:"queue.queuingCount",defaultMessage:"排队中"}),value:p.queuingCount,prefix:(0,U.jsx)(Te.Z,{}),valueStyle:{color:"#fa8c16"}})})}),(0,U.jsx)(we.Z,{xs:24,sm:12,md:8,lg:8,xl:4,children:(0,U.jsx)(ue.Z,{style:i()(i()({},M),{},{backgroundColor:y.chattingCount.bg}),hoverable:!0,children:(0,U.jsx)(Ze.Z,{title:e.formatMessage({id:"queue.chattingCount",defaultMessage:"会话中"}),value:p.chattingCount,prefix:(0,U.jsx)(Pe.Z,{}),valueStyle:{color:"#52c41a"}})})}),(0,U.jsx)(we.Z,{xs:24,sm:12,md:8,lg:8,xl:4,children:(0,U.jsx)(ue.Z,{style:i()(i()({},M),{},{backgroundColor:y.offlineCount.bg}),hoverable:!0,children:(0,U.jsx)(Ze.Z,{title:e.formatMessage({id:"queue.offlineCount",defaultMessage:"离线留言"}),value:p.offlineCount,prefix:(0,U.jsx)(Re.Z,{}),valueStyle:{color:"#8c8c8c"}})})}),(0,U.jsx)(we.Z,{xs:24,sm:12,md:8,lg:8,xl:4,children:(0,U.jsx)(ue.Z,{style:i()(i()({},M),{},{backgroundColor:y.closedCount.bg}),hoverable:!0,children:(0,U.jsx)(Ze.Z,{title:e.formatMessage({id:"queue.closedCount",defaultMessage:"已关闭"}),value:p.closedCount,prefix:(0,U.jsx)(Ue.Z,{}),valueStyle:{color:"#ff4d4f"}})})}),(0,U.jsx)(we.Z,{xs:24,sm:12,md:8,lg:8,xl:4,children:(0,U.jsx)(ue.Z,{style:i()(i()({},M),{},{backgroundColor:y.leaveMsgCount.bg}),hoverable:!0,children:(0,U.jsx)(Ze.Z,{title:e.formatMessage({id:"queue.leaveMsgCount",defaultMessage:"留言数"}),value:p.leaveMsgCount,prefix:(0,U.jsx)(Ve.Z,{}),valueStyle:{color:y.leaveMsgCount.valueColor}})})})]}),(0,U.jsx)(Se.Z,{style:{margin:"16px 0",fontSize:"14px"},children:e.formatMessage({id:"queue.additionalStats",defaultMessage:"更多统计"})}),(0,U.jsx)(je.Z,{gutter:[16,16],children:(0,U.jsx)(we.Z,{xs:24,sm:12,md:8,lg:8,xl:4,children:(0,U.jsx)(ue.Z,{style:i()(i()({},M),{},{backgroundColor:y.robotToAgentCount.bg}),hoverable:!0,children:(0,U.jsx)(Ze.Z,{title:e.formatMessage({id:"queue.robotToAgentCount",defaultMessage:"转人工数"}),value:p.robotToAgentCount,prefix:(0,U.jsx)(Ae.Z,{}),valueStyle:{color:y.robotToAgentCount.valueColor}})})})})]})]})},Oe=function(){var e=(0,w.useIntl)(),t=(0,o.useMemo)((function(){return[{key:"basic",label:e.formatMessage({id:"pages.robot.tab.basic",defaultMessage:"Basic"}),children:(0,U.jsx)(Q,{})},{key:"serviceSettings",label:e.formatMessage({id:"pages.agent.service.settings",defaultMessage:"Service Settings"}),children:(0,U.jsx)(Me.Z,{type:R._X4})},{key:"advanced",label:e.formatMessage({id:"pages.robot.tab.advanced",defaultMessage:"Advanced"}),children:(0,U.jsx)(xe,{})},{key:"monitor",label:e.formatMessage({id:"queue.dashboard.title",defaultMessage:"Monitor"}),children:(0,U.jsx)(Le,{}),disabled:!(0,fe.OJ)()},{key:"channel",label:e.formatMessage({id:"pages.robot.tab.channel",defaultMessage:"Channel"}),children:(0,U.jsx)(E.Z,{type:R._X4})}]}),[e]);return(0,U.jsx)(A.Z,{defaultActiveKey:"basic",items:t})},ze=n(74424),Ie=function(){var e=(0,ze.Z)(),t=e.leftSiderStyle,n=e.contentStyle;return(0,U.jsxs)(l.Z,{style:{height:"100%"},children:[(0,U.jsx)(l.Z.Panel,{defaultSize:"20%",min:"10%",max:"40%",style:t,children:(0,U.jsx)(V,{})}),(0,U.jsx)(l.Z.Panel,{style:n,children:(0,U.jsx)(Oe,{})})]})}}}]);