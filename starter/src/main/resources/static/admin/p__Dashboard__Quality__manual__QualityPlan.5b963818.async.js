"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[868],{16829:function(e,t,a){a.d(t,{Z:function(){return o}});var n=a(77260),r=a(44194),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"},s=a(5901),l=function(e,t){return r.createElement(s.Z,(0,n.Z)({},e,{ref:t,icon:i}))};var o=r.forwardRef(l)},38722:function(e,t,a){a.d(t,{Z:function(){return o}});var n=a(77260),r=a(44194),i={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z"}}]},name:"close-circle",theme:"outlined"},s=a(5901),l=function(e,t){return r.createElement(s.Z,(0,n.Z)({},e,{ref:t,icon:i}))};var o=r.forwardRef(l)},80503:function(e,t,a){a.d(t,{Z:function(){return o}});var n=a(77260),r=a(44194),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},s=a(5901),l=function(e,t){return r.createElement(s.Z,(0,n.Z)({},e,{ref:t,icon:i}))};var o=r.forwardRef(l)},21698:function(e,t,a){a.r(t),a.d(t,{default:function(){return de}});var n=a(84176),r=a.n(n),i=a(10154),s=a.n(i),l=a(73193),o=a.n(l),c=a(86222),d=a.n(c),u=a(90819),p=a.n(u),f=a(89933),m=a.n(f),y=a(45332),g=a.n(y),h=a(44194),x=a(43443),M=a(44532),v=a(77407),q=a(35129),b=a(50972),w=a(6992),j=a(91768),k=a(16829),Z=a(38722),S=a(80503),I=a(79148),C=a(75699),T=a(25191);function z(e){return F.apply(this,arguments)}function F(){return(F=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,C.request)("/api/v1/quality/plan/query/org",{method:"GET",params:o()({},t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){return A.apply(this,arguments)}function A(){return(A=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,C.request)("/api/v1/quality/plan/create",{method:"POST",data:o()(o()({},t),{},{channel:T.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e){return D.apply(this,arguments)}function D(){return(D=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,C.request)("/api/v1/quality/plan/update",{method:"POST",data:o()(o()({},t),{},{channel:T.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e){return R.apply(this,arguments)}function R(){return(R=m()(p()().mark((function e(t){return p()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,C.request)("/api/v1/quality/plan/delete",{method:"POST",data:o()(o()({},t),{},{channel:T.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var B=a(76711),E=a.n(B),Y=a(55738),J=a(25950),V=a(34251),H=a(34651),L=a(43413),K=a(24418),U=a(63065),X=a(38862),W=a(68525),G=a(61978),Q=a(41881),_=a(92395),$=a(67702),ee=a(31549),te=(Y.Z.Title,Y.Z.Text),ae=J.Z.TextArea,ne=V.Z.Option,re=function(e){var t=e.open,a=e.onClose,n=e.onSave,r=e.initialPlan,i=(0,C.useIntl)(),s=(0,h.useState)(null),l=g()(s,2),c=l[0],d=l[1],u=(0,h.useState)(!1),p=g()(u,2),f=p[0],m=p[1],y=(0,h.useState)(null),x=g()(y,2),M=x[0],b=x[1],k=(0,h.useState)(-1),Z=g()(k,2),S=Z[0],I=Z[1],z=H.Z.useForm(),F=g()(z,1)[0],P=H.Z.useForm(),A=g()(P,1)[0];(0,h.useEffect)((function(){if(r){var e={uid:r.uid,name:r.name,description:r.description,type:r.type,indicators:r.indicators||[],enabled:r.enabled,orgUid:r.orgUid};d(e),F.setFieldsValue(e)}else{var t={name:"",description:"",type:T.VJe,indicators:[],enabled:!0};d(t),F.resetFields()}}),[r,F]);var N,D=[{title:i.formatMessage({id:"quality.plan.serialNumber"}),dataIndex:"index",key:"index",width:80,render:function(e,t,a){return a+1}},{title:i.formatMessage({id:"quality.plan.indicatorName"}),dataIndex:"indicatorName",key:"indicatorName"},{title:i.formatMessage({id:"quality.plan.indicatorScore"}),dataIndex:"indicatorScore",key:"indicatorScore",render:function(e,t){return(0,ee.jsxs)("span",{style:{color:t.deduction?"red":"green"},children:[t.deduction?"":"+",e||0]})}},{title:i.formatMessage({id:"quality.plan.type"}),key:"type",render:function(e,t){return(0,ee.jsxs)(L.Z,{children:[t.deduction&&(0,ee.jsx)("span",{style:{color:"red"},children:i.formatMessage({id:"quality.plan.deduction"})}),t.mandatory&&(0,ee.jsx)("span",{style:{color:"blue"},children:i.formatMessage({id:"quality.plan.mandatory"})})]})}},{title:i.formatMessage({id:"quality.plan.description"}),dataIndex:"description",key:"description",ellipsis:!0},{title:i.formatMessage({id:"actions"}),key:"action",width:200,render:function(e,t,a){var n;return(0,ee.jsxs)(L.Z,{size:"small",children:[(0,ee.jsx)(v.ZP,{type:"text",size:"small",icon:(0,ee.jsx)(Q.Z,{}),onClick:function(){return O(t,a)}}),(0,ee.jsx)(v.ZP,{type:"text",size:"small",danger:!0,icon:(0,ee.jsx)(j.Z,{}),onClick:function(){return R(a)}}),(0,ee.jsx)(v.ZP,{type:"text",size:"small",icon:(0,ee.jsx)(_.Z,{}),disabled:0===a,onClick:function(){return B(a,"up")}}),(0,ee.jsx)(v.ZP,{type:"text",size:"small",icon:(0,ee.jsx)($.Z,{}),disabled:a===((null==c||null===(n=c.indicators)||void 0===n?void 0:n.length)||0)-1,onClick:function(){return B(a,"down")}})]})}}],O=function(e,t){b(e),I(t),A.setFieldsValue(e),m(!0)},R=function(e){if(c){var t=E()(c.indicators||[]);t.splice(e,1);var a=o()(o()({},c),{},{indicators:t});d(a)}},B=function(e,t){if(c){var a=E()(c.indicators||[]);if("up"===t&&e>0){var n=[a[e-1],a[e]];a[e]=n[0],a[e-1]=n[1]}else if("down"===t&&e<a.length-1){var r=[a[e+1],a[e]];a[e]=r[0],a[e+1]=r[1]}var i=o()(o()({},c),{},{indicators:a});d(i)}};return(0,ee.jsxs)(K.Z,{title:r?i.formatMessage({id:"quality.plan.edit"})+": ".concat(r.name):i.formatMessage({id:"quality.plan.create"}),open:t,onClose:a,width:800,extra:(0,ee.jsxs)(L.Z,{children:[(0,ee.jsx)(v.ZP,{onClick:a,children:i.formatMessage({id:"quality.plan.cancel"})}),(0,ee.jsx)(v.ZP,{type:"primary",onClick:function(){F.validateFields().then((function(e){if(c){var t=o()(o()({},c),e);n(t)}}))},children:i.formatMessage({id:"quality.plan.save"})})]}),children:[(0,ee.jsxs)("div",{style:{height:"calc(100vh - 200px)",overflowY:"auto"},children:[(0,ee.jsx)(U.Z,{title:i.formatMessage({id:"quality.plan.basicInfo"}),style:{marginBottom:16},children:(0,ee.jsxs)(H.Z,{form:F,layout:"vertical",children:[(0,ee.jsx)(H.Z.Item,{name:"name",label:i.formatMessage({id:"quality.plan.name"}),rules:[{required:!0,message:i.formatMessage({id:"quality.plan.name.required"})}],children:(0,ee.jsx)(J.Z,{placeholder:i.formatMessage({id:"quality.plan.name.required"})})}),(0,ee.jsx)(H.Z.Item,{name:"type",label:i.formatMessage({id:"quality.plan.type"}),rules:[{required:!0,message:i.formatMessage({id:"quality.plan.type.required"})}],children:(0,ee.jsxs)(V.Z,{placeholder:i.formatMessage({id:"quality.plan.type.required"}),children:[(0,ee.jsx)(ne,{value:T.VJe,children:i.formatMessage({id:"quality.plan.type.onlineService"})}),(0,ee.jsx)(ne,{value:T.tZS,children:i.formatMessage({id:"quality.plan.type.bot"})}),(0,ee.jsx)(ne,{value:T.Drr,children:i.formatMessage({id:"quality.plan.type.callCenter"})})]})}),(0,ee.jsx)(H.Z.Item,{name:"description",label:i.formatMessage({id:"quality.plan.description"}),children:(0,ee.jsx)(ae,{rows:3,placeholder:i.formatMessage({id:"quality.plan.description.tooltip"})})}),(0,ee.jsx)(H.Z.Item,{name:"enabled",label:i.formatMessage({id:"quality.plan.status"}),valuePropName:"checked",children:(0,ee.jsx)(X.Z,{})})]})}),(0,ee.jsxs)(U.Z,{title:(0,ee.jsxs)(L.Z,{children:[i.formatMessage({id:"quality.plan.indicators"}),(0,ee.jsxs)(te,{type:"secondary",children:["(",i.formatMessage({id:"quality.plan.totalScore"}),": ",(N=(null==c?void 0:c.indicators)||[],N.reduce((function(e,t){var a=t.indicatorScore||0;return e+(t.deduction?-a:a)}),0)),")"]})]}),style:{marginBottom:16},children:[(0,ee.jsx)(W.Z,{columns:D,dataSource:(null==c?void 0:c.indicators)||[],pagination:!1,size:"small",rowKey:function(e){return e.indicatorName||Math.random().toString()}}),(0,ee.jsx)("div",{style:{marginTop:16},children:(0,ee.jsx)(v.ZP,{type:"primary",icon:(0,ee.jsx)(w.Z,{}),onClick:function(){b(null),A.resetFields(),m(!0)},children:i.formatMessage({id:"quality.plan.addIndicator"})})})]})]}),(0,ee.jsx)(q.Z,{title:M?i.formatMessage({id:"quality.plan.editIndicator"}):i.formatMessage({id:"quality.plan.addIndicator"}),open:f,onOk:function(){A.validateFields().then((function(e){if(c){var t,a={indicatorName:e.indicatorName,indicatorScore:e.indicatorScore||0,deduction:e.deduction||!1,mandatory:e.mandatory||!1,description:e.description};M&&S>=0?(t=E()(c.indicators||[]))[S]=a:t=[].concat(E()(c.indicators||[]),[a]);var n=o()(o()({},c),{},{indicators:t});d(n),m(!1),A.resetFields()}}))},onCancel:function(){m(!1),A.resetFields()},children:(0,ee.jsxs)(H.Z,{form:A,layout:"vertical",children:[(0,ee.jsx)(H.Z.Item,{name:"indicatorName",label:i.formatMessage({id:"quality.plan.indicatorName"}),rules:[{required:!0,message:i.formatMessage({id:"quality.plan.indicatorName.required"})}],children:(0,ee.jsx)(J.Z,{placeholder:i.formatMessage({id:"quality.plan.indicatorName.required"})})}),(0,ee.jsx)(H.Z.Item,{name:"indicatorScore",label:i.formatMessage({id:"quality.plan.indicatorScore"}),rules:[{required:!0,message:i.formatMessage({id:"quality.plan.indicatorScore.required"})}],children:(0,ee.jsx)(G.Z,{min:0,max:100,style:{width:"100%"}})}),(0,ee.jsx)(H.Z.Item,{name:"deduction",label:i.formatMessage({id:"quality.plan.deduction"}),valuePropName:"checked",children:(0,ee.jsx)(X.Z,{})}),(0,ee.jsx)(H.Z.Item,{name:"mandatory",label:i.formatMessage({id:"quality.plan.mandatory"}),valuePropName:"checked",children:(0,ee.jsx)(X.Z,{})}),(0,ee.jsx)(H.Z.Item,{name:"description",label:i.formatMessage({id:"quality.plan.indicatorDescription"}),children:(0,ee.jsx)(ae,{rows:3,placeholder:i.formatMessage({id:"quality.plan.indicatorDescription"})})})]})})]})},ie=a(28977),se=a.n(ie),le=a(31756),oe=a(31881),ce=["current","pageSize"],de=function(){var e=(0,C.useIntl)(),t=(0,h.useRef)(),a=(0,h.useState)(!1),n=g()(a,2),i=n[0],l=n[1],c=(0,h.useState)(null),u=g()(c,2),f=u[0],y=u[1],F=(0,h.useState)([]),A=g()(F,2),D=A[0],R=A[1],B=(0,h.useState)([]),E=g()(B,2),Y=E[0],J=E[1],V=(0,oe.u)((function(e){return e.currentOrg})),H=function(){var a=m()(p()().mark((function a(n){var r;return p()().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,O({uid:n.uid});case 3:200===a.sent.code?(null==t||null===(r=t.current)||void 0===r||r.reload(),le.yw.success(e.formatMessage({id:"quality.plan.delete.success"}))):le.yw.error(e.formatMessage({id:"quality.plan.delete.error"})),a.next=11;break;case 7:a.prev=7,a.t0=a.catch(0),le.yw.error(e.formatMessage({id:"quality.plan.delete.error"})),console.error("Delete quality plan error:",a.t0);case 11:case"end":return a.stop()}}),a,null,[[0,7]])})));return function(e){return a.apply(this,arguments)}}(),L=function(){var a=m()(p()().mark((function a(){var n,r,i,s,l,o;return p()().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(0!==Y.length){a.next=3;break}return le.yw.warning(e.formatMessage({id:"quality.plan.batch.delete.noselection"})),a.abrupt("return");case 3:le.yw.loading(e.formatMessage({id:"quality.plan.deleting"})),r=0,i=0,s=d()(Y),a.prev=7,s.s();case 9:if((l=s.n()).done){a.next=23;break}return o=l.value,a.prev=11,a.next=14,O({uid:o.uid});case 14:200===a.sent.code?r++:i++,a.next=21;break;case 18:a.prev=18,a.t0=a.catch(11),i++;case 21:a.next=9;break;case 23:a.next=28;break;case 25:a.prev=25,a.t1=a.catch(7),s.e(a.t1);case 28:return a.prev=28,s.f(),a.finish(28);case 31:le.yw.destroy(),0===i?le.yw.success(e.formatMessage({id:"quality.plan.batch.delete.success"},{count:r})):le.yw.warning(e.formatMessage({id:"quality.plan.batch.delete.partial"},{success:r,fail:i})),R([]),J([]),null===(n=t.current)||void 0===n||n.reloadAndRest();case 36:case"end":return a.stop()}}),a,null,[[7,25,28,31],[11,18]])})));return function(){return a.apply(this,arguments)}}(),K=function(){var a=m()(p()().mark((function a(n){var r,i,s,l,c,u;return p()().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(0!==Y.length){a.next=3;break}return le.yw.warning(e.formatMessage({id:"quality.plan.batch.noselection"})),a.abrupt("return");case 3:le.yw.loading(n?e.formatMessage({id:"quality.plan.enabling"}):e.formatMessage({id:"quality.plan.disabling"})),i=0,s=0,l=d()(Y),a.prev=7,l.s();case 9:if((c=l.n()).done){a.next=23;break}return u=c.value,a.prev=11,a.next=14,N(o()(o()({},u),{},{enabled:n}));case 14:200===a.sent.code?i++:s++,a.next=21;break;case 18:a.prev=18,a.t0=a.catch(11),s++;case 21:a.next=9;break;case 23:a.next=28;break;case 25:a.prev=25,a.t1=a.catch(7),l.e(a.t1);case 28:return a.prev=28,l.f(),a.finish(28);case 31:le.yw.destroy(),0===s?le.yw.success(n?e.formatMessage({id:"quality.plan.batch.enable.success"},{count:i}):e.formatMessage({id:"quality.plan.batch.disable.success"},{count:i})):le.yw.warning(n?e.formatMessage({id:"quality.plan.batch.enable.partial"},{success:i,fail:s}):e.formatMessage({id:"quality.plan.batch.disable.partial"},{success:i,fail:s})),R([]),J([]),null===(r=t.current)||void 0===r||r.reloadAndRest();case 36:case"end":return a.stop()}}),a,null,[[7,25,28,31],[11,18]])})));return function(e){return a.apply(this,arguments)}}(),U=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:(0,ee.jsx)(C.FormattedMessage,{id:"quality.plan.name",defaultMessage:"方案名称"}),dataIndex:"name",key:"name",copyable:!0,fixed:"left",width:150,ellipsis:!0,search:!0,tooltip:e.formatMessage({id:"quality.plan.name.tooltip",defaultMessage:"质检方案的名称"})},{title:(0,ee.jsx)(C.FormattedMessage,{id:"quality.plan.description",defaultMessage:"描述"}),dataIndex:"description",key:"description",width:200,ellipsis:!0,search:!0,tooltip:e.formatMessage({id:"quality.plan.description.tooltip",defaultMessage:"质检方案的描述信息"})},{title:(0,ee.jsx)(C.FormattedMessage,{id:"quality.plan.type",defaultMessage:"类型"}),dataIndex:"type",key:"type",width:120,tooltip:e.formatMessage({id:"quality.plan.type.tooltip",defaultMessage:"质检方案的类型"}),valueEnum:s()(s()(s()({},T.VJe,{text:e.formatMessage({id:"quality.plan.type.onlineService"}),status:"Processing"}),T.tZS,{text:e.formatMessage({id:"quality.plan.type.bot"}),status:"Success"}),T.Drr,{text:e.formatMessage({id:"quality.plan.type.callCenter"}),status:"Warning"}),render:function(t){var a="blue",n=t;switch(t){case T.VJe:n=e.formatMessage({id:"quality.plan.type.onlineService"}),a="blue";break;case T.tZS:n=e.formatMessage({id:"quality.plan.type.bot"}),a="green";break;case T.Drr:n=e.formatMessage({id:"quality.plan.type.callCenter"}),a="orange";break;default:n=t||e.formatMessage({id:"quality.plan.type.onlineService"}),a="blue"}return(0,ee.jsx)(x.Z,{color:a,children:n})}},{title:(0,ee.jsx)(C.FormattedMessage,{id:"quality.plan.indicatorsCount",defaultMessage:"质检指标数量"}),key:"indicatorsCount",width:120,hideInSearch:!0,tooltip:e.formatMessage({id:"quality.plan.indicatorsCount.tooltip",defaultMessage:"质检方案包含的指标数量"}),render:function(e,t){var a;return(0,ee.jsx)("span",{children:(null===(a=t.indicators)||void 0===a?void 0:a.length)||0})}},{title:(0,ee.jsx)(C.FormattedMessage,{id:"quality.plan.status",defaultMessage:"状态"}),dataIndex:"enabled",key:"enabled",width:100,hideInSearch:!0,tooltip:e.formatMessage({id:"quality.plan.status.tooltip",defaultMessage:"质检方案是否启用"}),valueEnum:{true:{text:"启用",status:"Success"},false:{text:"禁用",status:"Error"}}},{title:(0,ee.jsx)(C.FormattedMessage,{id:"quality.plan.createdAt",defaultMessage:"创建时间"}),dataIndex:"createdAt",key:"createdAt",width:180,valueType:"dateTime",hideInSearch:!0,tooltip:e.formatMessage({id:"quality.plan.createdAt.tooltip",defaultMessage:"质检方案创建时间"}),render:function(e,t){return t.createdAt?se()(t.createdAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:(0,ee.jsx)(C.FormattedMessage,{id:"quality.plan.updatedAt",defaultMessage:"更新时间"}),dataIndex:"updatedAt",key:"updatedAt",width:180,valueType:"dateTime",hideInSearch:!0,tooltip:e.formatMessage({id:"quality.plan.updatedAt.tooltip",defaultMessage:"质检方案最后更新时间"}),render:function(e,t){return t.updatedAt?se()(t.updatedAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:e.formatMessage({id:"actions"}),valueType:"option",key:"option",width:200,fixed:"right",render:function(t,a,n,r){return[(0,ee.jsx)("a",{onClick:function(){X(a)},children:e.formatMessage({id:"edit"})},"editable"),(0,ee.jsx)("a",{onClick:function(){W(a)},children:e.formatMessage({id:"copy",defaultMessage:"复制"})},"copy"),(0,ee.jsx)(M.Z,{title:e.formatMessage({id:"deleteTip"}),description:e.formatMessage({id:"quality.plan.delete.confirm"},{name:null==a?void 0:a.name}),onConfirm:function(){return H(a)},okText:e.formatMessage({id:"ok"}),cancelText:e.formatMessage({id:"cancel"}),children:(0,ee.jsx)(v.ZP,{size:"small",type:"link",danger:!0,children:e.formatMessage({id:"delete"})})},"delete")]}}],X=function(e){y(e),l(!0)},W=function(e){var t=o()(o()({},e),{},{uid:void 0,name:"".concat(e.name,"_副本")});y(t),l(!0)},G=function(){y(null),l(!0)},Q=function(){var a=m()(p()().mark((function a(n){var r,i,s,o;return p()().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,!n.uid){a.next=9;break}return le.yw.loading(e.formatMessage({id:"quality.plan.updating"})),a.next=5,N(n);case 5:200===(r=a.sent).code?(le.yw.destroy(),le.yw.success(e.formatMessage({id:"quality.plan.update.success"})),l(!1),null===(i=t.current)||void 0===i||i.reloadAndRest()):(le.yw.destroy(),le.yw.error(r.message||e.formatMessage({id:"quality.plan.update.error"}))),a.next=14;break;case 9:return le.yw.loading(e.formatMessage({id:"quality.plan.creating"})),a.next=12,P(n);case 12:200===(s=a.sent).code?(le.yw.destroy(),le.yw.success(e.formatMessage({id:"quality.plan.create.success"})),l(!1),null===(o=t.current)||void 0===o||o.reloadAndRest()):(le.yw.destroy(),le.yw.error(s.message||e.formatMessage({id:"quality.plan.create.error"})));case 14:a.next=21;break;case 16:a.prev=16,a.t0=a.catch(0),le.yw.destroy(),le.yw.error(e.formatMessage({id:"quality.plan.save.error"})),console.error("Save quality plan error:",a.t0);case 21:case"end":return a.stop()}}),a,null,[[0,16]])})));return function(e){return a.apply(this,arguments)}}(),_={selectedRowKeys:D,onChange:function(e,t){R(e),J(t)}},$=function(){var t=m()(p()().mark((function t(a,n,i){var s,l,c,d,u,f,m,y;return p()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("request:",a,n,i),le.yw.loading(e.formatMessage({id:"quality.plan.loading"})),s=a.current,l=a.pageSize,c=r()(a,ce),d=void 0,u=void 0,n&&Object.keys(n).length>0&&(f=Object.keys(n)[0],d=f,u="ascend"===n[f]?"ascend":"descend"),m=o()(o()({pageNumber:s-1,pageSize:l},c),{},{sortBy:d,sortDirection:u,orgUid:null==V?void 0:V.uid}),t.prev=7,t.next=10,z(m);case 10:if(y=t.sent,console.log("queryQualityPlansByOrg response:",y.data,m),le.yw.destroy(),200!==y.code||!y.data){t.next=17;break}return t.abrupt("return",{data:y.data.content||[],success:!0,total:y.data.totalElements||0});case 17:return le.yw.error(y.message||e.formatMessage({id:"quality.plan.fetch.error"})),t.abrupt("return",{data:[],success:!1,total:0});case 19:t.next=27;break;case 21:return t.prev=21,t.t0=t.catch(7),le.yw.destroy(),le.yw.error(e.formatMessage({id:"quality.plan.fetch.error"})),console.error("Fetch quality plans error:",t.t0),t.abrupt("return",{data:[],success:!1,total:0});case 27:case"end":return t.stop()}}),t,null,[[7,21]])})));return function(e,a,n){return t.apply(this,arguments)}}();return(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(I.Z,{columns:U,actionRef:t,cardBordered:!0,rowSelection:_,request:$,scroll:{x:1200},rowKey:"uid",search:{labelWidth:"auto"},pagination:{pageSize:10},dateFormatter:"string",headerTitle:e.formatMessage({id:"quality.plan.management"}),toolBarRender:function(){return function(){var t=[];t.push((0,ee.jsx)(v.ZP,{icon:(0,ee.jsx)(w.Z,{}),type:"primary",onClick:G,children:e.formatMessage({id:"quality.plan.create"})},"create"));var a=[];return D.length>0&&a.push({key:"batchDelete",icon:(0,ee.jsx)(j.Z,{}),danger:!0,label:e.formatMessage({id:"quality.plan.batch.delete"})+" (".concat(D.length,")"),onClick:function(){q.Z.confirm({title:e.formatMessage({id:"deleteTip"}),content:e.formatMessage({id:"quality.plan.batch.delete.confirm"},{count:D.length}),onOk:L,okText:e.formatMessage({id:"ok"}),cancelText:e.formatMessage({id:"cancel"})})}},{key:"batchEnable",icon:(0,ee.jsx)(k.Z,{}),label:e.formatMessage({id:"quality.plan.batch.enable"})+" (".concat(D.length,")"),onClick:function(){return K(!0)}},{key:"batchDisable",icon:(0,ee.jsx)(Z.Z,{}),label:e.formatMessage({id:"quality.plan.batch.disable"})+" (".concat(D.length,")"),onClick:function(){return K(!1)}}),a.length>0&&t.push((0,ee.jsx)(b.Z,{menu:{items:a},placement:"bottom",children:(0,ee.jsxs)(v.ZP,{type:D.length>0?"primary":"default",danger:D.length>0,children:[D.length>0?e.formatMessage({id:"quality.plan.batch.operations"})+" (".concat(D.length,")"):e.formatMessage({id:"more.operations",defaultMessage:"更多操作"}),(0,ee.jsx)(S.Z,{})]})},"batchOperations")),t}()}}),(0,ee.jsx)(re,{open:i,onClose:function(){return l(!1)},onSave:Q,initialPlan:f})]})}}}]);