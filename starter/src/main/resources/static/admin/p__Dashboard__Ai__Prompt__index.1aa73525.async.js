"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[1466],{15722:function(e,t,r){r.d(t,{Z:function(){return l}});var n=r(77260),a=r(44194),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},i=r(54183),s=function(e,t){return a.createElement(i.Z,(0,n.Z)({},e,{ref:t,icon:o}))};var l=a.forwardRef(s)},11090:function(e,t,r){r.d(t,{Z:function(){return l}});var n=r(77260),a=r(44194),o={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"}}]},name:"export",theme:"outlined"},i=r(54183),s=function(e,t){return a.createElement(i.Z,(0,n.Z)({},e,{ref:t,icon:o}))};var l=a.forwardRef(s)},2484:function(e,t,r){r.d(t,{Z:function(){return l}});var n=r(77260),a=r(44194),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},i=r(54183),s=function(e,t){return a.createElement(i.Z,(0,n.Z)({},e,{ref:t,icon:o}))};var l=a.forwardRef(s)},82669:function(e,t,r){r.d(t,{Z:function(){return l}});var n=r(77260),a=r(44194),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"},i=r(54183),s=function(e,t){return a.createElement(i.Z,(0,n.Z)({},e,{ref:t,icon:o}))};var l=a.forwardRef(s)},59908:function(e,t,r){r.d(t,{Z:function(){return l}});var n=r(77260),a=r(44194),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},i=r(54183),s=function(e,t){return a.createElement(i.Z,(0,n.Z)({},e,{ref:t,icon:o}))};var l=a.forwardRef(s)},47783:function(e,t,r){var n=r(39328),a=r(17323),o=r(55824),i=r(44194),s=r(32871),l=r(64665),d=r(31549),u=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],c=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],p=function(e,t){var r=e.fieldProps,c=e.children,p=e.params,f=e.proFieldProps,m=e.mode,g=e.valueEnum,v=e.request,h=e.showSearch,x=e.options,y=(0,a.Z)(e,u),M=(0,i.useContext)(s.Z);return(0,d.jsx)(l.Z,(0,n.Z)((0,n.Z)({valueEnum:(0,o.h)(g),request:v,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,n.Z)({options:x,mode:m,showSearch:h,getPopupContainer:M.getPopupContainer},r),ref:t,proFieldProps:f},y),{},{children:c}))},f=i.forwardRef((function(e,t){var r=e.fieldProps,u=e.children,p=e.params,f=e.proFieldProps,m=e.mode,g=e.valueEnum,v=e.request,h=e.options,x=(0,a.Z)(e,c),y=(0,n.Z)({options:h,mode:m||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},r),M=(0,i.useContext)(s.Z);return(0,d.jsx)(l.Z,(0,n.Z)((0,n.Z)({valueEnum:(0,o.h)(g),request:v,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,n.Z)({getPopupContainer:M.getPopupContainer},y),ref:t,proFieldProps:f},x),{},{children:u}))})),m=i.forwardRef(p);m.SearchSelect=f,m.displayName="ProFormComponent",t.Z=m},48821:function(e,t,r){var n=r(76285),a=r(39328),o=r(17323),i=r(81424),s=r(20903),l=r(26411),d=r(34573),u=r(44194),c=r(64665),p=r(31549),f=["fieldProps","proFieldProps"],m=["fieldProps","proFieldProps"],g="text",v=function(e){var t=(0,i.Z)(e.open||!1,{value:e.open,onChange:e.onOpenChange}),r=(0,n.Z)(t,2),o=r[0],d=r[1];return(0,p.jsx)(s.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(t){var r,n=t.getFieldValue(e.name||[]);return(0,p.jsx)(l.Z,(0,a.Z)((0,a.Z)({getPopupContainer:function(e){return e&&e.parentNode?e.parentNode:e},onOpenChange:function(e){return d(e)},content:(0,p.jsxs)("div",{style:{padding:"4px 0"},children:[null===(r=e.statusRender)||void 0===r?void 0:r.call(e,n),e.strengthText?(0,p.jsx)("div",{style:{marginTop:10},children:(0,p.jsx)("span",{children:e.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},e.popoverProps),{},{open:o,children:e.children}))}})},h=function(e){var t=e.fieldProps,r=e.proFieldProps,n=(0,o.Z)(e,f);return(0,p.jsx)(c.Z,(0,a.Z)({valueType:g,fieldProps:t,filedConfig:{valueType:g},proFieldProps:r},n))};h.Password=function(e){var t=e.fieldProps,r=e.proFieldProps,i=(0,o.Z)(e,m),s=(0,u.useState)(!1),l=(0,n.Z)(s,2),f=l[0],h=l[1];return null!=t&&t.statusRender&&i.name?(0,p.jsx)(v,{name:i.name,statusRender:null==t?void 0:t.statusRender,popoverProps:null==t?void 0:t.popoverProps,strengthText:null==t?void 0:t.strengthText,open:f,onOpenChange:h,children:(0,p.jsx)("div",{children:(0,p.jsx)(c.Z,(0,a.Z)({valueType:"password",fieldProps:(0,a.Z)((0,a.Z)({},(0,d.Z)(t,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(e){var r;null==t||null===(r=t.onBlur)||void 0===r||r.call(t,e),h(!1)},onClick:function(e){var r;null==t||null===(r=t.onClick)||void 0===r||r.call(t,e),h(!0)}}),proFieldProps:r,filedConfig:{valueType:g}},i))})}):(0,p.jsx)(c.Z,(0,a.Z)({valueType:"password",fieldProps:t,proFieldProps:r,filedConfig:{valueType:g}},i))},h.displayName="ProFormComponent",t.Z=h},16331:function(e,t,r){var n=r(39328),a=r(17323),o=r(44194),i=r(64665),s=r(31549),l=["fieldProps","proFieldProps"],d=function(e,t){var r=e.fieldProps,o=e.proFieldProps,d=(0,a.Z)(e,l);return(0,s.jsx)(i.Z,(0,n.Z)({ref:t,valueType:"textarea",fieldProps:r,proFieldProps:o},d))};t.Z=o.forwardRef(d)},33232:function(e,t,r){r.d(t,{$l:function(){return h},JT:function(){return w},Xd:function(){return Z},gf:function(){return S},lg:function(){return f},lz:function(){return y},p0:function(){return c},s9:function(){return g}});var n=r(90819),a=r.n(n),o=r(73193),i=r.n(o),s=r(89933),l=r.n(s),d=r(5488),u=r(14870);function c(e){return p.apply(this,arguments)}function p(){return(p=l()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/robot/query/org",{method:"GET",params:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return m.apply(this,arguments)}function m(){return(m=l()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/robot/create",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return v.apply(this,arguments)}function v(){return(v=l()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/robot/create/prompt",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return x.apply(this,arguments)}function x(){return(x=l()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/robot/update",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return M.apply(this,arguments)}function M(){return(M=l()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/robot/update/avatar",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return b.apply(this,arguments)}function b(){return(b=l()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/robot/update/prompt",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e){return j.apply(this,arguments)}function j(){return(j=l()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/robot/update/kbUid",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return P.apply(this,arguments)}function P(){return(P=l()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,u.request)("/api/v1/robot/delete",{method:"POST",data:i()(i()({},t),{},{channel:d.XtJ})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},92023:function(e,t,r){r.d(t,{G:function(){return f}});var n=r(73193),a=r.n(n),o=(r(44194),r(15435)),i=r(5488),s=r(28977),l=r.n(s),d=r(95660),u=r(5025),c=r(18580),p=r(31549),f=function(e){var t=e.children,r=e.onSuccess,n=e.onError,s={file:null,fileName:"test.png",fileType:"image/png",isAvatar:"true",kbType:i.IrL,categoryUid:"",kbUid:"",channel:i.XtJ},f={name:"file",accept:"image/*",action:(0,c.M$)(),headers:{Authorization:"Bearer "+localStorage.getItem(i.LA8)},data:s,showUploadList:!1,beforeUpload:function(e){d.Z.log("beforeUpload",e);var t=l()(new Date).format("YYYYMMDDHHmmss")+"_"+e.name;return s.file=e,s.fileName=t,s.fileType=e.type,d.Z.log("beforeUpload",s),!0},onChange:function(e){if("uploading"!==e.file.status&&d.Z.log("not uploading:",e.file),"done"===e.file.status)if(d.Z.log("response: ",e.file.response),200===e.file.response.code){var t=e.file.response.data.fileUrl;r(t),u.yw.success("".concat(e.file.name," 上传成功"))}else n(e.file),u.yw.error("".concat(e.file.name," 上传失败"));else"error"===e.file.status&&(u.yw.error("".concat(e.file.name," 上传失败")),n(e.file))}};return(0,p.jsx)(o.Z,a()(a()({},f),{},{children:t}))}},66475:function(e,t,r){r.r(t),r.d(t,{default:function(){return ie}});var n=r(93322),a=r(74424),o=r(5488),i=r(84176),s=r.n(i),l=r(73193),d=r.n(l),u=r(90819),c=r.n(u),p=r(89933),f=r.n(p),m=r(45332),g=r.n(m),v=r(44194),h=r(68349),x=r(26411),y=r(5780),M=r(78359),w=r(5025),b=r(33232),Z=r(14870),j=r(8065),S=r(10154),P=r.n(S),k=r(34599),C=r(32394),I=r(47783),E=r(48821),T=r(16331),O=r(85817),F=r(68724),z=r(49616),U=r(45681),A=r(79401),q=r(92023),B=r(59908),R=r(18751),$=r(21463),N=r(91221),L=r(31549),H=O.Z.Text,V=function(e){var t,r,n=e.isEdit,a=e.robot,i=e.open,s=e.level,l=e.onClose,u=e.onSubmit,p=C.A.useForm(),m=g()(p,1)[0],h=(0,Z.useIntl)(),x=(0,k.u)((function(e){return e.currentOrg})),M=(0,v.useState)("https://cdn.weiyuai.cn/assets/images/llm/provider/zhipu.png"),b=g()(M,2),S=b[0],O=(b[1],(0,v.useState)()),V=g()(O,2),D=V[0],G=V[1],J=(0,j.v)((function(e){return e.categoryResult})),X=(0,R.Z)(),Y=X.translateString,K=(X.translateStringTranct,(0,v.useState)(!1)),Q=g()(K,2),W=Q[0],_=Q[1],ee=(0,v.useState)([]),te=g()(ee,2),re=te[0],ne=te[1],ae=(0,v.useState)({}),oe=g()(ae,2),ie=oe[0],se=oe[1],le=(0,v.useState)(!1),de=g()(le,2),ue=de[0],ce=de[1],pe=(0,v.useState)(""),fe=g()(pe,2),me=fe[0],ge=fe[1],ve=(0,v.useState)(""),he=g()(ve,2),xe=he[0],ye=he[1],Me=(0,v.useState)(""),we=g()(Me,2),be=we[0],Ze=we[1];(0,v.useEffect)((function(){if(n&&a&&m){var e,t,r,o,i,s;m.setFieldsValue({uid:null==a?void 0:a.uid,nickname:null==a?void 0:a.nickname,name:null==a?void 0:a.name,prompt:null==a||null===(e=a.llm)||void 0===e?void 0:e.prompt,description:null==a?void 0:a.description,categoryUid:null==a?void 0:a.categoryUid,provider:null==a||null===(t=a.llm)||void 0===t?void 0:t.textProvider,model:null==a||null===(r=a.llm)||void 0===r?void 0:r.textModel});var l=null==J||null===(o=J.data)||void 0===o||null===(o=o.content)||void 0===o?void 0:o.find((function(e){return e.uid===(null==a?void 0:a.categoryUid)}));G(l),ge((null==a||null===(i=a.llm)||void 0===i?void 0:i.textProvider)||""),ye((null==a||null===(s=a.llm)||void 0===s?void 0:s.textModel)||""),_((null==a?void 0:a.system)||!1)}else console.log("form resetFields"),m.resetFields(),ge(""),ye(""),Ze(""),_(!1);je()}),[a]);var je=function(){var e=f()(c()().mark((function e(){var t,r,n;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={pageNumber:0,pageSize:100,sortBy:"createdAt",sortDirection:"ascend",orgUid:null==x?void 0:x.uid,level:o.whQ},e.next=4,(0,N.mK)(t);case 4:200===(r=e.sent).code?(n=r.data.content||[],ne(n)):w.yw.error(r.message),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Failed to fetch providers:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),Se=(0,v.useCallback)((function(){ce(!0)}),[]),Pe=(0,v.useCallback)((function(){ce(!1)}),[]),ke=(0,v.useCallback)((function(e,t,r){ge(e),ye(t),Ze(r),m.setFieldValue("provider",e),m.setFieldValue("model",t),ce(!1)}),[m]),Ce=(0,v.useCallback)((function(e,t){se((function(r){return d()(d()({},r),{},P()({},e,t))}))}),[]);(0,v.useEffect)((function(){}),[a]);return(0,L.jsx)("div",{children:(0,L.jsxs)(F.Z,{title:n?"编辑提示语":"新建提示语",width:650,onClose:l,open:i,extra:(0,L.jsxs)(z.Z,{children:[(0,L.jsx)(y.ZP,{onClick:l,children:"取消"}),(0,L.jsx)(y.ZP,{onClick:function(){console.log("handleSubmit"),m.validateFields().then((function(e){console.log("Form values:",e);var t={uid:n?null==a?void 0:a.uid:"",nickname:e.nickname,name:e.name,avatar:S,categoryUid:null==D?void 0:D.uid,llm:{prompt:e.prompt,textProvider:e.provider,textModel:e.model},description:e.description,type:o.Qeb,level:s,orgUid:null==x?void 0:x.uid};console.log("robotObject:",t),u(t)})).catch((function(e){console.log("Form errors:",e)}))},type:"primary",children:"保存"})]}),children:[(0,L.jsxs)(C.A,{form:m,name:"model",submitter:!1,children:[(0,L.jsx)(I.Z,{label:"类别",name:"categoryUid",required:!0,options:null==J||null===(t=J.data)||void 0===t||null===(t=t.content)||void 0===t||null===(t=t.filter((function(e){return e.uid!==o.zBg})))||void 0===t?void 0:t.map((function(e){return{label:Y(null==e?void 0:e.name),value:null==e?void 0:e.uid}})),fieldProps:{allowClear:!0,onChange:function(e){var t;console.log("handleChange:",e),G(null==J||null===(t=J.data)||void 0===t||null===(t=t.content)||void 0===t?void 0:t.find((function(t){return t.uid===e})))}}}),(0,L.jsx)(E.Z,{label:"昵称",name:"nickname",required:!0,tooltip:"显示给用户的名称"}),(0,L.jsx)(E.Z,{label:"名称",name:"name",tooltip:"内部识别使用的名称",disabled:W,fieldProps:{placeholder:W?"系统代理不可修改名称":"请输入名称"}}),W&&(0,L.jsx)("div",{style:{color:"#ff4d4f",fontSize:"12px",marginTop:"-20px",marginBottom:"10px"},children:"系统内置代理，无法修改名称"}),(0,L.jsx)(C.A.Item,{name:"avatar",valuePropName:"fileList",getValueFromEvent:function(e){return Array.isArray(e)?e:null==e?void 0:e.fileList},label:h.formatMessage({id:"pages.robot.tab.avatar",defaultMessage:"Avatar"}),children:(0,L.jsxs)(q.G,{onSuccess:function(e){console.log("handleUploadSuccess:",e)},onError:function(e){console.log("handleUploadError:",e),w.yw.error(e)},children:[(0,L.jsx)(U.Z,{src:S}),(0,L.jsx)(y.ZP,{icon:(0,L.jsx)(B.Z,{}),children:h.formatMessage({id:"pages.robot.upload",defaultMessage:"Upload"})})]},"avatar")}),(0,L.jsxs)("div",{children:[(0,L.jsx)(H,{style:{marginBottom:"8px",display:"block"},children:"文字对话模型提供商"}),(0,L.jsx)(A.Z,{size:"small",style:{width:"100%",cursor:"pointer",border:"1px solid #d9d9d9",marginBottom:"16px"},onClick:Se,children:me&&xe?(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,L.jsxs)("div",{children:[(0,L.jsx)(H,{type:"secondary",children:"供应商："}),(0,L.jsx)(H,{strong:!0,children:Y((null===(r=re.find((function(e){return e.name===me})))||void 0===r?void 0:r.nickname)||me)}),(0,L.jsx)("br",{}),(0,L.jsx)(H,{type:"secondary",children:"模型："}),(0,L.jsx)(H,{strong:!0,children:be||xe})]}),(0,L.jsx)(y.ZP,{type:"primary",children:"更换模型"})]}):(0,L.jsx)("div",{style:{textAlign:"center"},children:(0,L.jsx)(y.ZP,{type:"primary",children:"选择AI模型"})})}),(0,L.jsxs)("div",{style:{display:"none"},children:[(0,L.jsx)(I.Z,{name:"provider",width:"lg"}),(0,L.jsx)(I.Z,{name:"model",width:"lg"})]})]}),(0,L.jsx)(T.Z,{label:"提示语Prompt",name:"prompt",required:!0}),(0,L.jsx)(T.Z,{label:"简介描述",name:"description"})]}),(0,L.jsx)($.Z,{visible:ue,onCancel:Pe,onOk:ke,initialProvider:me,initialModel:xe,initialModelLabel:be,providers:re,currentOrgUid:null==x?void 0:x.uid,existingProviderModels:ie,onModelsLoaded:Ce,allowedModelTypes:[o.l55,"CHAT"]})]})})},D=r(15722),G=r(7358),J=r(10162),X=r(11090),Y=r(2484),K=r(19975),Q=r(28977),W=r.n(Q),_=r(18580),ee=r(33363),te=["current","pageSize","prompt"],re=function(e){var t=e.level,r=(e.type,(0,v.useRef)()),n=(0,Z.useIntl)(),a=(0,v.useState)(!0),i=g()(a,2),l=i[0],u=i[1],p=(0,R.Z)().translateString,m=(0,v.useState)(1),S=g()(m,2),P=S[0],C=S[1],I=(0,v.useState)(10),E=g()(I,2),T=E[0],O=E[1],F=(0,v.useState)(!1),z=g()(F,2),U=z[0],A=z[1],q=(0,v.useState)([]),B=g()(q,2),$=(B[0],B[1]),N=(0,v.useState)({}),H=g()(N,2),Q=H[0],re=H[1],ne=(0,j.v)((function(e){return e.currentCategory})),ae=(0,k.u)((function(e){return e.currentOrg})),oe=h.Z.useModal(),ie=g()(oe,2),se=ie[0],le=ie[1],de=(0,v.useState)(0),ue=g()(de,2),ce=ue[0],pe=ue[1],fe=(0,v.useState)({}),me=g()(fe,2),ge=me[0],ve=me[1],he=function(){var e=f()(c()().mark((function e(t){var a,o;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w.yw.loading(n.formatMessage({id:"deleting",defaultMessage:"Deleting"})),e.next=3,(0,b.gf)(t);case 3:200===(a=e.sent).code?(w.yw.destroy(),w.yw.success(n.formatMessage({id:"delete.success",defaultMessage:"Delete success"})),null===(o=r.current)||void 0===o||o.reload()):(w.yw.destroy(),w.yw.error(a.message));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),xe=function(){var e=f()(c()().mark((function e(t){var a,o,i,s;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l){e.next=8;break}return w.yw.loading(n.formatMessage({id:"updating",defaultMessage:"Updating"})),e.next=4,(0,b.JT)(t);case 4:200===(a=e.sent).code?(w.yw.success(n.formatMessage({id:"update.success",defaultMessage:"update success"})),null===(o=r.current)||void 0===o||o.reload(),A(!1)):w.yw.error(a.message),e.next=13;break;case 8:return w.yw.loading(n.formatMessage({id:"creating",defaultMessage:"Creating"})),e.next=11,(0,b.s9)(t);case 11:200===(i=e.sent).code?(w.yw.success(n.formatMessage({id:"create.success",defaultMessage:"create success"})),null===(s=r.current)||void 0===s||s.reload(),A(!1)):w.yw.error(i.message);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,v.useEffect)((function(){var e;null===(e=r.current)||void 0===e||e.reload()}),[ne]);var ye=function(){var e=f()(c()().mark((function e(r,n,a){var i,s;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("handleExportExcel",r,n,a),i=localStorage.getItem(o.LA8),s=d()({categoryUid:(null==ne?void 0:ne.uid)===o.zBg?"":null==ne?void 0:ne.uid,orgUid:t===o.Hxq?"":null==ae?void 0:ae.uid,level:t,type:o.Qeb,accessToken:i||"",exportType:r},ge),"current"===r?(s.pageNumber=String(P-1),s.pageSize=String(T)):"all"===r?(s.pageNumber="0",s.pageSize="1000"):"range"===r&&void 0!==n&&void 0!==a&&(s.pageNumber=String(n),s.pageSize=String(a)),window.open((0,_.kG)()+"/api/v1/robot/export?"+new URLSearchParams(s).toString());case 5:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),Me=function(e){for(var t=[],r=1e3,n=Math.ceil(e/r),a=function(){var n=o,a=o*r+1,i=Math.min((o+1)*r,e);t.push({key:"export-".concat(o),label:"".concat(a,"-").concat(i," (").concat(i-a+1,"条)"),onClick:function(){return ye("range",n,r)}})},o=0;o<n;o++)a();return t},we=[{dataIndex:"index",valueType:"indexBorder",width:48,fixed:"left"},{title:n.formatMessage({id:"pages.prompt.nickname",defaultMessage:"昵称"}),dataIndex:"nickname",hideInSearch:!1,fixed:"left",width:150,copyable:!0,ellipsis:!0,tooltip:n.formatMessage({id:"pages.prompt.nickname.tooltip",defaultMessage:"代理的昵称，用于展示"})},{title:n.formatMessage({id:"pages.prompt.name",defaultMessage:"名称"}),dataIndex:"name",width:200,copyable:!0,ellipsis:!0,tooltip:n.formatMessage({id:"pages.prompt.name.tooltip",defaultMessage:"代理的名称，用于内部识别"})},{title:n.formatMessage({id:"pages.prompt.description",defaultMessage:"描述"}),dataIndex:"description",width:200,copyable:!0,ellipsis:!0,tooltip:n.formatMessage({id:"pages.prompt.description.tooltip",defaultMessage:"代理的功能描述"})},{title:n.formatMessage({id:"pages.prompt.prompt",defaultMessage:"提示词"}),dataIndex:"prompt",ellipsis:!0,hideInSearch:!1,copyable:!0,width:250,tooltip:n.formatMessage({id:"pages.prompt.prompt.tooltip",defaultMessage:"传递给模型的指令和上下文"}),render:function(e,t){var r,a=(null===(r=t.llm)||void 0===r?void 0:r.prompt)||"-",o=function(){var e=f()(c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,ee.TE)(t);case 2:e.sent.success?w.yw.success(n.formatMessage({id:"copy.success",defaultMessage:"复制成功"})):w.yw.error(n.formatMessage({id:"copy.failed",defaultMessage:"复制失败"}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,L.jsx)(x.Z,{content:(0,L.jsxs)("div",{children:[(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[(0,L.jsx)("span",{children:n.formatMessage({id:"pages.prompt.prompt.content",defaultMessage:"提示词内容"})}),(0,L.jsx)(y.ZP,{type:"text",icon:(0,L.jsx)(G.Z,{}),onClick:function(e){e.stopPropagation(),o(a)},title:n.formatMessage({id:"copy.to.clipboard",defaultMessage:"复制到剪贴板"})})]}),(0,L.jsx)("div",{style:{maxWidth:"600px",maxHeight:"400px",overflow:"auto",whiteSpace:"pre-wrap"},children:a})]}),title:n.formatMessage({id:"pages.prompt.prompt",defaultMessage:"提示词"}),trigger:"hover",overlayStyle:{maxWidth:"800px"},children:(0,L.jsx)("span",{style:{cursor:"pointer"},children:a})})}},{title:n.formatMessage({id:"pages.prompt.provider",defaultMessage:"提供商"}),dataIndex:["llm","provider"],hideInSearch:!0,width:120,tooltip:n.formatMessage({id:"pages.prompt.provider.tooltip",defaultMessage:"模型提供商"})},{title:n.formatMessage({id:"pages.prompt.model",defaultMessage:"模型"}),dataIndex:["llm","model"],hideInSearch:!0,width:150,tooltip:n.formatMessage({id:"pages.prompt.model.tooltip",defaultMessage:"使用的大语言模型"})},{title:n.formatMessage({id:"pages.prompt.visionEnabled",defaultMessage:"视觉模型启用"}),dataIndex:["llm","visionEnabled"],hideInSearch:!0,width:120,tooltip:n.formatMessage({id:"pages.prompt.visionEnabled.tooltip",defaultMessage:"是否启用视觉模型功能"}),render:function(e,t){var r;return null!==(r=t.llm)&&void 0!==r&&r.visionEnabled?"是":"否"}},{title:n.formatMessage({id:"pages.prompt.visionProvider",defaultMessage:"视觉提供商"}),dataIndex:["llm","visionProvider"],hideInSearch:!0,width:120,tooltip:n.formatMessage({id:"pages.prompt.visionProvider.tooltip",defaultMessage:"视觉模型的服务提供商"}),render:function(e,t){var r;return(null===(r=t.llm)||void 0===r?void 0:r.visionProvider)||"-"}},{title:n.formatMessage({id:"pages.prompt.visionModel",defaultMessage:"视觉模型"}),dataIndex:["llm","visionModel"],hideInSearch:!0,width:150,tooltip:n.formatMessage({id:"pages.prompt.visionModel.tooltip",defaultMessage:"使用的视觉模型名称"}),render:function(e,t){var r;return(null===(r=t.llm)||void 0===r?void 0:r.visionModel)||"-"}},{title:n.formatMessage({id:"pages.prompt.audioEnabled",defaultMessage:"语音模型启用"}),dataIndex:["llm","audioEnabled"],hideInSearch:!0,width:120,tooltip:n.formatMessage({id:"pages.prompt.audioEnabled.tooltip",defaultMessage:"是否启用语音模型功能"}),render:function(e,t){var r;return null!==(r=t.llm)&&void 0!==r&&r.audioEnabled?"是":"否"}},{title:n.formatMessage({id:"pages.prompt.audioProvider",defaultMessage:"语音提供商"}),dataIndex:["llm","audioProvider"],hideInSearch:!0,width:120,tooltip:n.formatMessage({id:"pages.prompt.audioProvider.tooltip",defaultMessage:"语音模型的服务提供商"}),render:function(e,t){var r;return(null===(r=t.llm)||void 0===r?void 0:r.audioProvider)||"-"}},{title:n.formatMessage({id:"pages.prompt.audioModel",defaultMessage:"语音模型"}),dataIndex:["llm","audioModel"],hideInSearch:!0,width:150,tooltip:n.formatMessage({id:"pages.prompt.audioModel.tooltip",defaultMessage:"使用的语音模型名称"}),render:function(e,t){var r;return(null===(r=t.llm)||void 0===r?void 0:r.audioModel)||"-"}},{title:n.formatMessage({id:"pages.prompt.temperature",defaultMessage:"温度"}),dataIndex:["llm","temperature"],hideInSearch:!0,width:80,tooltip:n.formatMessage({id:"pages.prompt.temperature.tooltip",defaultMessage:"控制输出的随机性，值越高输出越随机创新"}),render:function(e,t){var r,n;return 0===(null===(r=t.llm)||void 0===r?void 0:r.temperature)?"0":(null===(n=t.llm)||void 0===n?void 0:n.temperature)||"-"}},{title:n.formatMessage({id:"pages.prompt.topK",defaultMessage:"Top K"}),dataIndex:["llm","topK"],hideInSearch:!0,width:80,tooltip:n.formatMessage({id:"pages.prompt.topK.tooltip",defaultMessage:"检索时返回的相关文档数量"}),render:function(e,t){var r;return(null===(r=t.llm)||void 0===r?void 0:r.topK)||"-"}},{title:n.formatMessage({id:"pages.prompt.system",defaultMessage:"系统"}),dataIndex:"system",hideInSearch:!0,width:80,tooltip:n.formatMessage({id:"pages.prompt.system.tooltip",defaultMessage:"是否为系统内置代理"}),render:function(e,t){return t.system?"是":"否"}},{title:n.formatMessage({id:"pages.prompt.kbEnabled",defaultMessage:"知识库启用"}),dataIndex:"kbEnabled",hideInSearch:!0,width:120,tooltip:n.formatMessage({id:"pages.prompt.kbEnabled.tooltip",defaultMessage:"是否启用知识库增强功能"}),render:function(e,t){return t.kbEnabled?"是":"否"}},{title:n.formatMessage({id:"pages.prompt.flowEnabled",defaultMessage:"流程启用"}),dataIndex:"flowEnabled",hideInSearch:!0,width:120,tooltip:n.formatMessage({id:"pages.prompt.flowEnabled.tooltip",defaultMessage:"是否启用流程控制功能"}),render:function(e,t){return t.flowEnabled?"是":"否"}},{title:n.formatMessage({id:"pages.prompt.createdAt",defaultMessage:"创建时间"}),dataIndex:"createdAt",valueType:"dateTime",sorter:!0,width:160,hideInSearch:!0,tooltip:n.formatMessage({id:"pages.prompt.createdAt.tooltip",defaultMessage:"代理创建的时间"}),render:function(e,t){return t.createdAt?W()(t.createdAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:n.formatMessage({id:"pages.prompt.updatedAt",defaultMessage:"更新时间"}),dataIndex:"updatedAt",valueType:"dateTime",sorter:!0,hideInSearch:!0,width:160,tooltip:n.formatMessage({id:"pages.prompt.updatedAt.tooltip",defaultMessage:"代理最后更新的时间"}),render:function(e,t){return t.updatedAt?W()(t.updatedAt).format("YYYY-MM-DD HH:mm:ss"):"-"}},{title:n.formatMessage({id:"actions",defaultMessage:"操作"}),dataIndex:"option",valueType:"option",width:120,fixed:"right",tooltip:n.formatMessage({id:"pages.prompt.actions.tooltip",defaultMessage:"可进行的操作"}),render:function(e,t){var r;return[(0,L.jsx)("a",{onClick:function(){return function(e){u(!0),re(e),A(!0)}(t)},children:n.formatMessage({id:"pages.robot.edit",defaultMessage:"Edit"})},"edit"),!(null!=t&&null!==(r=t.uid)&&void 0!==r&&r.includes("void_agent"))&&(0,L.jsx)("a",{onClick:function(){return e=t,void se.confirm({title:n.formatMessage({id:"deleteTip"}),icon:(0,L.jsx)(D.Z,{}),content:"".concat(n.formatMessage({id:"deleteAffirm",defaultMessage:"Delete"}),"【").concat(p(e.nickname),"】？"),onOk:function(){he(e)},okText:n.formatMessage({id:"ok"}),cancelText:n.formatMessage({id:"cancel"})});var e},children:n.formatMessage({id:"pages.robot.delete",defaultMessage:"Delete"})},"delete")]}}],be=function(){var e=f()(c()().mark((function e(r,a,i){var l,u,p,f,m,g,v,h,x;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w.yw.loading(n.formatMessage({id:"loading",defaultMessage:"Loading"})),l=r.current,u=r.pageSize,p=r.prompt,f=s()(r,te),C(l),O(u),ve(d()(d()({},f),{},{prompt:p})),m=void 0,g=void 0,a&&Object.keys(a).length>0&&(v=Object.keys(a)[0],m=v,g="ascend"===a[v]?"ascend":"descend"),h=d()(d()({pageNumber:l-1,pageSize:u,nickname:"",orgUid:t===o.Hxq?"":null==ae?void 0:ae.uid,categoryUid:(null==ne?void 0:ne.uid)===o.zBg?"":null==ne?void 0:ne.uid,type:o.Qeb,level:t},f),{},{prompt:p,sortBy:m,sortDirection:g}),e.next=11,(0,b.p0)(h);case 11:if(x=e.sent,console.log("queryRobotsByOrg response:",x,h),200!==x.code){e.next=20;break}return w.yw.destroy(),$(x.data.content),pe(x.data.totalElements),e.abrupt("return",{data:x.data.content,success:!0,total:x.data.totalElements});case 20:return w.yw.destroy(),w.yw.error(x.message),e.abrupt("return",{data:[],success:!1,total:0});case 23:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}();return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(K.Z,{columns:we,actionRef:r,cardBordered:!0,rowKey:"uid",scroll:{x:2400},search:{labelWidth:"auto"},pagination:{showQuickJumper:!0,pageSize:10,onChange:function(e,t){C(e),O(t)}},dateFormatter:"string",headerTitle:n.formatMessage({id:"pages.prompt.list",defaultMessage:"提示语列表"}),toolBarRender:function(){var e=[(0,L.jsx)(y.ZP,{type:"primary",onClick:function(){u(!1),re({}),A(!0)},icon:(0,L.jsx)(J.Z,{}),children:n.formatMessage({id:"pages.prompt.create",defaultMessage:"添加提示语"})},"create")],t=[{key:"export-current",icon:(0,L.jsx)(X.Z,{}),label:n.formatMessage({id:"export.current",defaultMessage:"导出当前页"}),onClick:function(){return ye("current")}}];return ce>0&&(ce<=1e3?t.push({key:"export-all",icon:(0,L.jsx)(X.Z,{}),label:n.formatMessage({id:"export.all",defaultMessage:"导出全部"})+" (".concat(ce,"条)"),onClick:function(){return ye("all")}}):t.push({key:"export-range",icon:(0,L.jsx)(X.Z,{}),label:n.formatMessage({id:"export.range",defaultMessage:"分段导出"})+" (".concat(ce,"条)"),children:Me(ce)})),e.push((0,L.jsx)(M.Z,{menu:{items:t},placement:"bottom",children:(0,L.jsxs)(y.ZP,{type:"primary",icon:(0,L.jsx)(X.Z,{}),children:[n.formatMessage({id:"export",defaultMessage:"导出"}),(0,L.jsx)(Y.Z,{})]})},"export")),e},request:be}),U&&(0,L.jsx)(V,{isEdit:l,robot:Q,level:t,open:U,onClose:function(){return A(!1)},onSubmit:xe}),le]})},ne=r(42699),ae=n.Z.Sider,oe=n.Z.Content,ie=function(){var e=(0,a.Z)(),t=e.leftSiderStyle,r=e.leftSiderWidth,i=e.contentStyle;return(0,L.jsxs)(n.Z,{children:[(0,L.jsx)(ae,{width:r,style:t,children:(0,L.jsx)(ne.Z,{type:o.Kvk,level:o.whQ})}),(0,L.jsx)(n.Z,{children:(0,L.jsx)(oe,{style:i,children:(0,L.jsx)(re,{level:o.whQ})})})]})}},90317:function(e,t,r){r.d(t,{Z:function(){return Z}});var n=r(44194),a=r(51865),o=r.n(a),i=r(34573),s=r(86992),l=r(35779),d=r(79255),u=r(77167);const c=["wrap","nowrap","wrap-reverse"],p=["flex-start","flex-end","start","end","center","space-between","space-around","space-evenly","stretch","normal","left","right"],f=["center","start","end","flex-start","flex-end","self-start","self-end","baseline","normal","stretch"];var m=function(e,t){return o()(Object.assign(Object.assign(Object.assign({},((e,t)=>{const r=!0===t.wrap?"wrap":t.wrap;return{[`${e}-wrap-${r}`]:r&&c.includes(r)}})(e,t)),((e,t)=>{const r={};return f.forEach((n=>{r[`${e}-align-${n}`]=t.align===n})),r[`${e}-align-stretch`]=!t.align&&!!t.vertical,r})(e,t)),((e,t)=>{const r={};return p.forEach((n=>{r[`${e}-justify-${n}`]=t.justify===n})),r})(e,t)))};const g=e=>{const{componentCls:t}=e;return{[t]:{display:"flex",margin:0,padding:0,"&-vertical":{flexDirection:"column"},"&-rtl":{direction:"rtl"},"&:empty":{display:"none"}}}},v=e=>{const{componentCls:t}=e;return{[t]:{"&-gap-small":{gap:e.flexGapSM},"&-gap-middle":{gap:e.flexGap},"&-gap-large":{gap:e.flexGapLG}}}},h=e=>{const{componentCls:t}=e,r={};return c.forEach((e=>{r[`${t}-wrap-${e}`]={flexWrap:e}})),r},x=e=>{const{componentCls:t}=e,r={};return f.forEach((e=>{r[`${t}-align-${e}`]={alignItems:e}})),r},y=e=>{const{componentCls:t}=e,r={};return p.forEach((e=>{r[`${t}-justify-${e}`]={justifyContent:e}})),r};var M=(0,d.I$)("Flex",(e=>{const{paddingXS:t,padding:r,paddingLG:n}=e,a=(0,u.IX)(e,{flexGapSM:t,flexGap:r,flexGapLG:n});return[g(a),v(a),h(a),x(a),y(a)]}),(()=>({})),{resetStyle:!1}),w=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r};const b=n.forwardRef(((e,t)=>{const{prefixCls:r,rootClassName:a,className:d,style:u,flex:c,gap:p,vertical:f=!1,component:g="div"}=e,v=w(e,["prefixCls","rootClassName","className","style","flex","gap","vertical","component"]),{flex:h,direction:x,getPrefixCls:y}=n.useContext(l.E_),b=y("flex",r),[Z,j,S]=M(b),P=null!=f?f:null==h?void 0:h.vertical,k=o()(d,a,null==h?void 0:h.className,b,j,S,m(b,e),{[`${b}-rtl`]:"rtl"===x,[`${b}-gap-${p}`]:(0,s.n)(p),[`${b}-vertical`]:P}),C=Object.assign(Object.assign({},null==h?void 0:h.style),u);return c&&(C.flex=c),p&&!(0,s.n)(p)&&(C.gap=p),Z(n.createElement(g,Object.assign({ref:t,className:k,style:C},(0,i.Z)(v,["justify","wrap","align"]))))}));var Z=b}}]);